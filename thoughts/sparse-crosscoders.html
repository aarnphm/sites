<!DOCTYPE html>
<!--
/*************************************************************************
* Bop got your nose !!!
*
* Hehe
*
* Anw if you see a component you like ping @aarnphm on Discord I can try
* to send it your way. Have a wonderful day!
**************************************************************************/
-->
<html lang="fr">
  <head>
    <title>
      sparse crosscoders - Aaron's notes
    </title>
    <meta charset="utf-8"/>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains Mono&amp;family=Newsreader:wght@400;700&amp;family=Newsreader:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="true"/>
    <link rel="preconnect" href="https://plausible.io" crossorigin="true"/>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="og:site_name" content="Aaron's notes"/>
    <meta property="og:locale" content="fr-FR"/>
    <meta property="og:title" content="sparse crosscoders - Aaron's notes"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:site" content="@aarnphm_"/>
    <meta name="twitter:creator" content="@aarnphm_"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="sparse crosscoders - Aaron's notes"/>
    <meta name="twitter:description" content="and how we observe multiple activation layers. SAE is a special case of sparse crosscoders."/>
    <meta property="og:description" content="and how we observe multiple activation layers. SAE is a special case of sparse crosscoders."/>
    <meta property="og:image:type" content="image/webp"/>
    <meta property="og:image:alt" content="and how we observe multiple activation layers. SAE is a special case of sparse crosscoders."/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:width" content="1200"/>
    <meta property="og:height" content="630"/>
    <meta property="og:image" content="https://aarnphm.xyz/static/social-images/thoughts-sparse-crosscoders.webp"/>
    <meta property="og:url" content="https:/aarnphm.xyz/thoughts/sparse-crosscoders"/>
    <meta property="og:image" content="https://aarnphm.xyz/static/social-images/thoughts-sparse-crosscoders.webp"/>
    <meta name="twitter:image" content="https://aarnphm.xyz/static/social-images/thoughts-sparse-crosscoders.webp"/>
    <meta property="twitter:domain" content="https://aarnphm.xyz/"/>
    <meta property="twitter:url" content="https:/aarnphm.xyz/thoughts/sparse-crosscoders"/>
    <link rel="icon" href="../static/icon.webp"/>
    <link rel="canonical" href="https:/aarnphm.xyz/thoughts/sparse-crosscoders"/>
    <meta name="description" content="and how we observe multiple activation layers. SAE is a special case of sparse crosscoders."/>
    <meta name="generator" content="Quartz"/>
    <link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/>
    <style>
      .collapsible-header {
      position: relative;
      margin-left: -9px;
      }
      .collapsible-header:first-child {
      margin-top: 1rem;
      }
      .collapsible-header:last-child {
      margin-bottom: 1rem;
      }
      .collapsible-header[data-level=&quot;2&quot;] {
      margin-left: 1rem;
      }
      .collapsible-header[data-level=&quot;3&quot;] {
      margin-left: 1.5rem;
      }
      .collapsible-header[data-level=&quot;4&quot;] {
      margin-left: 1.9rem;
      }
      .collapsible-header[data-level=&quot;5&quot;] {
      margin-left: 2.2rem;
      }
      .collapsible-header[data-level=&quot;6&quot;] {
      margin-left: 2.4rem;
      }
      .collapsible-header .collapsed-dots {
      display: none;
      }
      .collapsible-header.collapsed {
      margin-bottom: 1rem;
      }
      .collapsible-header.collapsed .collapsed-dots {
      display: block;
      }
      .collapsible-header .header-controls {
      display: grid;
      grid-template-columns: auto 1fr;
      align-items: center;
      }
      .collapsible-header .header-controls .toggle-button {
      grid-column: 1;
      }
      .collapsible-header .toggle-button {
      background-color: transparent;
      border: none;
      text-align: left;
      cursor: pointer;
      padding: 0;
      color: var(--dark);
      display: inline-flex;
      align-items: center;
      }
      .collapsible-header .toggle-button:hover .circle-icon {
      display: none;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=true] .collapse-icon {
      display: block;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=true] .expand-icon {
      display: none;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=false] .expand-icon {
      display: block;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=false] .collapse-icon {
      display: none;
      }
      .collapsible-header .toggle-icons {
      display: grid;
      grid-template-columns: 1fr;
      }
      .collapsible-header .toggle-icons .circle-icon,
      .collapsible-header .toggle-icons .expand-icon,
      .collapsible-header .toggle-icons .collapse-icon {
      opacity: 0.85;
      grid-column: 1;
      grid-row: 1;
      }
      .collapsible-header .toggle-icons .circle-icon {
      display: block;
      }
      .collapsible-header .toggle-icons .expand-icon,
      .collapsible-header .toggle-icons .collapse-icon {
      display: none;
      }
      .collapsible-header.collapsed :where(h1, h2, h3, h4, h5, h6):not(.popover *) {
      display: inline-flex;
      align-items: center;
      }
      .collapsible-header :where(h1, h2, h3, h4, h5, h6):not(.popover *) {
      margin: 0;
      }
      .collapsible-header .collapsible-header-content-outer {
      padding-left: 9px;
      padding-bottom: 9px;
      }
      .collapsible-header .collapsible-header-content-outer .collapsible-header-content {
      border-left: 1px solid var(--lightgray);
      overflow: hidden;
      padding-left: 9px;
      max-height: none;
      }
      .collapsible-header .collapsible-header-content-outer .collapsible-header-content.collapsed {
      max-height: 0 !important;
      padding-top: 0;
      padding-bottom: 0;
      }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/node-tikzjax@latest/css/fonts.css" rel="stylesheet" type="text/css" spa-preserve/>
    <link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/>
    <script src="../prescript.js" type="application/javascript" spa-preserve></script>
    <script type="application/javascript" spa-preserve>
      const fetchData = fetch("../static/contentIndex.json").then(data => data.json())
    </script>
    <script type="application/javascript" spa-preserve>
      var T=Object.create;var g=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var q=(e,u)=>()=>(u||e((u={exports:{}}).exports,u),u.exports);var P=(e,u,t,F)=>{if(u&&typeof u=="object"||typeof u=="function")for(let o of j(u))!O.call(e,o)&&o!==t&&g(e,o,{get:()=>u[o],enumerable:!(F=R(u,o))||F.enumerable});return e};var U=(e,u,t)=>(t=e!=null?T(k(e)):{},P(u||!e||!e.__esModule?g(t,"default",{value:e,enumerable:!0}):t,e));var m=q((X,p)=>{"use strict";p.exports=W;function A(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function W(e){if(e=e||{},e.circles)return $(e);let u=new Map;if(u.set(Date,D=>new Date(D)),u.set(Map,(D,i)=>new Map(F(Array.from(D),i))),u.set(Set,(D,i)=>new Set(F(Array.from(D),i))),e.constructorHandlers)for(let D of e.constructorHandlers)u.set(D[0],D[1]);let t=null;return e.proto?l:o;function F(D,i){let n=Object.keys(D),r=new Array(n.length);for(let c=0;c<n.length;c++){let s=n[c],a=D[s];typeof a!="object"||a===null?r[s]=a:a.constructor!==Object&&(t=u.get(a.constructor))?r[s]=t(a,i):ArrayBuffer.isView(a)?r[s]=A(a):r[s]=i(a)}return r}function o(D){if(typeof D!="object"||D===null)return D;if(Array.isArray(D))return F(D,o);if(D.constructor!==Object&&(t=u.get(D.constructor)))return t(D,o);let i={};for(let n in D){if(Object.hasOwnProperty.call(D,n)===!1)continue;let r=D[n];typeof r!="object"||r===null?i[n]=r:r.constructor!==Object&&(t=u.get(r.constructor))?i[n]=t(r,o):ArrayBuffer.isView(r)?i[n]=A(r):i[n]=o(r)}return i}function l(D){if(typeof D!="object"||D===null)return D;if(Array.isArray(D))return F(D,l);if(D.constructor!==Object&&(t=u.get(D.constructor)))return t(D,l);let i={};for(let n in D){let r=D[n];typeof r!="object"||r===null?i[n]=r:r.constructor!==Object&&(t=u.get(r.constructor))?i[n]=t(r,l):ArrayBuffer.isView(r)?i[n]=A(r):i[n]=l(r)}return i}}function $(e){let u=[],t=[],F=new Map;if(F.set(Date,n=>new Date(n)),F.set(Map,(n,r)=>new Map(l(Array.from(n),r))),F.set(Set,(n,r)=>new Set(l(Array.from(n),r))),e.constructorHandlers)for(let n of e.constructorHandlers)F.set(n[0],n[1]);let o=null;return e.proto?i:D;function l(n,r){let c=Object.keys(n),s=new Array(c.length);for(let a=0;a<c.length;a++){let C=c[a],E=n[C];if(typeof E!="object"||E===null)s[C]=E;else if(E.constructor!==Object&&(o=F.get(E.constructor)))s[C]=o(E,r);else if(ArrayBuffer.isView(E))s[C]=A(E);else{let B=u.indexOf(E);B!==-1?s[C]=t[B]:s[C]=r(E)}}return s}function D(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return l(n,D);if(n.constructor!==Object&&(o=F.get(n.constructor)))return o(n,D);let r={};u.push(n),t.push(r);for(let c in n){if(Object.hasOwnProperty.call(n,c)===!1)continue;let s=n[c];if(typeof s!="object"||s===null)r[c]=s;else if(s.constructor!==Object&&(o=F.get(s.constructor)))r[c]=o(s,D);else if(ArrayBuffer.isView(s))r[c]=A(s);else{let a=u.indexOf(s);a!==-1?r[c]=t[a]:r[c]=D(s)}}return u.pop(),t.pop(),r}function i(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return l(n,i);if(n.constructor!==Object&&(o=F.get(n.constructor)))return o(n,i);let r={};u.push(n),t.push(r);for(let c in n){let s=n[c];if(typeof s!="object"||s===null)r[c]=s;else if(s.constructor!==Object&&(o=F.get(s.constructor)))r[c]=o(s,i);else if(ArrayBuffer.isView(s))r[c]=A(s);else{let a=u.indexOf(s);a!==-1?r[c]=t[a]:r[c]=i(s)}}return u.pop(),t.pop(),r}}});var J=Object.hasOwnProperty;var h=U(m(),1),eu=(0,h.default)();function y(e){return e.document.body.dataset.slug}function I(e,u=100){let t=e.getBoundingClientRect();return t.top>=-u&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+u}function _(e,u){let t=e.getBoundingClientRect(),F=u.getBoundingClientRect(),o=e.parentElement?.getBoundingClientRect()||t;return F.top-o.top}function V(e,u){let t=e.getBoundingClientRect(),F=u.getBoundingClientRect();return{min:0,max:t.height-F.height}}function L(e,u,t){let F=_(u,e),o=V(t,u);F=Math.max(F,Math.min(o.min,o.max)),u.style.top=`${F}px`}function f(e,u){let t=e.querySelectorAll("a[data-footnote-ref]"),F=document.querySelector(".sidenotes");if(F)for(let o of t){let l=o.getAttribute("href")?.replace("#","sidebar-"),D=F.querySelector(`.sidenote-element[id="${l}"]`);D&&(u?(D.classList.remove("in-view"),o.classList.remove("active"),D.classList.add("collapsed")):I(o)?(D.classList.add("in-view"),o.classList.add("active"),D.classList.remove("collapsed"),L(o,D,F)):D.classList.remove("collapsed"))}}var S=(e,u)=>`${y(e)}-${u}`;function x(e,u){return localStorage.getItem(S(e,u))}function v(e,u,t){localStorage.setItem(S(e,u),t)}function b(e,u,t,F){e.setAttribute("aria-expanded",F?"false":"true"),u.style.maxHeight=F?"0px":"inherit",e.classList.toggle("collapsed",F),u.classList.toggle("collapsed",F),t.classList.toggle("collapsed",F),f(u,F)}function d(){let e=document.querySelector(".center"),u=document.querySelector(".sidenotes");if(!e||!u)return;let t=0,F=e.children;Array.from(F).forEach(l=>{let D=l.getBoundingClientRect();t+=D.height});let o=window.getComputedStyle(e);t+=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)+parseFloat(o.marginTop)+parseFloat(o.marginBottom),e.style.minHeight=`${t}px`,u.style.height=`${t}px`,u.offsetHeight,requestAnimationFrame(()=>{let l=u.querySelectorAll(".sidenote-element"),D=Array.from(l).filter(i=>i.classList.contains("in-view"));for(let i of D){let n=i.id.replace("sidebar-",""),r=e.querySelector(`a[href="#${n}"]`);r&&L(r,i,u)}})}function H(e,u){let t;return(...F)=>{clearTimeout(t),t=setTimeout(()=>e(...F),u)}}var z=H(d,150);function M(e){let u=e.target;if(!u)return;let t=u.closest(".toggle-button");if(!t||u.parentElement.classList.contains("callout"))return;let F=t.id.replace("collapsible-header-","").replace("-toggle",""),o=document.querySelector(`section.collapsible-header[id="${F}"]`);if(!o)return;e.stopPropagation();let l=document.querySelector(`.collapsible-header-content[data-references="${t.id}"]`);if(!l)return;let D=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",D?"false":"true"),l.style.maxHeight=D?"0px":"inherit",l.classList.toggle("collapsed",D),o.classList.toggle("collapsed",D),t.classList.toggle("collapsed",D),f(l,D),v(window,t.id,D?"false":"true"),requestAnimationFrame(()=>{d(),z()})}function w(){let e=document.querySelectorAll(".collapsible-header");for(let t of e){let F=t.querySelector("button.toggle-button");if(F){F.addEventListener("click",M),window.addCleanup(()=>F.removeEventListener("click",M));let o=document.querySelector(`.collapsible-header-content[data-references="${F.id}"]`);if(o){let l=x(window,F.id);l&&b(F,o,t,l==="false")}}}let u=document.querySelectorAll("svg.blockquote-link");for(let t of u){let l=function(){window.spaNavigate(new URL(o,window.location.toString()))},o=t.parentElement.dataset.href;t.addEventListener("click",l),window.addCleanup(()=>t.removeEventListener("click",l))}}document.addEventListener("nav",w);window.addEventListener("resize",w);
    </script>
  </head>
  <body data-slug="thoughts/sparse-crosscoders" data-language="fr" data-menu="false" data-poem="false">
    <main id="quartz-root" class="page">
      <section id="quartz-body">
        <aside class="left sidebar">
          <div class="toc desktop-only" id="toc" data-layout="minimal">
            <nav id="toc-vertical">
              <button class="depth-0 toc-item" data-depth="0" data-href="#motivations" data-for="motivations" style="--animation-order:1;" aria-label="motivations">
                <div class="fill"></div>
                <div class="indicator">
                  motivations
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#cross-layer-superposition" data-for="cross-layer-superposition" style="--animation-order:2;" aria-label="cross-layer superposition">
                <div class="fill"></div>
                <div class="indicator">
                  cross-layer superposition
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#persistent-features-and-complexity" data-for="persistent-features-and-complexity" style="--animation-order:3;" aria-label="persistent features and complexity">
                <div class="fill"></div>
                <div class="indicator">
                  persistent features and complexity
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#setup" data-for="setup" style="--animation-order:4;" aria-label="setup.">
                <div class="fill"></div>
                <div class="indicator">
                  setup.
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#variants" data-for="variants" style="--animation-order:5;" aria-label="variants">
                <div class="fill"></div>
                <div class="indicator">
                  variants
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#model-diffing" data-for="model-diffing" style="--animation-order:6;" aria-label="model diffing">
                <div class="fill"></div>
                <div class="indicator">
                  model diffing
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#questions" data-for="questions" style="--animation-order:7;" aria-label="questions">
                <div class="fill"></div>
                <div class="indicator">
                  questions
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#reference-label" data-for="reference-label" style="--animation-order:8;" aria-label="References">
                <div class="fill"></div>
                <div class="indicator">
                  References
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#footnote-label" data-for="footnote-label" style="--animation-order:9;" aria-label="Footnotes">
                <div class="fill"></div>
                <div class="indicator">
                  Footnotes
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#backlinks-label" data-for="backlinks-label" style="--animation-order:10;" aria-label="Liens retour">
                <div class="fill"></div>
                <div class="indicator">
                  Liens retour
                </div>
              </button>
            </nav>
          </div>
          <div class="toolbar">
            <div class="toolbar-content">
              <button class="toolbar-item pen-button" aria-label="Toggle toolbar" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="var(--darkgray)" viewBox="0 0 256 256" class="pen-icon">
                  <path d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="reader-button" aria-label="Toggle reader mode" data-active="false">
                <span class="tooltip">
                  Reader mode
                </span>
                <svg class="reader-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="pdf-button" aria-label="Export to PDF">
                <span class="tooltip">
                  Export PDF
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <line x1="10" y1="9" x2="8" y2="9"></line>
                </svg>
              </button>
              <button class="toolbar-item " id="graph-button" aria-label="Toggle global graph">
                <span class="tooltip">
                  Global graph
                </span>
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve">
                  <path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="skew-button" aria-label="add a tiny bit of skew, cuz why not">
                <span class="tooltip">
                  Skew page
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 4l18 16"></path>
                  <path d="M21 4H3"></path>
                  <path d="M21 20H3"></path>
                </svg>
              </button>
            </div>
          </div>
        </aside>
        <section class="center">
          <div class="page-header">
            <header>
              <nav class="breadcrumb-container" aria-label="breadcrumbs">
                <div class="breadcrumb-element">
                  <a href="../">
                    ~
                  </a>
                  <p>
                    /
                  </p>
                </div>
                <div class="breadcrumb-element">
                  <a href="../thoughts/">
                    t
                  </a>
                  <p>
                    /
                  </p>
                </div>
                <div class="breadcrumb-element">
                  <a href>
                    sparse crosscoders
                  </a>
                </div>
              </nav>
              <div class="keybind" lang="fr">
                <kbd id="shortcut-key" data-mapping="[&quot;cmd--'&quot;,&quot;ctrl--'&quot;]">
                  ⌘ '
                </kbd>
                <div id="shortcut-container">
                  <div id="shortcut-space">
                    <div id="title">
                      raccourcis clavier
                    </div>
                    <ul id="shortcut-list">
                      <li>
                        <div id="shortcuts" data-key="⌘--/" data-value="recherche"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--\" data-value="page d'accueil"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--j" data-value="curius"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--b" data-value="lecteur"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--g" data-value="graphique"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--u" data-value="fausser"></div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="search">
                <button class="search-button" id="search-button">
                  <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7">
                    <title>
                      Search
                    </title>
                    <g class="search-path" fill="none">
                      <path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path>
                      <circle cx="8" cy="8" r="7"></circle>
                    </g>
                  </svg>
                </button>
                <div id="search-container">
                  <div id="search-space">
                    <input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Rechercher quelque chose" placeholder="Rechercher quelque chose"/>
                    <div id="search-layout" data-preview="true"></div>
                  </div>
                </div>
              </div>
            </header>
            <div class="popover-hint">
              <hgroup>
                <h1 class="article-title">
                  sparse crosscoders
                </h1>
                <p class="description">
                  and how we observe multiple activation layers. SAE is a special case of sparse crosscoders.
                </p>
              </hgroup>
              <ul class="content-meta">
                <li>
                  <span class="page-creation" title="Date de création du contenu de la page">
                    <em>
                      02 nov. 2024
                    </em>
                  </span>
                </li>
                <li>
                  <a href="../thoughts/sparse-crosscoders.html.md" target="_blank" rel="noopener noreferrer" class="llm-source" style="color: inherit;font-weight: inherit;text-decoration: underline">
                    <span title="voir https://github.com/AnswerDotAI/llms-txt">
                      llms.txt
                    </span>
                  </a>
                </li>
              </ul>
              <ul class="tags">
                <li>
                  <a href="../tags/interp" class="internal tag-link">
                    interp
                  </a>
                </li>
              </ul>
              <div class="spacer"></div>
            </div>
          </div>
          <article class="popover-hint">
            <blockquote class="callout tip" data-callout="tip">
              <div class="callout-title" dir="auto">
                <div class="callout-icon" dir="auto"></div>
                <div class="callout-title-inner" dir="auto">
                  <p dir="auto">
                    maturity
                  </p>
                </div>
              </div>
              <div class="callout-content" dir="auto">
                <p dir="auto">
                  a research preview from Anthroppic and this is pretty much still a work in progress
                </p>
              </div>
            </blockquote>
            <p dir="auto">
              see also
              <a href="https://colab.research.google.com/drive/124ODki4dUjfi21nuZPHRySALx9I74YHj?usp=sharing" class="external alias">
                <span class="indicator-hook"></span>
                reproduction on Gemma 2B
              </a>
              and
              <a href="https://github.com/ckkissane/crosscoder-model-diff-replication" class="external alias">
                <span class="indicator-hook"></span>
                github
              </a>
            </p>
            <p dir="auto">
              A variant of
              <a href="../thoughts/sparse-autoencoder" class="internal alias" data-slug="thoughts/sparse-autoencoder">
                <span class="indicator-hook"></span>
                sparse autoencoder
              </a>
              where it reads and writes to multiple layers
              <cite class id="citation--lindsey2024sparsecrosscoders--1">
                (
                <a href="#bib-lindsey2024sparsecrosscoders" data-no-popover data-bib class="internal alias">
                  <span class="indicator-hook"></span>
                  Lindsey et al., 2024
                </a>
                )
              </cite>
            </p>
            <p dir="auto">
              Crosscoders produces
              <mark>
                shared features across layers and even models
              </mark>
            </p>
            <section class="collapsible-header" id="motivations" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-motivations-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="motivations" dir="auto">
                  motivations
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#motivations" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-motivations-toggle" data-level="2" data-heading-id="motivations">
                  <p dir="auto">
                    Resolve:
                  </p>
                  <ul dir="auto">
                    <li>
                      <p dir="auto">
                        cross-layer features: resolve cross-layer superposition
                      </p>
                    </li>
                    <li>
                      <p dir="auto">
                        circuit simplification: remove redundant features from analysis and enable jumping across training many uninteresting identity circuit connections
                      </p>
                    </li>
                    <li>
                      <p dir="auto">
                        model diffing: produce shared sets of features across models. This also introduce one model across training, and also completely independent models with different architectures.
                      </p>
                    </li>
                  </ul>
                  <section class="collapsible-header" id="cross-layer-superposition" data-level="3">
                    <div class="header-controls">
                      <button id="collapsible-header-cross-layer-superposition-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                        <div class="toggle-icons">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                            <circle cx="12" cy="12" r="3"></circle>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                        </div>
                      </button>
                      <h3 id="cross-layer-superposition" dir="auto">
                        cross-layer
                        <a href="../thoughts/mechanistic-interpretability#superposition-hypothesis" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                          <span class="indicator-hook"></span>
                          superposition
                        </a>
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                          <circle cx="6" cy="12" r="2"></circle>
                          <circle cx="12" cy="12" r="2"></circle>
                          <circle cx="18" cy="12" r="2"></circle>
                        </svg>
                        <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cross-layer-superposition" class="internal">
                          <span class="indicator-hook"></span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                          </svg>
                        </a>
                      </h3>
                    </div>
                    <div class="collapsible-header-content-outer">
                      <div class="collapsible-header-content" data-references="collapsible-header-cross-layer-superposition-toggle" data-level="3" data-heading-id="cross-layer-superposition">
                        <p dir="auto">
                          <img src="../thoughts/images/additive-residual-stream-llm.webp" width="auto" height="auto" alt loading="lazy"/>
                          <em>
                            given the additive properties of transformers’ residual stream,
                            <strong>
                              adjacent layers
                            </strong>
                            in larger transformers can be thought as “almost parallel”
                          </em>
                        </p>
                        <blockquote class="callout tip is-collapsible is-collapsed" data-callout="tip" data-callout-fold>
                          <div class="callout-title" dir="auto">
                            <div class="callout-icon" dir="auto"></div>
                            <div class="callout-title-inner" dir="auto">
                              <p dir="auto">
                                intuition
                              </p>
                            </div>
                            <div class="fold-callout-icon" dir="auto"></div>
                          </div>
                          <div class="callout-content" dir="auto">
                            <p dir="auto">
                              In basis of superposition hypothesis, a feature is a linear combinations of neurons at any given layers.
                            </p>
                            <p dir="auto">
                              <img src="../thoughts/images/feature-neurons.webp" width="auto" height="auto" alt loading="lazy"/>
                            </p>
                          </div>
                        </blockquote>
                        <p dir="auto">
                          <img src="../thoughts/images/one-step-circuit.webp" width="auto" height="auto" alt loading="lazy"/>
                        </p>
                        <p dir="auto">
                          <img src="../thoughts/images/parallel-joint-branch.webp" width="auto" height="auto" alt loading="lazy"/>
                          <em>
                            if we think of adjacent layers as being “almost parallel branches that potentially have superposition between them”, then we can apply dictionary learning jointly
                            <sup>
                              <a href="#user-content-fn-jointlysae" id="user-content-fnref-jointlysae" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                                <span class="indicator-hook"></span>
                                1
                              </a>
                            </sup>
                          </em>
                        </p>
                      </div>
                    </div>
                  </section>
                  <section class="collapsible-header" id="persistent-features-and-complexity" data-level="3">
                    <div class="header-controls">
                      <button id="collapsible-header-persistent-features-and-complexity-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                        <div class="toggle-icons">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                            <circle cx="12" cy="12" r="3"></circle>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                        </div>
                      </button>
                      <h3 id="persistent-features-and-complexity" dir="auto">
                        persistent features and complexity
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                          <circle cx="6" cy="12" r="2"></circle>
                          <circle cx="12" cy="12" r="2"></circle>
                          <circle cx="18" cy="12" r="2"></circle>
                        </svg>
                        <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#persistent-features-and-complexity" class="internal">
                          <span class="indicator-hook"></span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                          </svg>
                        </a>
                      </h3>
                    </div>
                    <div class="collapsible-header-content-outer">
                      <div class="collapsible-header-content" data-references="collapsible-header-persistent-features-and-complexity-toggle" data-level="3" data-heading-id="persistent-features-and-complexity">
                        <p dir="auto">
                          Current drawbacks of sparse autoencoders is that we have to train it against certain activations layers to extract features. In terms of the residual
                          stream per layers, we end up having lots of duplicate features across layers.
                        </p>
                        <blockquote>
                          <p dir="auto">
                            Crosscoders can simplify the circuit
                            <em>
                              given that we use an appropriate architecture
                            </em>
                            <sup>
                              <a href="#user-content-fn-risks" id="user-content-fnref-risks" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                                <span class="indicator-hook"></span>
                                2
                              </a>
                            </sup>
                          </p>
                        </blockquote>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="setup" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-setup-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="setup" dir="auto">
                  setup.
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#setup" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-setup-toggle" data-level="2" data-heading-id="setup">
                  <blockquote>
                    <p dir="auto">
                      Autoencoders and transcoders as special cases of crosscoders.
                    </p>
                    <ul dir="auto">
                      <li>
                        autoencoders: reads and predict the same layers
                      </li>
                      <li>
                        transcoders: read from layer
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    n
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  n
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.4306em;"></span>
                              <span class="mord mathnormal">
                                n
                              </span>
                            </span>
                          </span>
                        </span>
                        and predict layer
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    n
                                  </mi>
                                  <mo>
                                    +
                                  </mo>
                                  <mn>
                                    1
                                  </mn>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  n+1
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                              <span class="mord mathnormal">
                                n
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                              <span class="mbin">
                                +
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.6444em;"></span>
                              <span class="mord">
                                1
                              </span>
                            </span>
                          </span>
                        </span>
                      </li>
                    </ul>
                  </blockquote>
                  <p dir="auto">
                    Crosscoder read/write to many layers, subject to causality constraints.
                  </p>
                  <blockquote class="callout math is-collapsible" data-callout="math" data-callout-fold>
                    <div class="callout-title" dir="auto">
                      <div class="callout-icon" dir="auto"></div>
                      <div class="callout-title-inner" dir="auto">
                        <p dir="auto">
                          crosscoders
                        </p>
                      </div>
                      <div class="fold-callout-icon" dir="auto"></div>
                    </div>
                    <div class="callout-content" dir="auto">
                      <p dir="auto">
                        Let one compute the vector of feature activation
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <msub>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                  </msub>
                                  <msub>
                                    <mi>
                                      x
                                    </mi>
                                    <mi>
                                      j
                                    </mi>
                                  </msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  f_(x_j)
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                  f
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3448em;">
                                        <span style="top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mopen mtight">
                                              (
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3552em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mord">
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3117em;">
                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                              j
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.2861em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mclose">
                                )
                              </span>
                            </span>
                          </span>
                        </span>
                        on data point
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <msub>
                                    <mi>
                                      x
                                    </mi>
                                    <mi>
                                      j
                                    </mi>
                                  </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  x_j
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                              <span class="mord">
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3117em;">
                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                              j
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.2861em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        by summing over contributions of activations of different layers
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <msup>
                                    <mi>
                                      a
                                    </mi>
                                    <mi>
                                      l
                                    </mi>
                                  </msup>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <msub>
                                    <mi>
                                      x
                                    </mi>
                                    <mi>
                                      j
                                    </mi>
                                  </msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  a^l(x_j)
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.1352em;vertical-align:-0.2861em;"></span>
                              <span class="mord">
                                <span class="mord mathnormal">
                                  a
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.8491em;">
                                        <span style="top:-3.063em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mopen">
                                (
                              </span>
                              <span class="mord">
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3117em;">
                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                              j
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.2861em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mclose">
                                )
                              </span>
                            </span>
                          </span>
                        </span>
                        for layers
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  l \in L
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span>
                              <span class="mord mathnormal" style="margin-right:0.01968em;">
                                l
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mrel">
                                ∈
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.6833em;"></span>
                              <span class="mord mathnormal">
                                L
                              </span>
                            </span>
                          </span>
                        </span>
                        :
                      </p>
                      <span class="katex-display">
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                              <semantics>
                                <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mi>
                                            f
                                          </mi>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <msub>
                                            <mi>
                                              x
                                            </mi>
                                            <mi>
                                              j
                                            </mi>
                                          </msub>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            =
                                          </mo>
                                          <mtext>
                                            ReLU
                                          </mtext>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <munder>
                                            <mo>
                                              ∑
                                            </mo>
                                            <mrow>
                                              <mi>
                                                l
                                              </mi>
                                              <mo>
                                                ∈
                                              </mo>
                                              <mi>
                                                L
                                              </mi>
                                            </mrow>
                                          </munder>
                                          <msubsup>
                                            <mi>
                                              W
                                            </mi>
                                            <mtext>
                                              enc
                                            </mtext>
                                            <mi>
                                              l
                                            </mi>
                                          </msubsup>
                                          <msup>
                                            <mi>
                                              a
                                            </mi>
                                            <mi>
                                              l
                                            </mi>
                                          </msup>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <msub>
                                            <mi>
                                              x
                                            </mi>
                                            <mi>
                                              j
                                            </mi>
                                          </msub>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                          <mo>
                                            +
                                          </mo>
                                          <msub>
                                            <mi>
                                              b
                                            </mi>
                                            <mtext>
                                              enc
                                            </mtext>
                                          </msub>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow></mrow>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            ∵
                                          </mo>
                                          <msubsup>
                                            <mi>
                                              W
                                            </mi>
                                            <mtext>
                                              enc
                                            </mtext>
                                            <mi>
                                              l
                                            </mi>
                                          </msubsup>
                                          <mo>
                                            :
                                          </mo>
                                          <mtext>
                                             encoder weights at layer
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow></mrow>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            ∵
                                          </mo>
                                          <msup>
                                            <mi>
                                              a
                                            </mi>
                                            <mi>
                                              l
                                            </mi>
                                          </msup>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <msub>
                                            <mi>
                                              x
                                            </mi>
                                            <mi>
                                              j
                                            </mi>
                                          </msub>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                          <mo>
                                            :
                                          </mo>
                                          <mtext>
                                             activation on datapoint
                                          </mtext>
                                          <msub>
                                            <mi>
                                              x
                                            </mi>
                                            <mi>
                                              j
                                            </mi>
                                          </msub>
                                          <mtext>
                                             at layer
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                </mtable>
                                <annotation encoding="application/x-tex">
                                  \begin{aligned}
                                  f(x_j) &amp;= \text{ReLU}(\sum_{l\in L}W_{\text{enc}}^l a^l(x_j) + b_{\text{enc}}) \\[8pt]
                                  &amp;\because W^l_{\text{enc}} : \text{ encoder weights at layer } l \\[8pt]
                                  &amp;\because a^l(x_j) : \text{ activation on datapoint } x_j \text{ at layer } l \\
                                  \end{aligned}
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:6.5977em;vertical-align:-3.0489em;"></span>
                              <span class="mord">
                                <span class="mtable">
                                  <span class="col-align-r">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:3.5489em;">
                                          <span style="top:-5.5489em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                f
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.3117em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                              j
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-3.0203em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord"></span>
                                          </span>
                                          <span style="top:-0.6612em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord"></span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:3.0489em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="col-align-l">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:3.5489em;">
                                          <span style="top:-5.5489em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord">
                                              <span class="mord"></span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel">
                                                =
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord text">
                                                <span class="mord">
                                                  ReLU
                                                </span>
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mop op-limits">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:1.05em;">
                                                      <span style="top:-1.8479em;margin-left:0em;">
                                                        <span class="pstrut" style="height:3.05em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                              l
                                                            </span>
                                                            <span class="mrel mtight">
                                                              ∈
                                                            </span>
                                                            <span class="mord mathnormal mtight">
                                                              L
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.05em;">
                                                        <span class="pstrut" style="height:3.05em;"></span>
                                                        <span>
                                                          <span class="mop op-symbol large-op">
                                                            ∑
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:1.3295em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mspace" style="margin-right:0.1667em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                  W
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.8991em;">
                                                        <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  enc
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span style="top:-3.113em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                              l
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.247em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.8991em;">
                                                        <span style="top:-3.113em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                              l
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.3117em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                              j
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mbin">
                                                +
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  b
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.1514em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  enc
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.15em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-3.0203em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord">
                                              <span class="mord"></span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel amsrm">
                                                ∵
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                  W
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.8991em;">
                                                        <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  enc
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span style="top:-3.113em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                              l
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.247em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel">
                                                :
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord text">
                                                <span class="mord">
                                                   encoder weights at layer
                                                </span>
                                              </span>
                                              <span class="mord mathnormal" style="margin-right:0.01968em;">
                                                l
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-0.6612em;">
                                            <span class="pstrut" style="height:3.05em;"></span>
                                            <span class="mord">
                                              <span class="mord"></span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel amsrm">
                                                ∵
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.8991em;">
                                                        <span style="top:-3.113em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                              l
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.3117em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                              j
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel">
                                                :
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord text">
                                                <span class="mord">
                                                   activation on datapoint
                                                </span>
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.3117em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                              j
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mord text">
                                                <span class="mord">
                                                   at layer
                                                </span>
                                              </span>
                                              <span class="mord mathnormal" style="margin-right:0.01968em;">
                                                l
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:3.0489em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </div>
                  </blockquote>
                  <p dir="auto">
                    We have loss
                  </p>
                  <span class="katex-display">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                          <semantics>
                            <mrow>
                              <mi>
                                L
                              </mi>
                              <mo>
                                =
                              </mo>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                              </munder>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msup>
                                <mi>
                                  a
                                </mi>
                                <mi>
                                  l
                                </mi>
                              </msup>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mo>
                                −
                              </mo>
                              <msup>
                                <mi>
                                  a
                                </mi>
                                <msup>
                                  <mi>
                                    l
                                  </mi>
                                  <msup>
                                    <mrow></mrow>
                                    <mo mathvariant="normal" lspace="0em" rspace="0em">
                                      ′
                                    </mo>
                                  </msup>
                                </msup>
                              </msup>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <msup>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <mn>
                                  2
                                </mn>
                              </msup>
                              <mo>
                                +
                              </mo>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                              </munder>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mi>
                                  i
                                </mi>
                              </munder>
                              <msub>
                                <mi>
                                  f
                                </mi>
                                <mi>
                                  i
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              L = \sum_{l\in L} \|a^l(x_j) - a^{l^{'}}(x_j)\|^2 + \sum_{l\in L}\sum_i f_i(x_j) \|W^l_{\text{dec,i}}\|
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.6833em;"></span>
                          <span class="mord mathnormal">
                            L
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            =
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8479em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                        <span class="mrel mtight">
                                          ∈
                                        </span>
                                        <span class="mord mathnormal mtight">
                                          L
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.3295em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              a
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8991em;">
                                    <span style="top:-3.113em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          j
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.2861em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            −
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:1.4806em;vertical-align:-0.2861em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              a
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.1945em;">
                                    <span style="top:-3.1945em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7815em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.1164em;">
                                                    <span style="top:-3.1164em;margin-right:0.0714em;">
                                                      <span class="pstrut" style="height:2.6854em;"></span>
                                                      <span class="sizing reset-size3 size1 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mtight">
                                                            <span></span>
                                                            <span class="msupsub">
                                                              <span class="vlist-t">
                                                                <span class="vlist-r">
                                                                  <span class="vlist" style="height:0.9596em;">
                                                                    <span style="top:-2.9596em;margin-right:0.1em;">
                                                                      <span class="pstrut" style="height:2.5556em;"></span>
                                                                      <span class="mord mtight">
                                                                        <span class="mord mtight">
                                                                          ′
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          j
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.2861em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mord">
                            <span class="mord">
                              ∥
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8641em;">
                                    <span style="top:-3.113em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          2
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            +
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8479em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                        <span class="mrel mtight">
                                          ∈
                                        </span>
                                        <span class="mord mathnormal mtight">
                                          L
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.3295em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8723em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.2777em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          j
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.2861em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8991em;">
                                    <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec,i
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.113em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3831em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  <p dir="auto">
                    and regularization can be rewritten as:
                  </p>
                  <span class="katex-display">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                          <semantics>
                            <mrow>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                              </munder>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mi>
                                  i
                                </mi>
                              </munder>
                              <msub>
                                <mi>
                                  f
                                </mi>
                                <mi>
                                  i
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <mo>
                                =
                              </mo>
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mi>
                                  i
                                </mi>
                              </munder>
                              <msub>
                                <mi>
                                  f
                                </mi>
                                <mi>
                                  i
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mo stretchy="false">
                                (
                              </mo>
                              <mstyle scriptlevel="0" displaystyle="true">
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mrow>
                                    <mi>
                                      l
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                </munder>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <msubsup>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    dec,i
                                  </mtext>
                                  <mi>
                                    l
                                  </mi>
                                </msubsup>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \sum_{l\in L}\sum_{i} f_i(x_j) \|W^l_{\text{dec,i}}\| = \sum_{i} f_i(x_j)(\displaystyle\sum_{l \in L} \|W^l_\text{dec,i}\|)
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8479em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                        <span class="mrel mtight">
                                          ∈
                                        </span>
                                        <span class="mord mathnormal mtight">
                                          L
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.3295em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8723em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.2777em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          j
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.2861em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8991em;">
                                    <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec,i
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.113em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3831em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            =
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8723em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.2777em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3117em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          j
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.2861em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mop op-limits">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.05em;">
                                  <span style="top:-1.8479em;margin-left:0em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                        <span class="mrel mtight">
                                          ∈
                                        </span>
                                        <span class="mord mathnormal mtight">
                                          L
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.05em;">
                                    <span class="pstrut" style="height:3.05em;"></span>
                                    <span>
                                      <span class="mop op-symbol large-op">
                                        ∑
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.3295em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8991em;">
                                    <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.113em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3831em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mclose">
                            )
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  <p dir="auto">
                    <em>
                      weight of L1 regularization penalty by L1 norm of per-layer decoder weight norms
                    </em>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \sum\limits{l\in L} \|W^l_\text{dec,i}\|
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                          <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                            ∑
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                              l
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mord mathnormal">
                              L
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8491em;">
                                    <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.063em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.4192em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                        </span>
                      </span>
                    </span>
                    <sup>
                      <a href="#user-content-fn-l2weightnorm" id="user-content-fnref-l2weightnorm" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                        <span class="indicator-hook"></span>
                        3
                      </a>
                    </sup>
                  </p>
                  <p dir="auto">
                    We use L1 due to
                  </p>
                  <ul dir="auto">
                    <li>
                      <p dir="auto">
                        baseline loss comparison: L2 exhibits lower loss than sum of per-layer SAE losses, as they would effectively obtain a loss “bonus” by spreading features across layers
                      </p>
                    </li>
                    <li>
                      <p dir="auto">
                        <mark>
                          layer-wise sparsity surfaces layer-specific features
                        </mark>
                        : based on empirical results of
                        <a href="../thoughts/sparse-crosscoders#model-diffing" class="internal alias" data-slug="thoughts/sparse-crosscoders">
                          <span class="indicator-hook"></span>
                          model diffing
                        </a>
                        , that L1 uncovers a mix of shared and model-specific features, whereas L2 tends to uncover only shared features.
                      </p>
                    </li>
                  </ul>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="variants" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-variants-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="variants" dir="auto">
                  variants
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#variants" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-variants-toggle" data-level="2" data-heading-id="variants">
                  <p dir="auto">
                    <img src="../thoughts/images/crosscoders-variants.webp" width="auto" height="auto" alt loading="lazy"/>
                  </p>
                  <p dir="auto">
                    good to explore:
                  </p>
                  <ol dir="auto">
                    <li>
                      strictly causal crosscoders to capture MLP computation and treat computation performed by attention layers as linear
                    </li>
                    <li>
                      combine strictly causal crosscoders for MLP outputs without weakly causal crosscoders for attention outputs
                    </li>
                    <li>
                      interpretable attention replacement layers that could be used in combination with strictly causal crosscoders for a “replacement model”
                    </li>
                  </ol>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="model-diffing" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-model-diffing-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="model-diffing" dir="auto">
                  model diffing
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#model-diffing" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-model-diffing-toggle" data-level="2" data-heading-id="model-diffing">
                  <p dir="auto">
                    see also:
                    <a href="../thoughts/model-stiching" class="internal alias" data-slug="thoughts/model-stiching">
                      <span class="indicator-hook"></span>
                      model stiching
                    </a>
                    and
                    <a href="../thoughts/SVCCA" class="internal" data-slug="thoughts/SVCCA">
                      <span class="indicator-hook"></span>
                      SVCCA
                    </a>
                  </p>
                  <blockquote>
                    <p dir="auto">
                      <cite class id="citation--doi:10.1080/09515080050002726--2">
                        (
                        <a href="#bib-doi:10.1080/09515080050002726" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Laakso &amp; Cottrell, 2000
                        </a>
                        )
                      </cite>
                      proposes compare
                      <a href="../thoughts/representations" class="internal" data-slug="thoughts/representations">
                        <span class="indicator-hook"></span>
                        representations
                      </a>
                      by transforming into representations of distances between data points.
                      <sup>
                        <a href="#user-content-fn-sne" id="user-content-fnref-sne" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                          <span class="indicator-hook"></span>
                          4
                        </a>
                      </sup>
                    </p>
                  </blockquote>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="questions" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-questions-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="questions" dir="auto">
                  questions
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#questions" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-questions-toggle" data-level="2" data-heading-id="questions">
                  <blockquote>
                    <p dir="auto">
                      How do features change over model training? When do they form?
                    </p>
                  </blockquote>
                  <blockquote>
                    <p dir="auto">
                      As we make a model wider, do we get more features? or they are largely the same, packed less densely?
                    </p>
                  </blockquote>
                </div>
              </div>
            </section>
            <section data-references class="bibliography">
              <h2 id="reference-label" dir="auto">
                References
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reference-label" class="internal">
                  <span class="indicator-hook"></span>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <ul dir="auto">
                <li class="csl-entry" id="bib-gorton2024missingcurvedetectorsinceptionv1">
                  Gorton, L. (2024).
                  <i>
                    The Missing Curve Detectors of InceptionV1: Applying Sparse Autoencoders to InceptionV1 Early Vision
                  </i>
                  . arXiv preprint arXiv:2406.03662
                  <a href="https://arxiv.org/abs/2406.03662" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2406.03662">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-doi:10.1080/09515080050002726">
                  Laakso, A., &amp; Cottrell, G. (2000). Content and cluster analysis: Assessing representational similarity in neural systems.
                  <i>
                    Philosophical Psychology
                  </i>
                  ,
                  <i>
                    13
                  </i>
                  (1), 47–76.
                  <a href="https://doi.org/10.1080/09515080050002726" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                    <span class="indicator-hook"></span>
                    https://doi.org/10.1080/09515080050002726
                  </a>
                </li>
                <li class="csl-entry" id="bib-lindsey2024sparsecrosscoders">
                  Lindsey, J., Templeton, A., Marcus, J., Conerly, T., Batson, J., &amp; Olah, C. (2024). Sparse Crosscoders for Cross-Layer Features and Model Diffing.
                  <i>
                    Transformer Circuits Thread
                  </i>
                  .
                  <a href="https://transformer-circuits.pub/2024/crosscoders/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                    <span class="indicator-hook"></span>
                    [link]
                  </a>
                </li>
              </ul>
            </section>
            <section data-footnotes class="footnotes">
              <h2 class="sr-only" id="footnote-label" dir="auto">
                Footnotes
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#footnote-label" class="internal">
                  <span class="indicator-hook"></span>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <ol dir="auto">
                <li id="user-content-fn-jointlysae">
                  <p dir="auto">
                    <cite class id="citation--gorton2024missingcurvedetectorsinceptionv1--3">
                      (
                      <a href="#bib-gorton2024missingcurvedetectorsinceptionv1" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Gorton, 2024
                      </a>
                      )
                    </cite>
                    denotes that cross-branch superposition is significant in interpreting models with parallel branches (InceptionV1)
                    <a href="#user-content-fnref-jointlysae" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-risks">
                  <p dir="auto">
                    causal description it provides likely differs from that of the underlying model.
                    <a href="#user-content-fnref-risks" data-footnote-backref aria-label="Back to reference 2" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-l2weightnorm">
                  <p dir="auto">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \|W_\text{dec,i}^l\|
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8491em;">
                                    <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.063em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.4192em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                        </span>
                      </span>
                    </span>
                    is the L2 norm of a single feature’s decoder vector at a given layer.
                  </p>
                  <p dir="auto">
                    In principe, one might have expected to use L2 norm of per-layer norm
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msqrt>
                                <mrow>
                                  <msub>
                                    <mo>
                                      ∑
                                    </mo>
                                    <mrow>
                                      <mi>
                                        l
                                      </mi>
                                      <mo>
                                        ∈
                                      </mo>
                                      <mi>
                                        L
                                      </mi>
                                    </mrow>
                                  </msub>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <msubsup>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec,i
                                    </mtext>
                                    <mi>
                                      l
                                    </mi>
                                  </msubsup>
                                  <msup>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mn>
                                      2
                                    </mn>
                                  </msup>
                                </mrow>
                              </msqrt>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \sqrt{\sum_{l \in L} \|W_\text{dec,i}^l\|^2}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1.84em;vertical-align:-0.6583em;"></span>
                          <span class="mord sqrt">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.1817em;">
                                  <span class="svg-align" style="top:-3.8em;">
                                    <span class="pstrut" style="height:3.8em;"></span>
                                    <span class="mord" style="padding-left:1em;">
                                      <span class="mop">
                                        <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                                          ∑
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.1864em;">
                                                <span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                        l
                                                      </span>
                                                      <span class="mrel mtight">
                                                        ∈
                                                      </span>
                                                      <span class="mord mathnormal mtight">
                                                        L
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.3271em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mspace" style="margin-right:0.1667em;"></span>
                                      <span class="mord">
                                        ∥
                                      </span>
                                      <span class="mord">
                                        <span class="mord mathnormal" style="margin-right:0.13889em;">
                                          W
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.8309em;">
                                                <span style="top:-2.3987em;margin-left:-0.1389em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord text mtight">
                                                      <span class="mord mtight">
                                                        dec,i
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span style="top:-3.0448em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                      l
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.4374em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mord">
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.7401em;">
                                                <span style="top:-2.989em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mtight">
                                                      2
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.1417em;">
                                    <span class="pstrut" style="height:3.8em;"></span>
                                    <span class="hide-tail" style="min-width:1.02em;height:1.88em;">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice">
                                        <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path>
                                      </svg>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.6583em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <a href="#user-content-fnref-l2weightnorm" data-footnote-backref aria-label="Back to reference 3" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-sne">
                  <p dir="auto">
                    Chris Colah’s
                    <a href="https://colah.github.io/posts/2015-01-Visualizing-Representations/" class="external alias">
                      <span class="indicator-hook"></span>
                      blog post
                    </a>
                    explains how t-SNE can be used to visualize collections of networks in a function space.
                    <a href="#user-content-fnref-sne" data-footnote-backref aria-label="Back to reference 4" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
              </ol>
            </section>
          </article>
          <div class="page-footer">
            <section data-backlinks="true" class="backlinks">
              <h2 id="backlinks-label">
                Liens retour
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#backlinks-label" class="internal">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <div class="overflow">
                <a href="../thoughts/mechanistic-interpretability" data-backlink="thoughts/mechanistic-interpretability">
                  <div class="small">
                    mechanistic interpretability
                  </div>
                  <div class="description">
                    and reverse engineering neural networks.
                  </div>
                </a>
                <a href="../thoughts/sparse-crosscoders" data-backlink="thoughts/sparse-crosscoders">
                  <div class="small">
                    sparse crosscoders
                  </div>
                  <div class="description">
                    and how we observe multiple activation layers. SAE is a special case of sparse crosscoders.
                  </div>
                </a>
              </div>
            </section>
            <footer class="minimal-footer">
              <ul class="icons">
                <li>
                  <a href="/" target="_self" aria-label="home">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="home" width="1em" height="1em" fill="currentColor" aria-hidden="true">
                      <path d="M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://github.com/aarnphm" target="_blank" aria-label="github">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="var(--gray)" aria-label="true">
                      <path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://twitter.com/aarnphm_" target="_blank" aria-label="twitter">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="twitter" width="1em" height="1em" fill="var(--gray)" aria-hidden="true">
                      <path d="M928 254.3c-30.6 13.2-63.9 22.7-98.2 26.4a170.1 170.1 0 0075-94 336.64 336.64 0 01-108.2 41.2A170.1 170.1 0 00672 174c-94.5 0-170.5 76.6-170.5 170.6 0 13.2 1.6 26.4 4.2 39.1-141.5-7.4-267.7-75-351.6-178.5a169.32 169.32 0 00-23.2 86.1c0 59.2 30.1 111.4 76 142.1a172 172 0 01-77.1-21.7v2.1c0 82.9 58.6 151.6 136.7 167.4a180.6 180.6 0 01-44.9 5.8c-11.1 0-21.6-1.1-32.2-2.6C211 652 273.9 701.1 348.8 702.7c-58.6 45.9-132 72.9-211.7 72.9-14.3 0-27.5-.5-41.2-2.1C171.5 822 261.2 850 357.8 850 671.4 850 843 590.2 843 364.7c0-7.4 0-14.8-.5-22.2 33.2-24.3 62.3-54.4 85.5-88.2z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://bsky.app/profile/aarnphm.xyz" target="_blank" aria-label="bsky">
                    <svg viewBox="0 0 512 512" focusable="false" data-icon="bsky" width="1em" height="1em" aria-hidden="true">
                      <path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2c42.1-31.6 110.3-56 110.3 21.8c0 15.5-8.9 130.5-14.1 149.2C478.2 298 412 314.6 353.1 304.5c102.9 17.5 129.1 75.5 72.5 133.5c-107.4 110.2-154.3-27.6-166.3-62.9l0 0c-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8l0 0c-12 35.3-59 173.1-166.3 62.9c-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1C10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z" fill="#1185fe"></path>
                    </svg>
                  </a>
                </li>
              </ul>
              <p class="info">
                Créé avec
                <a href="https://quartz.jzhao.xyz/" target="_blank" rel="noopener noreferrer" aria-label="Quartz links">
                  Quartz v4.4.0
                </a>
                © 2024
              </p>
            </footer>
          </div>
        </section>
        <section class="right sidebar">
          <div class="graph">
            <div id="global-graph-outer">
              <div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div>
            </div>
          </div>
          <div class="reader" id="reader-view">
            <div class="reader-backdrop"></div>
            <div class="reader-container">
              <div class="reader-header">
                <button class="reader-close" aria-label="Close reader">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div class="reader-content">
                <h1 class="reader-title">
                  sparse crosscoders
                </h1>
                <blockquote class="callout tip" data-callout="tip">
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        maturity
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      a research preview from Anthroppic and this is pretty much still a work in progress
                    </p>
                  </div>
                </blockquote>
                <p dir="auto">
                  see also
                  <a href="https://colab.research.google.com/drive/124ODki4dUjfi21nuZPHRySALx9I74YHj?usp=sharing" class="external alias">
                    <span class="indicator-hook"></span>
                    reproduction on Gemma 2B
                  </a>
                  and
                  <a href="https://github.com/ckkissane/crosscoder-model-diff-replication" class="external alias">
                    <span class="indicator-hook"></span>
                    github
                  </a>
                </p>
                <p dir="auto">
                  A variant of
                  <a href="../thoughts/sparse-autoencoder" class="internal" data-slug="thoughts/sparse-autoencoder" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    sparse autoencoder
                  </a>
                  where it reads and writes to multiple layers
                  <cite class id="citation--lindsey2024sparsecrosscoders--1">
                    (
                    <a href="#bib-lindsey2024sparsecrosscoders-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Lindsey et al., 2024
                    </a>
                    )
                  </cite>
                </p>
                <p dir="auto">
                  Crosscoders produces
                  <mark>
                    shared features across layers and even models
                  </mark>
                </p>
                <h2 id="motivations-reader" dir="auto">
                  motivations
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#motivations-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  Resolve:
                </p>
                <ul dir="auto">
                  <li>
                    <p dir="auto">
                      cross-layer features: resolve cross-layer superposition
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      circuit simplification: remove redundant features from analysis and enable jumping across training many uninteresting identity circuit connections
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      model diffing: produce shared sets of features across models. This also introduce one model across training, and also completely independent models with different architectures.
                    </p>
                  </li>
                </ul>
                <h3 id="cross-layer-superposition-reader" dir="auto">
                  cross-layer
                  <a href="../thoughts/mechanistic-interpretability#superposition-hypothesis" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    superposition
                  </a>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cross-layer-superposition-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  <img src="../thoughts/images/additive-residual-stream-llm.webp" width="auto" height="auto" alt loading="lazy"/>
                  <em>
                    given the additive properties of transformers’ residual stream,
                    <strong>
                      adjacent layers
                    </strong>
                    in larger transformers can be thought as “almost parallel”
                  </em>
                </p>
                <blockquote class="callout" data-callout="tip" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        intuition
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      In basis of superposition hypothesis, a feature is a linear combinations of neurons at any given layers.
                    </p>
                    <p dir="auto">
                      <img src="../thoughts/images/feature-neurons.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                  </div>
                </blockquote>
                <p dir="auto">
                  <img src="../thoughts/images/one-step-circuit.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  <img src="../thoughts/images/parallel-joint-branch.webp" width="auto" height="auto" alt loading="lazy"/>
                  <em>
                    if we think of adjacent layers as being “almost parallel branches that potentially have superposition between them”, then we can apply dictionary learning jointly
                    <sup>
                      <a href="#user-content-fn-jointlysae-reader" id="user-content-fnref-jointlysae-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        1
                      </a>
                    </sup>
                  </em>
                </p>
                <h3 id="persistent-features-and-complexity-reader" dir="auto">
                  persistent features and complexity
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#persistent-features-and-complexity-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  Current drawbacks of sparse autoencoders is that we have to train it against certain activations layers to extract features. In terms of the residual
                  stream per layers, we end up having lots of duplicate features across layers.
                </p>
                <blockquote>
                  <p dir="auto">
                    Crosscoders can simplify the circuit
                    <em>
                      given that we use an appropriate architecture
                    </em>
                    <sup>
                      <a href="#user-content-fn-risks-reader" id="user-content-fnref-risks-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        2
                      </a>
                    </sup>
                  </p>
                </blockquote>
                <h2 id="setup-reader" dir="auto">
                  setup.
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#setup-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    Autoencoders and transcoders as special cases of crosscoders.
                  </p>
                  <ul dir="auto">
                    <li>
                      autoencoders: reads and predict the same layers
                    </li>
                    <li>
                      transcoders: read from layer
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                          </span>
                        </span>
                      </span>
                      and predict layer
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                                <mo>
                                  +
                                </mo>
                                <mn>
                                  1
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n+1
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              +
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              1
                            </span>
                          </span>
                        </span>
                      </span>
                    </li>
                  </ul>
                </blockquote>
                <p dir="auto">
                  Crosscoder read/write to many layers, subject to causality constraints.
                </p>
                <blockquote class="callout" data-callout="math" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        crosscoders
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      Let one compute the vector of feature activation
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                </msub>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                f_(x_j)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3448em;">
                                      <span style="top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mopen mtight">
                                            (
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3552em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      on data point
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x_j
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      by summing over contributions of activations of different layers
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msup>
                                  <mi>
                                    a
                                  </mi>
                                  <mi>
                                    l
                                  </mi>
                                </msup>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                a^l(x_j)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.1352em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                a
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8491em;">
                                      <span style="top:-3.063em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      for layers
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                l \in L
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                              l
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6833em;"></span>
                            <span class="mord mathnormal">
                              L
                            </span>
                          </span>
                        </span>
                      </span>
                      :
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <mtext>
                                          ReLU
                                        </mtext>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <munder>
                                          <mo>
                                            ∑
                                          </mo>
                                          <mrow>
                                            <mi>
                                              l
                                            </mi>
                                            <mo>
                                              ∈
                                            </mo>
                                            <mi>
                                              L
                                            </mi>
                                          </mrow>
                                        </munder>
                                        <msubsup>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </msubsup>
                                        <msup>
                                          <mi>
                                            a
                                          </mi>
                                          <mi>
                                            l
                                          </mi>
                                        </msup>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <msubsup>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </msubsup>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           encoder weights at layer
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <msup>
                                          <mi>
                                            a
                                          </mi>
                                          <mi>
                                            l
                                          </mi>
                                        </msup>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           activation on datapoint
                                        </mtext>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mtext>
                                           at layer
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                f(x_j) &amp;= \text{ReLU}(\sum_{l\in L}W_{\text{enc}}^l a^l(x_j) + b_{\text{enc}}) \\[8pt]
                                &amp;\because W^l_{\text{enc}} : \text{ encoder weights at layer } l \\[8pt]
                                &amp;\because a^l(x_j) : \text{ activation on datapoint } x_j \text{ at layer } l \\
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:6.5977em;vertical-align:-3.0489em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.5489em;">
                                        <span style="top:-5.5489em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0203em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                        <span style="top:-0.6612em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.0489em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.5489em;">
                                        <span style="top:-5.5489em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                ReLU
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mop op-limits">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.05em;">
                                                    <span style="top:-1.8479em;margin-left:0em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                          <span class="mrel mtight">
                                                            ∈
                                                          </span>
                                                          <span class="mord mathnormal mtight">
                                                            L
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-3.05em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span>
                                                        <span class="mop op-symbol large-op">
                                                          ∑
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.3295em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                a
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0203em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 encoder weights at layer
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-0.6612em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                a
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 activation on datapoint
                                              </span>
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 at layer
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.0489em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </div>
                </blockquote>
                <p dir="auto">
                  We have loss
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <mi>
                              L
                            </mi>
                            <mo>
                              =
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msup>
                              <mi>
                                a
                              </mi>
                              <mi>
                                l
                              </mi>
                            </msup>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo>
                              −
                            </mo>
                            <msup>
                              <mi>
                                a
                              </mi>
                              <msup>
                                <mi>
                                  l
                                </mi>
                                <msup>
                                  <mrow></mrow>
                                  <mo mathvariant="normal" lspace="0em" rspace="0em">
                                    ′
                                  </mo>
                                </msup>
                              </msup>
                            </msup>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <msup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <mn>
                                2
                              </mn>
                            </msup>
                            <mo>
                              +
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            L = \sum_{l\in L} \|a^l(x_j) - a^{l^{'}}(x_j)\|^2 + \sum_{l\in L}\sum_i f_i(x_j) \|W^l_{\text{dec,i}}\|
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6833em;"></span>
                        <span class="mord mathnormal">
                          L
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1.4806em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.1945em;">
                                  <span style="top:-3.1945em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7815em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:1.1164em;">
                                                  <span style="top:-3.1164em;margin-right:0.0714em;">
                                                    <span class="pstrut" style="height:2.6854em;"></span>
                                                    <span class="sizing reset-size3 size1 mtight">
                                                      <span class="mord mtight">
                                                        <span class="mord mtight">
                                                          <span></span>
                                                          <span class="msupsub">
                                                            <span class="vlist-t">
                                                              <span class="vlist-r">
                                                                <span class="vlist" style="height:0.9596em;">
                                                                  <span style="top:-2.9596em;margin-right:0.1em;">
                                                                    <span class="pstrut" style="height:2.5556em;"></span>
                                                                    <span class="mord mtight">
                                                                      <span class="mord mtight">
                                                                        ′
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          <span class="mord">
                            ∥
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8641em;">
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        2
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          +
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mathnormal mtight">
                                      i
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  and regularization can be rewritten as:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <mo>
                              =
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mstyle scriptlevel="0" displaystyle="true">
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                              </munder>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mstyle>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \sum_{l\in L}\sum_{i} f_i(x_j) \|W^l_{\text{dec,i}}\| = \sum_{i} f_i(x_j)(\displaystyle\sum_{l \in L} \|W^l_\text{dec,i}\|)
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          dec,i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mclose">
                          )
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  <em>
                    weight of L1 regularization penalty by L1 norm of per-layer decoder weight norms
                  </em>
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mo>
                              ∑
                            </mo>
                            <mrow>
                              <mi>
                                l
                              </mi>
                              <mo>
                                ∈
                              </mo>
                              <mi>
                                L
                              </mi>
                            </mrow>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \sum\limits{l\in L} \|W^l_\text{dec,i}\|
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                        <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                          ∑
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.01968em;">
                            l
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            ∈
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mord mathnormal">
                            L
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8491em;">
                                  <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          dec,i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.063em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.4192em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                      </span>
                    </span>
                  </span>
                  <sup>
                    <a href="#user-content-fn-l2weightnorm-reader" id="user-content-fnref-l2weightnorm-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      3
                    </a>
                  </sup>
                </p>
                <p dir="auto">
                  We use L1 due to
                </p>
                <ul dir="auto">
                  <li>
                    <p dir="auto">
                      baseline loss comparison: L2 exhibits lower loss than sum of per-layer SAE losses, as they would effectively obtain a loss “bonus” by spreading features across layers
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      <mark>
                        layer-wise sparsity surfaces layer-specific features
                      </mark>
                      : based on empirical results of
                      <a href="../thoughts/sparse-crosscoders#model-diffing" class="internal" data-slug="thoughts/sparse-crosscoders" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        model diffing
                      </a>
                      , that L1 uncovers a mix of shared and model-specific features, whereas L2 tends to uncover only shared features.
                    </p>
                  </li>
                </ul>
                <h2 id="variants-reader" dir="auto">
                  variants
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#variants-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  <img src="../thoughts/images/crosscoders-variants.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  good to explore:
                </p>
                <ol dir="auto">
                  <li>
                    strictly causal crosscoders to capture MLP computation and treat computation performed by attention layers as linear
                  </li>
                  <li>
                    combine strictly causal crosscoders for MLP outputs without weakly causal crosscoders for attention outputs
                  </li>
                  <li>
                    interpretable attention replacement layers that could be used in combination with strictly causal crosscoders for a “replacement model”
                  </li>
                </ol>
                <h2 id="model-diffing-reader" dir="auto">
                  model diffing
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#model-diffing-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  see also:
                  <a href="../thoughts/model-stiching" class="internal" data-slug="thoughts/model-stiching" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    model stiching
                  </a>
                  and
                  <a href="../thoughts/SVCCA" class="internal" data-slug="thoughts/SVCCA" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    SVCCA
                  </a>
                </p>
                <blockquote>
                  <p dir="auto">
                    <cite class id="citation--doi:10.1080/09515080050002726--2">
                      (
                      <a href="#bib-doi:10.1080/09515080050002726-reader" data-no-popover="true" data-bib class="internal">
                        <span class="indicator-hook"></span>
                        Laakso &amp; Cottrell, 2000
                      </a>
                      )
                    </cite>
                    proposes compare
                    <a href="../thoughts/representations" class="internal" data-slug="thoughts/representations" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      representations
                    </a>
                    by transforming into representations of distances between data points.
                    <sup>
                      <a href="#user-content-fn-sne-reader" id="user-content-fnref-sne-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        4
                      </a>
                    </sup>
                  </p>
                </blockquote>
                <h2 id="questions-reader" dir="auto">
                  questions
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#questions-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    How do features change over model training? When do they form?
                  </p>
                </blockquote>
                <blockquote>
                  <p dir="auto">
                    As we make a model wider, do we get more features? or they are largely the same, packed less densely?
                  </p>
                </blockquote>
                <section data-references class="bibliography">
                  <h2 id="reference-label-reader" dir="auto">
                    References
                    <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reference-label-reader" class="internal">
                      <span class="indicator-hook"></span>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                      </svg>
                    </a>
                  </h2>
                  <ul dir="auto">
                    <li class="csl-entry" id="bib-gorton2024missingcurvedetectorsinceptionv1-reader">
                      Gorton, L. (2024).
                      <i>
                        The Missing Curve Detectors of InceptionV1: Applying Sparse Autoencoders to InceptionV1 Early Vision
                      </i>
                      . arXiv preprint arXiv:2406.03662
                      <a href="https://arxiv.org/abs/2406.03662" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2406.03662" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-doi:10.1080/09515080050002726-reader">
                      Laakso, A., &amp; Cottrell, G. (2000). Content and cluster analysis: Assessing representational similarity in neural systems.
                      <i>
                        Philosophical Psychology
                      </i>
                      ,
                      <i>
                        13
                      </i>
                      (1), 47–76.
                      <a href="https://doi.org/10.1080/09515080050002726" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                        <span class="indicator-hook"></span>
                        https://doi.org/10.1080/09515080050002726
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-lindsey2024sparsecrosscoders-reader">
                      Lindsey, J., Templeton, A., Marcus, J., Conerly, T., Batson, J., &amp; Olah, C. (2024). Sparse Crosscoders for Cross-Layer Features and Model Diffing.
                      <i>
                        Transformer Circuits Thread
                      </i>
                      .
                      <a href="https://transformer-circuits.pub/2024/crosscoders/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                        <span class="indicator-hook"></span>
                        [link]
                      </a>
                    </li>
                  </ul>
                </section>
                <section data-footnotes class="footnotes">
                  <h2 class="sr-only" id="footnote-label-reader" dir="auto">
                    Footnotes
                    <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#footnote-label-reader" class="internal">
                      <span class="indicator-hook"></span>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                      </svg>
                    </a>
                  </h2>
                  <ol dir="auto">
                    <li id="user-content-fn-jointlysae-reader">
                      <p dir="auto">
                        <cite class id="citation--gorton2024missingcurvedetectorsinceptionv1--3">
                          (
                          <a href="#bib-gorton2024missingcurvedetectorsinceptionv1-reader" data-no-popover="true" data-bib class="internal">
                            <span class="indicator-hook"></span>
                            Gorton, 2024
                          </a>
                          )
                        </cite>
                        denotes that cross-branch superposition is significant in interpreting models with parallel branches (InceptionV1)
                        <a href="#user-content-fnref-jointlysae-reader" data-footnote-backref aria-label="Back to reference 1" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-risks-reader">
                      <p dir="auto">
                        causal description it provides likely differs from that of the underlying model.
                        <a href="#user-content-fnref-risks-reader" data-footnote-backref aria-label="Back to reference 2" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-l2weightnorm-reader">
                      <p dir="auto">
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <msubsup>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec,i
                                    </mtext>
                                    <mi>
                                      l
                                    </mi>
                                  </msubsup>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  \|W_\text{dec,i}^l\|
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                              <span class="mord">
                                ∥
                              </span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.13889em;">
                                  W
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.8491em;">
                                        <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord text mtight">
                                              <span class="mord mtight">
                                                dec,i
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.063em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.4192em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mord">
                                ∥
                              </span>
                            </span>
                          </span>
                        </span>
                        is the L2 norm of a single feature’s decoder vector at a given layer.
                      </p>
                      <p dir="auto">
                        In principe, one might have expected to use L2 norm of per-layer norm
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <msqrt>
                                    <mrow>
                                      <msub>
                                        <mo>
                                          ∑
                                        </mo>
                                        <mrow>
                                          <mi>
                                            l
                                          </mi>
                                          <mo>
                                            ∈
                                          </mo>
                                          <mi>
                                            L
                                          </mi>
                                        </mrow>
                                      </msub>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <msubsup>
                                        <mi>
                                          W
                                        </mi>
                                        <mtext>
                                          dec,i
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </msubsup>
                                      <msup>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mn>
                                          2
                                        </mn>
                                      </msup>
                                    </mrow>
                                  </msqrt>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  \sqrt{\sum_{l \in L} \|W_\text{dec,i}^l\|^2}
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.84em;vertical-align:-0.6583em;"></span>
                              <span class="mord sqrt">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:1.1817em;">
                                      <span class="svg-align" style="top:-3.8em;">
                                        <span class="pstrut" style="height:3.8em;"></span>
                                        <span class="mord" style="padding-left:1em;">
                                          <span class="mop">
                                            <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                                              ∑
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.1864em;">
                                                    <span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                          <span class="mrel mtight">
                                                            ∈
                                                          </span>
                                                          <span class="mord mathnormal mtight">
                                                            L
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.3271em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mspace" style="margin-right:0.1667em;"></span>
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                                              W
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.8309em;">
                                                    <span style="top:-2.3987em;margin-left:-0.1389em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord text mtight">
                                                          <span class="mord mtight">
                                                            dec,i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-3.0448em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                          l
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.4374em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mord">
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.7401em;">
                                                    <span style="top:-2.989em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          2
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.1417em;">
                                        <span class="pstrut" style="height:3.8em;"></span>
                                        <span class="hide-tail" style="min-width:1.02em;height:1.88em;">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice">
                                            <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path>
                                          </svg>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.6583em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <a href="#user-content-fnref-l2weightnorm-reader" data-footnote-backref aria-label="Back to reference 3" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-sne-reader">
                      <p dir="auto">
                        Chris Colah’s
                        <a href="https://colah.github.io/posts/2015-01-Visualizing-Representations/" class="external alias">
                          <span class="indicator-hook"></span>
                          blog post
                        </a>
                        explains how t-SNE can be used to visualize collections of networks in a function space.
                        <a href="#user-content-fnref-sne-reader" data-footnote-backref aria-label="Back to reference 4" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                  </ol>
                </section>
              </div>
            </div>
          </div>
          <div class="image-popup-modal" id="image-popup-modal">
            <div class="image-popup-backdrop"></div>
            <div class="image-popup-content">
              <button class="image-popup-close" aria-label="Close popup">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
              <img class="image-popup-img" src alt/>
            </div>
          </div>
          <div id="mermaid-container">
            <div class="mermaid-backdrop"></div>
            <div id="mermaid-space">
              <div class="mermaid-header">
                <button class="close-button" aria-label="close button">
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div class="mermaid-content"></div>
            </div>
          </div>
        </section>
      </section>
    </main>
  </body>
  <script type="application/javascript">
    function i(){let l=this.parentElement;l.classList.toggle("is-collapsed");let e=l.classList.contains("is-collapsed")?this.scrollHeight:l.scrollHeight;l.style.maxHeight=e+"px";let s=l,t=l.parentElement;for(;t;){if(!t.classList.contains("callout"))return;let a=t.classList.contains("is-collapsed")?t.scrollHeight:t.scrollHeight+s.scrollHeight;t.style.maxHeight=a+"px",s=t,t=t.parentElement}}function r(l){let o=l.getBoundingClientRect(),e=1056,s=o.height;return o.top%e+s>e}function c(){let l=document.getElementsByClassName("callout is-collapsible");for(let e of l){let s=e.firstElementChild;if(s){s.addEventListener("click",i),window.addCleanup(()=>s.removeEventListener("click",i));let n=e.classList.contains("is-collapsed")?s.scrollHeight:e.scrollHeight;e.style.maxHeight=n+"px"}}let o=document.getElementsByClassName("callout");for(let e of o)r(e)&&(e.style.pageBreakBefore="always",e.classList.add("force-page-break"))}document.addEventListener("nav",c);window.addEventListener("resize",c);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script>
  <script src="../postscript.js" type="module"></script>
</html>