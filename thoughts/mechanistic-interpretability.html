<!DOCTYPE html>
<!--
/*************************************************************************
* Bop got your nose !!!
*
* Hehe
*
* Anw if you see a component you like ping @aarnphm on Discord I can try
* to send it your way. Have a wonderful day!
**************************************************************************/
-->
<html lang="fr">
  <head>
    <title>
      mechanistic interpretability - Aaron's notes
    </title>
    <meta charset="utf-8"/>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains Mono&amp;family=Newsreader:wght@400;700&amp;family=Newsreader:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="true"/>
    <link rel="preconnect" href="https://plausible.io" crossorigin="true"/>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="og:site_name" content="Aaron's notes"/>
    <meta property="og:locale" content="fr-FR"/>
    <meta property="og:title" content="mechanistic interpretability - Aaron's notes"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:site" content="@aarnphm_"/>
    <meta name="twitter:creator" content="@aarnphm_"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="mechanistic interpretability - Aaron's notes"/>
    <meta name="twitter:description" content="and reverse engineering neural networks."/>
    <meta property="og:description" content="and reverse engineering neural networks."/>
    <meta property="og:image:type" content="image/webp"/>
    <meta property="og:image:alt" content="and reverse engineering neural networks."/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:width" content="1200"/>
    <meta property="og:height" content="630"/>
    <meta property="og:image" content="https://aarnphm.xyz/static/social-images/thoughts-mechanistic-interpretability.webp"/>
    <meta property="og:url" content="https:/aarnphm.xyz/thoughts/mechanistic-interpretability"/>
    <meta property="og:image" content="https://aarnphm.xyz/static/social-images/thoughts-mechanistic-interpretability.webp"/>
    <meta name="twitter:image" content="https://aarnphm.xyz/static/social-images/thoughts-mechanistic-interpretability.webp"/>
    <meta property="twitter:domain" content="https://aarnphm.xyz/"/>
    <meta property="twitter:url" content="https:/aarnphm.xyz/thoughts/mechanistic-interpretability"/>
    <link rel="icon" href="../static/icon.webp"/>
    <link rel="canonical" href="https:/aarnphm.xyz/thoughts/mechanistic-interpretability"/>
    <meta name="description" content="and reverse engineering neural networks."/>
    <meta name="generator" content="Quartz"/>
    <link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/>
    <style>
      .collapsible-header {
      position: relative;
      margin-left: -9px;
      }
      .collapsible-header:first-child {
      margin-top: 1rem;
      }
      .collapsible-header:last-child {
      margin-bottom: 1rem;
      }
      .collapsible-header[data-level=&quot;2&quot;] {
      margin-left: 1rem;
      }
      .collapsible-header[data-level=&quot;3&quot;] {
      margin-left: 1.5rem;
      }
      .collapsible-header[data-level=&quot;4&quot;] {
      margin-left: 1.9rem;
      }
      .collapsible-header[data-level=&quot;5&quot;] {
      margin-left: 2.2rem;
      }
      .collapsible-header[data-level=&quot;6&quot;] {
      margin-left: 2.4rem;
      }
      .collapsible-header .collapsed-dots {
      display: none;
      }
      .collapsible-header.collapsed {
      margin-bottom: 1rem;
      }
      .collapsible-header.collapsed .collapsed-dots {
      display: block;
      }
      .collapsible-header .header-controls {
      display: grid;
      grid-template-columns: auto 1fr;
      align-items: center;
      }
      .collapsible-header .header-controls .toggle-button {
      grid-column: 1;
      }
      .collapsible-header .toggle-button {
      background-color: transparent;
      border: none;
      text-align: left;
      cursor: pointer;
      padding: 0;
      color: var(--dark);
      display: inline-flex;
      align-items: center;
      }
      .collapsible-header .toggle-button:hover .circle-icon {
      display: none;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=true] .collapse-icon {
      display: block;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=true] .expand-icon {
      display: none;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=false] .expand-icon {
      display: block;
      }
      .collapsible-header .toggle-button:hover[aria-expanded=false] .collapse-icon {
      display: none;
      }
      .collapsible-header .toggle-icons {
      display: grid;
      grid-template-columns: 1fr;
      }
      .collapsible-header .toggle-icons .circle-icon,
      .collapsible-header .toggle-icons .expand-icon,
      .collapsible-header .toggle-icons .collapse-icon {
      opacity: 0.85;
      grid-column: 1;
      grid-row: 1;
      }
      .collapsible-header .toggle-icons .circle-icon {
      display: block;
      }
      .collapsible-header .toggle-icons .expand-icon,
      .collapsible-header .toggle-icons .collapse-icon {
      display: none;
      }
      .collapsible-header.collapsed :where(h1, h2, h3, h4, h5, h6):not(.popover *) {
      display: inline-flex;
      align-items: center;
      }
      .collapsible-header :where(h1, h2, h3, h4, h5, h6):not(.popover *) {
      margin: 0;
      }
      .collapsible-header .collapsible-header-content-outer {
      padding-left: 9px;
      padding-bottom: 9px;
      }
      .collapsible-header .collapsible-header-content-outer .collapsible-header-content {
      border-left: 1px solid var(--lightgray);
      overflow: hidden;
      padding-left: 9px;
      max-height: none;
      }
      .collapsible-header .collapsible-header-content-outer .collapsible-header-content.collapsed {
      max-height: 0 !important;
      padding-top: 0;
      padding-bottom: 0;
      }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/node-tikzjax@latest/css/fonts.css" rel="stylesheet" type="text/css" spa-preserve/>
    <link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/>
    <script src="../prescript.js" type="application/javascript" spa-preserve></script>
    <script type="application/javascript" spa-preserve>
      const fetchData = fetch("../static/contentIndex.json").then(data => data.json())
    </script>
    <script type="application/javascript" spa-preserve>
      var T=Object.create;var g=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var q=(e,u)=>()=>(u||e((u={exports:{}}).exports,u),u.exports);var P=(e,u,t,F)=>{if(u&&typeof u=="object"||typeof u=="function")for(let o of j(u))!O.call(e,o)&&o!==t&&g(e,o,{get:()=>u[o],enumerable:!(F=R(u,o))||F.enumerable});return e};var U=(e,u,t)=>(t=e!=null?T(k(e)):{},P(u||!e||!e.__esModule?g(t,"default",{value:e,enumerable:!0}):t,e));var m=q((X,p)=>{"use strict";p.exports=W;function A(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function W(e){if(e=e||{},e.circles)return $(e);let u=new Map;if(u.set(Date,D=>new Date(D)),u.set(Map,(D,i)=>new Map(F(Array.from(D),i))),u.set(Set,(D,i)=>new Set(F(Array.from(D),i))),e.constructorHandlers)for(let D of e.constructorHandlers)u.set(D[0],D[1]);let t=null;return e.proto?l:o;function F(D,i){let n=Object.keys(D),r=new Array(n.length);for(let c=0;c<n.length;c++){let s=n[c],a=D[s];typeof a!="object"||a===null?r[s]=a:a.constructor!==Object&&(t=u.get(a.constructor))?r[s]=t(a,i):ArrayBuffer.isView(a)?r[s]=A(a):r[s]=i(a)}return r}function o(D){if(typeof D!="object"||D===null)return D;if(Array.isArray(D))return F(D,o);if(D.constructor!==Object&&(t=u.get(D.constructor)))return t(D,o);let i={};for(let n in D){if(Object.hasOwnProperty.call(D,n)===!1)continue;let r=D[n];typeof r!="object"||r===null?i[n]=r:r.constructor!==Object&&(t=u.get(r.constructor))?i[n]=t(r,o):ArrayBuffer.isView(r)?i[n]=A(r):i[n]=o(r)}return i}function l(D){if(typeof D!="object"||D===null)return D;if(Array.isArray(D))return F(D,l);if(D.constructor!==Object&&(t=u.get(D.constructor)))return t(D,l);let i={};for(let n in D){let r=D[n];typeof r!="object"||r===null?i[n]=r:r.constructor!==Object&&(t=u.get(r.constructor))?i[n]=t(r,l):ArrayBuffer.isView(r)?i[n]=A(r):i[n]=l(r)}return i}}function $(e){let u=[],t=[],F=new Map;if(F.set(Date,n=>new Date(n)),F.set(Map,(n,r)=>new Map(l(Array.from(n),r))),F.set(Set,(n,r)=>new Set(l(Array.from(n),r))),e.constructorHandlers)for(let n of e.constructorHandlers)F.set(n[0],n[1]);let o=null;return e.proto?i:D;function l(n,r){let c=Object.keys(n),s=new Array(c.length);for(let a=0;a<c.length;a++){let C=c[a],E=n[C];if(typeof E!="object"||E===null)s[C]=E;else if(E.constructor!==Object&&(o=F.get(E.constructor)))s[C]=o(E,r);else if(ArrayBuffer.isView(E))s[C]=A(E);else{let B=u.indexOf(E);B!==-1?s[C]=t[B]:s[C]=r(E)}}return s}function D(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return l(n,D);if(n.constructor!==Object&&(o=F.get(n.constructor)))return o(n,D);let r={};u.push(n),t.push(r);for(let c in n){if(Object.hasOwnProperty.call(n,c)===!1)continue;let s=n[c];if(typeof s!="object"||s===null)r[c]=s;else if(s.constructor!==Object&&(o=F.get(s.constructor)))r[c]=o(s,D);else if(ArrayBuffer.isView(s))r[c]=A(s);else{let a=u.indexOf(s);a!==-1?r[c]=t[a]:r[c]=D(s)}}return u.pop(),t.pop(),r}function i(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return l(n,i);if(n.constructor!==Object&&(o=F.get(n.constructor)))return o(n,i);let r={};u.push(n),t.push(r);for(let c in n){let s=n[c];if(typeof s!="object"||s===null)r[c]=s;else if(s.constructor!==Object&&(o=F.get(s.constructor)))r[c]=o(s,i);else if(ArrayBuffer.isView(s))r[c]=A(s);else{let a=u.indexOf(s);a!==-1?r[c]=t[a]:r[c]=i(s)}}return u.pop(),t.pop(),r}}});var J=Object.hasOwnProperty;var h=U(m(),1),eu=(0,h.default)();function y(e){return e.document.body.dataset.slug}function I(e,u=100){let t=e.getBoundingClientRect();return t.top>=-u&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+u}function _(e,u){let t=e.getBoundingClientRect(),F=u.getBoundingClientRect(),o=e.parentElement?.getBoundingClientRect()||t;return F.top-o.top}function V(e,u){let t=e.getBoundingClientRect(),F=u.getBoundingClientRect();return{min:0,max:t.height-F.height}}function L(e,u,t){let F=_(u,e),o=V(t,u);F=Math.max(F,Math.min(o.min,o.max)),u.style.top=`${F}px`}function f(e,u){let t=e.querySelectorAll("a[data-footnote-ref]"),F=document.querySelector(".sidenotes");if(F)for(let o of t){let l=o.getAttribute("href")?.replace("#","sidebar-"),D=F.querySelector(`.sidenote-element[id="${l}"]`);D&&(u?(D.classList.remove("in-view"),o.classList.remove("active"),D.classList.add("collapsed")):I(o)?(D.classList.add("in-view"),o.classList.add("active"),D.classList.remove("collapsed"),L(o,D,F)):D.classList.remove("collapsed"))}}var S=(e,u)=>`${y(e)}-${u}`;function x(e,u){return localStorage.getItem(S(e,u))}function v(e,u,t){localStorage.setItem(S(e,u),t)}function b(e,u,t,F){e.setAttribute("aria-expanded",F?"false":"true"),u.style.maxHeight=F?"0px":"inherit",e.classList.toggle("collapsed",F),u.classList.toggle("collapsed",F),t.classList.toggle("collapsed",F),f(u,F)}function d(){let e=document.querySelector(".center"),u=document.querySelector(".sidenotes");if(!e||!u)return;let t=0,F=e.children;Array.from(F).forEach(l=>{let D=l.getBoundingClientRect();t+=D.height});let o=window.getComputedStyle(e);t+=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)+parseFloat(o.marginTop)+parseFloat(o.marginBottom),e.style.minHeight=`${t}px`,u.style.height=`${t}px`,u.offsetHeight,requestAnimationFrame(()=>{let l=u.querySelectorAll(".sidenote-element"),D=Array.from(l).filter(i=>i.classList.contains("in-view"));for(let i of D){let n=i.id.replace("sidebar-",""),r=e.querySelector(`a[href="#${n}"]`);r&&L(r,i,u)}})}function H(e,u){let t;return(...F)=>{clearTimeout(t),t=setTimeout(()=>e(...F),u)}}var z=H(d,150);function M(e){let u=e.target;if(!u)return;let t=u.closest(".toggle-button");if(!t||u.parentElement.classList.contains("callout"))return;let F=t.id.replace("collapsible-header-","").replace("-toggle",""),o=document.querySelector(`section.collapsible-header[id="${F}"]`);if(!o)return;e.stopPropagation();let l=document.querySelector(`.collapsible-header-content[data-references="${t.id}"]`);if(!l)return;let D=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",D?"false":"true"),l.style.maxHeight=D?"0px":"inherit",l.classList.toggle("collapsed",D),o.classList.toggle("collapsed",D),t.classList.toggle("collapsed",D),f(l,D),v(window,t.id,D?"false":"true"),requestAnimationFrame(()=>{d(),z()})}function w(){let e=document.querySelectorAll(".collapsible-header");for(let t of e){let F=t.querySelector("button.toggle-button");if(F){F.addEventListener("click",M),window.addCleanup(()=>F.removeEventListener("click",M));let o=document.querySelector(`.collapsible-header-content[data-references="${F.id}"]`);if(o){let l=x(window,F.id);l&&b(F,o,t,l==="false")}}}let u=document.querySelectorAll("svg.blockquote-link");for(let t of u){let l=function(){window.spaNavigate(new URL(o,window.location.toString()))},o=t.parentElement.dataset.href;t.addEventListener("click",l),window.addCleanup(()=>t.removeEventListener("click",l))}}document.addEventListener("nav",w);window.addEventListener("resize",w);
    </script>
  </head>
  <body data-slug="thoughts/mechanistic-interpretability" data-language="fr" data-menu="false" data-poem="false">
    <main id="quartz-root" class="page">
      <section id="quartz-body">
        <aside class="left sidebar">
          <div class="toc desktop-only" id="toc" data-layout="minimal">
            <nav id="toc-vertical">
              <button class="depth-0 toc-item" data-depth="0" data-href="#inference" data-for="inference" style="--animation-order:1;" aria-label="inference">
                <div class="fill"></div>
                <div class="indicator">
                  inference
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#steering" data-for="steering" style="--animation-order:2;" aria-label="steering">
                <div class="fill"></div>
                <div class="indicator">
                  steering
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#contrastive-activation-additions" data-for="contrastive-activation-additions" style="--animation-order:3;" aria-label="contrastive activation additions">
                <div class="fill"></div>
                <div class="indicator">
                  contrastive activation additions
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#sparse-autoencoders" data-for="sparse-autoencoders" style="--animation-order:4;" aria-label="sparse autoencoders">
                <div class="fill"></div>
                <div class="indicator">
                  sparse autoencoders
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#gated-sae" data-for="gated-sae" style="--animation-order:5;" aria-label="Gated SAE">
                <div class="fill"></div>
                <div class="indicator">
                  Gated SAE
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#feature-suppression" data-for="feature-suppression" style="--animation-order:6;" aria-label="feature suppression">
                <div class="fill"></div>
                <div class="indicator">
                  feature suppression
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#sparse-crosscoders" data-for="sparse-crosscoders" style="--animation-order:7;" aria-label="sparse crosscoders">
                <div class="fill"></div>
                <div class="indicator">
                  sparse crosscoders
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#motivations" data-for="motivations" style="--animation-order:8;" aria-label="motivations">
                <div class="fill"></div>
                <div class="indicator">
                  motivations
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#cross-layer-superposition" data-for="cross-layer-superposition" style="--animation-order:9;" aria-label="cross-layer superposition">
                <div class="fill"></div>
                <div class="indicator">
                  cross-layer superposition
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#persistent-features-and-complexity" data-for="persistent-features-and-complexity" style="--animation-order:10;" aria-label="persistent features and complexity">
                <div class="fill"></div>
                <div class="indicator">
                  persistent features and complexity
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#setup" data-for="setup" style="--animation-order:11;" aria-label="setup.">
                <div class="fill"></div>
                <div class="indicator">
                  setup.
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#variants" data-for="variants" style="--animation-order:12;" aria-label="variants">
                <div class="fill"></div>
                <div class="indicator">
                  variants
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#model-diffing" data-for="model-diffing" style="--animation-order:13;" aria-label="model diffing">
                <div class="fill"></div>
                <div class="indicator">
                  model diffing
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#questions" data-for="questions" style="--animation-order:14;" aria-label="questions">
                <div class="fill"></div>
                <div class="indicator">
                  questions
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#superposition-hypothesis" data-for="superposition-hypothesis" style="--animation-order:15;" aria-label="superposition hypothesis">
                <div class="fill"></div>
                <div class="indicator">
                  superposition hypothesis
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#importance" data-for="importance" style="--animation-order:16;" aria-label="importance">
                <div class="fill"></div>
                <div class="indicator">
                  importance
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#over-complete-basis" data-for="over-complete-basis" style="--animation-order:17;" aria-label="over-complete basis">
                <div class="fill"></div>
                <div class="indicator">
                  over-complete basis
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#features" data-for="features" style="--animation-order:18;" aria-label="features">
                <div class="fill"></div>
                <div class="indicator">
                  features
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#ablation" data-for="ablation" style="--animation-order:19;" aria-label="ablation">
                <div class="fill"></div>
                <div class="indicator">
                  ablation
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#residual-stream" data-for="residual-stream" style="--animation-order:20;" aria-label="residual stream">
                <div class="fill"></div>
                <div class="indicator">
                  residual stream
                </div>
              </button>
              <button class="depth-0 toc-item" data-depth="0" data-href="#grokking" data-for="grokking" style="--animation-order:21;" aria-label="grokking">
                <div class="fill"></div>
                <div class="indicator">
                  grokking
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#reference-label" data-for="reference-label" style="--animation-order:22;" aria-label="References">
                <div class="fill"></div>
                <div class="indicator">
                  References
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#footnote-label" data-for="footnote-label" style="--animation-order:23;" aria-label="Footnotes">
                <div class="fill"></div>
                <div class="indicator">
                  Footnotes
                </div>
              </button>
              <button class="depth-1 toc-item" data-depth="1" data-href="#backlinks-label" data-for="backlinks-label" style="--animation-order:24;" aria-label="Liens retour">
                <div class="fill"></div>
                <div class="indicator">
                  Liens retour
                </div>
              </button>
            </nav>
          </div>
          <div class="toolbar">
            <div class="toolbar-content">
              <button class="toolbar-item pen-button" aria-label="Toggle toolbar" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="var(--darkgray)" viewBox="0 0 256 256" class="pen-icon">
                  <path d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="reader-button" aria-label="Toggle reader mode" data-active="false">
                <span class="tooltip">
                  Reader mode
                </span>
                <svg class="reader-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="pdf-button" aria-label="Export to PDF">
                <span class="tooltip">
                  Export PDF
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <line x1="10" y1="9" x2="8" y2="9"></line>
                </svg>
              </button>
              <button class="toolbar-item " id="graph-button" aria-label="Toggle global graph">
                <span class="tooltip">
                  Global graph
                </span>
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve">
                  <path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path>
                </svg>
              </button>
              <button class="toolbar-item " id="skew-button" aria-label="add a tiny bit of skew, cuz why not">
                <span class="tooltip">
                  Skew page
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 4l18 16"></path>
                  <path d="M21 4H3"></path>
                  <path d="M21 20H3"></path>
                </svg>
              </button>
            </div>
          </div>
        </aside>
        <section class="center">
          <div class="page-header">
            <header>
              <nav class="breadcrumb-container" aria-label="breadcrumbs">
                <div class="breadcrumb-element">
                  <a href="../">
                    ~
                  </a>
                  <p>
                    /
                  </p>
                </div>
                <div class="breadcrumb-element">
                  <a href="../thoughts/">
                    t
                  </a>
                  <p>
                    /
                  </p>
                </div>
                <div class="breadcrumb-element">
                  <a href>
                    mechanistic interpretability
                  </a>
                </div>
              </nav>
              <div class="keybind" lang="fr">
                <kbd id="shortcut-key" data-mapping="[&quot;cmd--'&quot;,&quot;ctrl--'&quot;]">
                  ⌘ '
                </kbd>
                <div id="shortcut-container">
                  <div id="shortcut-space">
                    <div id="title">
                      raccourcis clavier
                    </div>
                    <ul id="shortcut-list">
                      <li>
                        <div id="shortcuts" data-key="⌘--/" data-value="recherche"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--\" data-value="page d'accueil"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--j" data-value="curius"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--b" data-value="lecteur"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--g" data-value="graphique"></div>
                      </li>
                      <li>
                        <div id="shortcuts" data-key="⌘--u" data-value="fausser"></div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="search">
                <button class="search-button" id="search-button">
                  <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7">
                    <title>
                      Search
                    </title>
                    <g class="search-path" fill="none">
                      <path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path>
                      <circle cx="8" cy="8" r="7"></circle>
                    </g>
                  </svg>
                </button>
                <div id="search-container">
                  <div id="search-space">
                    <input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Rechercher quelque chose" placeholder="Rechercher quelque chose"/>
                    <div id="search-layout" data-preview="true"></div>
                  </div>
                </div>
              </div>
            </header>
            <div class="popover-hint">
              <hgroup>
                <h1 class="article-title">
                  mechanistic interpretability
                </h1>
                <p class="description">
                  and reverse engineering neural networks.
                </p>
              </hgroup>
              <ul class="content-meta">
                <li>
                  <span class="page-creation" title="Date de création du contenu de la page">
                    <em>
                      29 oct. 2024
                    </em>
                  </span>
                </li>
                <li>
                  <a href="../thoughts/mechanistic-interpretability.html.md" target="_blank" rel="noopener noreferrer" class="llm-source" style="color: inherit;font-weight: inherit;text-decoration: underline">
                    <span title="voir https://github.com/AnswerDotAI/llms-txt">
                      llms.txt
                    </span>
                  </a>
                </li>
              </ul>
              <ul class="tags">
                <li>
                  <a href="../tags/interp" class="internal tag-link">
                    interp
                  </a>
                </li>
              </ul>
              <div class="spacer"></div>
            </div>
          </div>
          <article class="popover-hint">
            <p dir="auto">
              <a href="https://www.youtube.com/watch?v=veT2VI4vHyU&amp;ab_channel=FAR%E2%80%A4AI" class="external alias">
                <span class="indicator-hook"></span>
                whirlwind tour
              </a>
              ,
              <a href="../thoughts/pdfs/tinymorph-exploration.pdf" class="internal alias" data-slug="thoughts/pdfs/tinymorph-exploration.pdf">
                <span class="indicator-hook"></span>
                initial exploration
              </a>
              ,
              <a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J" class="external alias">
                <span class="indicator-hook"></span>
                glossary
              </a>
            </p>
            <blockquote>
              <p dir="auto">
                The subfield of alignment that delves into reverse engineering of a neural network, especially
                <a href="../thoughts/LLMs" class="internal" data-slug="thoughts/LLMs">
                  <span class="indicator-hook"></span>
                  LLMs
                </a>
              </p>
            </blockquote>
            <p dir="auto">
              To attack the
              <em>
                curse of dimensionality
              </em>
              , the question remains:
              <em>
                <mark>
                  how do we hope to understand a function over such a large space, without an exponential amount of time?
                </mark>
              </em>
              <sup>
                <a href="#user-content-fn-lesswrongarc" id="user-content-fnref-lesswrongarc" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                  <span class="indicator-hook"></span>
                  1
                </a>
              </sup>
            </p>
            <section class="collapsible-header" id="inference" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-inference-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="inference" dir="auto">
                  inference
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#inference" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-inference-toggle" data-level="2" data-heading-id="inference">
                  <p dir="auto">
                    application in the wild:
                    <a href="https://goodfire.ai/" class="external alias">
                      <span class="indicator-hook"></span>
                      Goodfire
                    </a>
                    and
                    <a href="https://transluce.org/" class="external alias">
                      <span class="indicator-hook"></span>
                      Transluce
                    </a>
                  </p>
                  <blockquote class="callout question is-collapsible" data-callout="question" data-callout-fold>
                    <div class="callout-title" dir="auto">
                      <div class="callout-icon" dir="auto"></div>
                      <div class="callout-title-inner" dir="auto">
                        <p dir="auto">
                          How we would do inference with SAE?
                        </p>
                      </div>
                      <div class="fold-callout-icon" dir="auto"></div>
                    </div>
                    <div class="callout-content" dir="auto">
                      <blockquote class="twitter-tweet" data-lang="fr">
                        <p lang="en" dir="auto">
                          Quick 🧵 and some of quick introspection into how they might run inference
                          <a href="https://t.co/1N3JrxFHSp" class="external">
                            <span class="indicator-hook"></span>
                            https://t.co/1N3JrxFHSp
                          </a>
                        </p>
                        — aaron (@aarnphm_)
                        <a href="https://twitter.com/aarnphm_/status/1839016131321016380?ref_src=twsrc%5Etfw" class="alias">
                          <span class="indicator-hook"></span>
                          25 septembre 2024
                        </a>
                      </blockquote>
                    </div>
                  </blockquote>
                  <p dir="auto">
                    idea: treat SAEs as a
                    <code>
                      logit_processor
                    </code>
                    , similar to
                    <a href="../thoughts/vllm#guided-decoding" class="internal alias" data-slug="thoughts/vllm">
                      <span class="indicator-hook"></span>
                      guided decoding
                    </a>
                  </p>
                  <p dir="auto">
                    Current known bottleneck in vLLM:
                  </p>
                  <ul dir="auto">
                    <li>
                      <code>
                        logit_processor
                      </code>
                      are row-wise, or logits are processed synchronously and blocking
                      <sup>
                        <a href="#user-content-fn-vllm-caveats" id="user-content-fnref-vllm-caveats" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                          <span class="indicator-hook"></span>
                          2
                        </a>
                      </sup>
                    </li>
                    <li>
                      no SPMD currently implemented
                    </li>
                  </ul>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="steering" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-steering-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="steering" dir="auto">
                  steering
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#steering" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-steering-toggle" data-level="2" data-heading-id="steering">
                  <p dir="auto">
                    refers to the process of manually modifying certain activations and hidden state of the neural net to influence its
                    outputs
                  </p>
                  <p dir="auto">
                    For example, the following is a toy example of how a decoder-only transformers (i.e: GPT-2) generate text given the prompt “The weather in California is”
                  </p>
                  <pre><button class="expand-button" aria-label="Expand mermaid diagram" aria-hidden="true" data-view-component="true" tabindex="-1"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M3.72 3.72a.75.75 0 011.06 1.06L2.56 7h10.88l-2.22-2.22a.75.75 0 011.06-1.06l3.5 3.5a.75.75 0 010 1.06l-3.5 3.5a.75.75 0 11-1.06-1.06l2.22-2.22H2.56l2.22 2.22a.75.75 0 11-1.06 1.06l-3.5-3.5a.75.75 0 010-1.06l3.5-3.5z"></path></svg></button><code class="mermaid" data-clipboard="flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H2] --> C[... hot]">flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H2] --> C[... hot]
</code></pre>
                  <p dir="auto">
                    To steer to model, we modify
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  H
                                </mi>
                                <mn>
                                  2
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              H_2
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.08125em;">
                              H
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          2
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    layers with certain features amplifier with scale 20 (called it
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  H
                                </mi>
                                <mn>
                                  3
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              H_{3}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.08125em;">
                              H
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            3
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    )
                    <sup>
                      <a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                        <span class="indicator-hook"></span>
                        3
                      </a>
                    </sup>
                  </p>
                  <pre><button class="expand-button" aria-label="Expand mermaid diagram" aria-hidden="true" data-view-component="true" tabindex="-1"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M3.72 3.72a.75.75 0 011.06 1.06L2.56 7h10.88l-2.22-2.22a.75.75 0 011.06-1.06l3.5 3.5a.75.75 0 010 1.06l-3.5 3.5a.75.75 0 11-1.06-1.06l2.22-2.22H2.56l2.22 2.22a.75.75 0 11-1.06 1.06l-3.5-3.5a.75.75 0 010-1.06l3.5-3.5z"></path></svg></button><code class="mermaid" data-clipboard="flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H3] --> C[... cold]">flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H3] --> C[... cold]
</code></pre>
                  <p dir="auto">
                    One usually use techniques such as
                    <a href="../thoughts/mechanistic-interpretability#sparse-autoencoders" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                      <span class="indicator-hook"></span>
                      sparse autoencoders
                    </a>
                    to decompose model activations into a set of
                    interpretable features.
                  </p>
                  <p dir="auto">
                    For feature
                    <a href="../thoughts/mechanistic-interpretability#ablation" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                      <span class="indicator-hook"></span>
                      ablation
                    </a>
                    , we observe that manipulation of features activation can be strengthened or weakened
                    to directly influence the model’s outputs
                  </p>
                  <p dir="auto">
                    A few examples where
                    <cite class id="citation--panickssery2024steeringllama2contrastive--1">
                      (
                      <a href="#bib-panickssery2024steeringllama2contrastive" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Panickssery et al., 2024
                      </a>
                      )
                    </cite>
                    uses contrastive activation additions to steer Llama 2
                  </p>
                  <section class="collapsible-header" id="contrastive-activation-additions" data-level="3">
                    <div class="header-controls">
                      <button id="collapsible-header-contrastive-activation-additions-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                        <div class="toggle-icons">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                            <circle cx="12" cy="12" r="3"></circle>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                        </div>
                      </button>
                      <h3 id="contrastive-activation-additions" dir="auto">
                        contrastive activation additions
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                          <circle cx="6" cy="12" r="2"></circle>
                          <circle cx="12" cy="12" r="2"></circle>
                          <circle cx="18" cy="12" r="2"></circle>
                        </svg>
                        <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#contrastive-activation-additions" class="internal">
                          <span class="indicator-hook"></span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                          </svg>
                        </a>
                      </h3>
                    </div>
                    <div class="collapsible-header-content-outer">
                      <div class="collapsible-header-content" data-references="collapsible-header-contrastive-activation-additions-toggle" data-level="3" data-heading-id="contrastive-activation-additions">
                        <p dir="auto">
                          intuition: using a contrast pair for steering vector additions at certain activations layers
                        </p>
                        <p dir="auto">
                          Uses
                          <em>
                            mean difference
                          </em>
                          which produce difference vector similar to PCA:
                        </p>
                        <p dir="auto">
                          Given a dataset
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi mathvariant="script">
                                      D
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    \mathcal{D}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.6833em;"></span>
                                <span class="mord mathcal" style="margin-right:0.02778em;">
                                  D
                                </span>
                              </span>
                            </span>
                          </span>
                          of prompt
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      p
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    p
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span>
                                <span class="mord mathnormal">
                                  p
                                </span>
                              </span>
                            </span>
                          </span>
                          with positive completion
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        c
                                      </mi>
                                      <mi>
                                        p
                                      </mi>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    c_p
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    c
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.1514em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                p
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          and negative completion
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        c
                                      </mi>
                                      <mi>
                                        n
                                      </mi>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    c_n
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    c
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.1514em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                n
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          , we calculate mean-difference
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        v
                                      </mi>
                                      <mtext>
                                        MD
                                      </mtext>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    v_\text{MD}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.03588em;">
                                    v
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3283em;">
                                          <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  MD
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          at layer
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    L
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.6833em;"></span>
                                <span class="mord mathnormal">
                                  L
                                </span>
                              </span>
                            </span>
                          </span>
                          as follow:
                        </p>
                        <span class="katex-display">
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        v
                                      </mi>
                                      <mtext>
                                        MD
                                      </mtext>
                                    </msub>
                                    <mo>
                                      =
                                    </mo>
                                    <mfrac>
                                      <mn>
                                        1
                                      </mn>
                                      <mrow>
                                        <mo>
                                          ∣
                                        </mo>
                                        <mi mathvariant="script">
                                          D
                                        </mi>
                                        <mo>
                                          ∣
                                        </mo>
                                      </mrow>
                                    </mfrac>
                                    <munder>
                                      <mo>
                                        ∑
                                      </mo>
                                      <mrow>
                                        <mi>
                                          p
                                        </mi>
                                        <mo separator="true">
                                          ,
                                        </mo>
                                        <msub>
                                          <mi>
                                            c
                                          </mi>
                                          <mi>
                                            p
                                          </mi>
                                        </msub>
                                        <mo separator="true">
                                          ,
                                        </mo>
                                        <msub>
                                          <mi>
                                            c
                                          </mi>
                                          <mi>
                                            n
                                          </mi>
                                        </msub>
                                        <mo>
                                          ∈
                                        </mo>
                                        <mi mathvariant="script">
                                          D
                                        </mi>
                                      </mrow>
                                    </munder>
                                    <msub>
                                      <mi>
                                        a
                                      </mi>
                                      <mi>
                                        L
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      p
                                    </mi>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <msub>
                                      <mi>
                                        c
                                      </mi>
                                      <mi>
                                        p
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo>
                                      −
                                    </mo>
                                    <msub>
                                      <mi>
                                        a
                                      </mi>
                                      <mi>
                                        L
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      p
                                    </mi>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <msub>
                                      <mi>
                                        c
                                      </mi>
                                      <mi>
                                        n
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    v_\text{MD} = \frac{1}{\mid \mathcal{D} \mid} \sum_{p,c_p,c_n \in \mathcal{D}} a_L(p,c_p) - a_L(p, c_n)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.03588em;">
                                    v
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3283em;">
                                          <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  MD
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  =
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:2.8131em;vertical-align:-1.4917em;"></span>
                                <span class="mord">
                                  <span class="mopen nulldelimiter"></span>
                                  <span class="mfrac">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:1.3214em;">
                                          <span style="top:-2.314em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="mord">
                                              <span class="mrel">
                                                ∣
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mord mathcal" style="margin-right:0.02778em;">
                                                D
                                              </span>
                                              <span class="mspace" style="margin-right:0.2778em;"></span>
                                              <span class="mrel">
                                                ∣
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-3.23em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="frac-line" style="border-bottom-width:0.04em;"></span>
                                          </span>
                                          <span style="top:-3.677em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="mord">
                                              <span class="mord">
                                                1
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.936em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="mclose nulldelimiter"></span>
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mop op-limits">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.05em;">
                                        <span style="top:-1.8557em;margin-left:0em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mtight">
                                              <span class="mord mathnormal mtight">
                                                p
                                              </span>
                                              <span class="mpunct mtight">
                                                ,
                                              </span>
                                              <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                  c
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.1645em;">
                                                        <span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;">
                                                          <span class="pstrut" style="height:2.5em;"></span>
                                                          <span class="sizing reset-size3 size1 mtight">
                                                            <span class="mord mathnormal mtight">
                                                              p
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2819em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mpunct mtight">
                                                ,
                                              </span>
                                              <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                  c
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.1645em;">
                                                        <span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;">
                                                          <span class="pstrut" style="height:2.5em;"></span>
                                                          <span class="sizing reset-size3 size1 mtight">
                                                            <span class="mord mathnormal mtight">
                                                              n
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.143em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mrel mtight">
                                                ∈
                                              </span>
                                              <span class="mord mathcal mtight" style="margin-right:0.02778em;">
                                                D
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.05em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span>
                                            <span class="mop op-symbol large-op">
                                              ∑
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.4917em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    a
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3283em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                L
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  p
                                </span>
                                <span class="mpunct">
                                  ,
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    c
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.1514em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                p
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                <span class="mbin">
                                  −
                                </span>
                                <span class="mspace" style="margin-right:0.2222em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    a
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3283em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                L
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  p
                                </span>
                                <span class="mpunct">
                                  ,
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    c
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.1514em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                n
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <blockquote class="callout tip" data-callout="tip">
                          <div class="callout-title" dir="auto">
                            <div class="callout-icon" dir="auto"></div>
                            <div class="callout-title-inner" dir="auto">
                              <p dir="auto">
                                implication
                              </p>
                            </div>
                          </div>
                          <div class="callout-content" dir="auto">
                            <p dir="auto">
                              by steering existing learned representations of behaviors, CAA results in better out-of-distribution generalization than basic supervised finetuning of the entire model.
                            </p>
                          </div>
                        </blockquote>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="sparse-autoencoders" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-sparse-autoencoders-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="sparse-autoencoders" dir="auto">
                  sparse autoencoders
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sparse-autoencoders" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-sparse-autoencoders-toggle" data-level="2" data-heading-id="sparse-autoencoders">
                  <p dir="auto"></p>
                  <blockquote class="transclude" data-url="thoughts/sparse-autoencoder" data-block data-embed-alias="undefined">
                    <p dir="auto">
                      abbrev: SAE
                    </p>
                    <p dir="auto">
                      <em>
                        see also:
                        <a href="https://docs.google.com/document/d/1lHvRXJsbi41bNGZ_znGN7DmlLXITXyWyISan7Qx2y6s/edit?tab=t.0#heading=h.j9b3g3x1o1z4" class="external alias">
                          <span class="indicator-hook"></span>
                          landspace
                        </a>
                      </em>
                    </p>
                    <p dir="auto">
                      Often contains one layers of MLP with few linear ReLU that is trained on a subset of datasets the main LLMs is trained on.
                    </p>
                    <blockquote>
                      <p dir="auto">
                        empirical example: if we wish to interpret all features related to the author Camus, we might want to train an SAEs based on all given text of Camus
                        to interpret “similar” features from Llama-3.1
                      </p>
                    </blockquote>
                    <blockquote class="callout abstract" data-callout="abstract">
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            definition
                          </p>
                        </div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          We wish to decompose a models’ activitation
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <msup>
                                      <mi mathvariant="double-struck">
                                        R
                                      </mi>
                                      <mi>
                                        n
                                      </mi>
                                    </msup>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    x \in \mathbb{R}^n
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  ∈
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6889em;"></span>
                                <span class="mord">
                                  <span class="mord mathbb">
                                    R
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.6644em;">
                                          <span style="top:-3.063em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                n
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          into sparse, linear combination of feature directions:
                        </p>
                        <span class="katex-display">
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                <semantics>
                                  <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mi>
                                              x
                                            </mi>
                                            <mo>
                                              ∼
                                            </mo>
                                            <msub>
                                              <mi>
                                                x
                                              </mi>
                                              <mn>
                                                0
                                              </mn>
                                            </msub>
                                            <mo>
                                              +
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <munderover>
                                              <mo>
                                                ∑
                                              </mo>
                                              <mrow>
                                                <mi>
                                                  i
                                                </mi>
                                                <mo>
                                                  =
                                                </mo>
                                                <mn>
                                                  1
                                                </mn>
                                              </mrow>
                                              <mi>
                                                M
                                              </mi>
                                            </munderover>
                                            <msub>
                                              <mi>
                                                f
                                              </mi>
                                              <mi>
                                                i
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <msub>
                                              <mi>
                                                d
                                              </mi>
                                              <mi>
                                                i
                                              </mi>
                                            </msub>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mo>
                                              ∵
                                            </mo>
                                            <mspace width="1em"></mspace>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <msub>
                                              <mi>
                                                d
                                              </mi>
                                              <mi>
                                                i
                                              </mi>
                                            </msub>
                                            <mi>
                                              M
                                            </mi>
                                            <mo>
                                              ≫
                                            </mo>
                                            <mi>
                                              n
                                            </mi>
                                            <mo>
                                              :
                                            </mo>
                                            <mtext>
                                               latent unit-norm feature direction
                                            </mtext>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow></mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <msub>
                                              <mi>
                                                f
                                              </mi>
                                              <mi>
                                                i
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              ≥
                                            </mo>
                                            <mn>
                                              0
                                            </mn>
                                            <mo>
                                              :
                                            </mo>
                                            <mtext>
                                               corresponding feature activation for
                                            </mtext>
                                            <mi>
                                              x
                                            </mi>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                  </mtable>
                                  <annotation encoding="application/x-tex">
                                    \begin{aligned}
                                    x \sim x_{0} + &amp;\sum_{i=1}^{M} f_i(x) d_i \\[8pt]
                                    \because \quad &amp;d_i M \gg n:\text{ latent unit-norm feature direction} \\
                                    &amp;f_i(x) \ge 0: \text{ corresponding feature activation for }x
                                    \end{aligned}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:6.406em;vertical-align:-2.953em;"></span>
                                <span class="mord">
                                  <span class="mtable">
                                    <span class="col-align-r">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.453em;">
                                            <span style="top:-5.453em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  ∼
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3011em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                <span class="mord mtight">
                                                                  0
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord">
                                                  +
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.0353em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord">
                                                <span class="mrel amsrm">
                                                  ∵
                                                </span>
                                                <span class="mspace" style="margin-right:1em;"></span>
                                              </span>
                                            </span>
                                            <span style="top:-1.5353em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord"></span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.953em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="col-align-l">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.453em;">
                                            <span style="top:-5.453em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mop op-limits">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:1.8283em;">
                                                        <span style="top:-1.8723em;margin-left:0em;">
                                                          <span class="pstrut" style="height:3.05em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord mathnormal mtight">
                                                                i
                                                              </span>
                                                              <span class="mrel mtight">
                                                                =
                                                              </span>
                                                              <span class="mord mtight">
                                                                1
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span style="top:-3.05em;">
                                                          <span class="pstrut" style="height:3.05em;"></span>
                                                          <span>
                                                            <span class="mop op-symbol large-op">
                                                              ∑
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span style="top:-4.3em;margin-left:0em;">
                                                          <span class="pstrut" style="height:3.05em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.10903em;">
                                                                M
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:1.2777em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                    f
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                i
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    d
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                i
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.0353em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    d
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                i
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord mathnormal" style="margin-right:0.10903em;">
                                                  M
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  ≫
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord mathnormal">
                                                  n
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  :
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                     latent unit-norm feature direction
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-1.5353em;">
                                              <span class="pstrut" style="height:3.8283em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                    f
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                i
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  ≥
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  0
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  :
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                     corresponding feature activation for
                                                  </span>
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.953em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </div>
                    </blockquote>
                    <p dir="auto">
                      Thus, the baseline architecture of SAEs is a linear autoencoder with L1 penalty on the activations:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          <mi mathvariant="normal">
                                            ≔
                                          </mi>
                                        </mo>
                                        <mtext>
                                          ReLU
                                        </mtext>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo>
                                          −
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mtext>
                                            dec
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mover accent="true">
                                          <mi>
                                            x
                                          </mi>
                                          <mo>
                                            ^
                                          </mo>
                                        </mover>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          <mi mathvariant="normal">
                                            ≔
                                          </mi>
                                        </mo>
                                        <msub>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            dec
                                          </mtext>
                                        </msub>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mtext>
                                            dec
                                          </mtext>
                                        </msub>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                f(x) &amp;\coloneqq \text{ReLU}(W_\text{enc}(x - b_\text{dec}) + b_\text{enc}) \\
                                \hat{x}(f) &amp;\coloneqq W_\text{dec} f(x) + b_\text{dec}
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:3em;vertical-align:-1.25em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.75em;">
                                        <span style="top:-3.91em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-2.41em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord accent">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.6944em;">
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="mord mathnormal">
                                                        x
                                                      </span>
                                                    </span>
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="accent-body" style="left:-0.2222em;">
                                                        <span class="mord">
                                                          ^
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.25em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.75em;">
                                        <span style="top:-3.91em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              <span class="mrel">
                                                <span class="mop" style="position:relative;top:-0.0347em;">
                                                  :
                                                </span>
                                              </span>
                                              <span class="mrel">
                                                <span class="mspace" style="margin-right:-0.0667em;"></span>
                                              </span>
                                              <span class="mrel">
                                                =
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                ReLU
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              enc
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3361em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              dec
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              enc
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-2.41em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              <span class="mrel">
                                                <span class="mop" style="position:relative;top:-0.0347em;">
                                                  :
                                                </span>
                                              </span>
                                              <span class="mrel">
                                                <span class="mspace" style="margin-right:-0.0667em;"></span>
                                              </span>
                                              <span class="mrel">
                                                =
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3361em;">
                                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              dec
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3361em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              dec
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.25em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <blockquote>
                      <p dir="auto">
                        training it to reconstruct a large dataset of model activations
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    x
                                  </mi>
                                  <mo>
                                    ∼
                                  </mo>
                                  <mi mathvariant="script">
                                    D
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  x \sim \mathcal{D}
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.4306em;"></span>
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mrel">
                                ∼
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.6833em;"></span>
                              <span class="mord mathcal" style="margin-right:0.02778em;">
                                D
                              </span>
                            </span>
                          </span>
                        </span>
                        , constraining hidden representation
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    f
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  f
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span>
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                            </span>
                          </span>
                        </span>
                        to be sparse
                      </p>
                    </blockquote>
                    <p dir="auto">
                      <a href="../thoughts/sparse-autoencoder/../../thoughts/university/twenty-four-twenty-five/sfwr-4ml3/tut/tut1#l1norm" class="internal alias" data-slug="thoughts/university/twenty-four-twenty-five/sfwr-4ml3/tut/tut1">
                        <span class="indicator-hook"></span>
                        L1 norm
                      </a>
                      with coefficient
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  λ
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \lambda
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6944em;"></span>
                            <span class="mord mathnormal">
                              λ
                            </span>
                          </span>
                        </span>
                      </span>
                      to construct loss during training:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi mathvariant="script">
                                          L
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          <mi mathvariant="normal">
                                            ≔
                                          </mi>
                                        </mo>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mi>
                                          x
                                        </mi>
                                        <mo>
                                          −
                                        </mo>
                                        <mover accent="true">
                                          <mi>
                                            x
                                          </mi>
                                          <mo>
                                            ^
                                          </mo>
                                        </mover>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <msubsup>
                                          <mi mathvariant="normal">
                                            ∥
                                          </mi>
                                          <mn>
                                            2
                                          </mn>
                                          <mn>
                                            2
                                          </mn>
                                        </msubsup>
                                        <mo>
                                          +
                                        </mo>
                                        <mi>
                                          λ
                                        </mi>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <msub>
                                          <mi mathvariant="normal">
                                            ∥
                                          </mi>
                                          <mn>
                                            1
                                          </mn>
                                        </msub>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mi>
                                          x
                                        </mi>
                                        <mo>
                                          −
                                        </mo>
                                        <mover accent="true">
                                          <mi>
                                            x
                                          </mi>
                                          <mo>
                                            ^
                                          </mo>
                                        </mover>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <msubsup>
                                          <mi mathvariant="normal">
                                            ∥
                                          </mi>
                                          <mn>
                                            2
                                          </mn>
                                          <mn>
                                            2
                                          </mn>
                                        </msubsup>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           reconstruction loss
                                        </mtext>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                \mathcal{L}(x) &amp;\coloneqq \| x-\hat{x}(f(x)) \|_2^2 + \lambda \| f(x) \|_1 \\[8pt]
                                &amp;\because \|x-\hat{x}(f(x)) \|_2^2 : \text{ reconstruction loss}
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:3.8482em;vertical-align:-1.6741em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.1741em;">
                                        <span style="top:-4.31em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathcal">
                                              L
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.9859em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.6741em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.1741em;">
                                        <span style="top:-4.31em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              <span class="mrel">
                                                <span class="mop" style="position:relative;top:-0.0347em;">
                                                  :
                                                </span>
                                              </span>
                                              <span class="mrel">
                                                <span class="mspace" style="margin-right:-0.0667em;"></span>
                                              </span>
                                              <span class="mrel">
                                                =
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord accent">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.6944em;">
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="mord mathnormal">
                                                        x
                                                      </span>
                                                    </span>
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="accent-body" style="left:-0.2222em;">
                                                        <span class="mord">
                                                          ^
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              ))
                                            </span>
                                            <span class="mord">
                                              <span class="mord">
                                                ∥
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8641em;">
                                                      <span style="top:-2.453em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              λ
                                            </span>
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mord">
                                              <span class="mord">
                                                ∥
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3011em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            1
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.9859em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord accent">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.6944em;">
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="mord mathnormal">
                                                        x
                                                      </span>
                                                    </span>
                                                    <span style="top:-3em;">
                                                      <span class="pstrut" style="height:3em;"></span>
                                                      <span class="accent-body" style="left:-0.2222em;">
                                                        <span class="mord">
                                                          ^
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              ))
                                            </span>
                                            <span class="mord">
                                              <span class="mord">
                                                ∥
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8641em;">
                                                      <span style="top:-2.453em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 reconstruction loss
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.6741em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <blockquote class="callout tip" data-callout="tip">
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            intuition
                          </p>
                        </div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          We need to reconstruction fidelity at a given sparsity level, as measured by
                          L0 via a mixture of reconstruction fidelity and L1 regularization.
                        </p>
                      </div>
                    </blockquote>
                    <p dir="auto">
                      We can reduce sparsity loss term without affecting reconstruction by scaling up norm of
                      decoder weights, or constraining norms of columns
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    dec
                                  </mtext>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                W_\text{dec}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3361em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      during training
                    </p>
                    <p dir="auto">
                      Ideas: output of decoder
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  f
                                </mi>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                f(x)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      has two roles
                    </p>
                    <ul dir="auto">
                      <li>
                        detects what features acre active
                        <span>
                          ⇐
                        </span>
                        L1 is crucial to ensure sparsity in decomposition
                      </li>
                      <li>
                        <em>
                          estimates
                        </em>
                        magnitudes of active features
                        <span>
                          ⇐
                        </span>
                        L1 is unwanted bias
                      </li>
                    </ul>
                    <h3 id="gated-sae" dir="auto">
                      Gated SAE
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#gated-sae" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h3>
                    <p dir="auto">
                      <em>
                        uses Pareto improvement over training to reduce L1 penalty
                      </em>
                      <cite class id="citation--rajamanoharan2024improvingdictionarylearninggated--1">
                        (
                        <a href="#bib-rajamanoharan2024improvingdictionarylearninggated" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Rajamanoharan et al., 2024
                        </a>
                        )
                      </cite>
                    </p>
                    <p dir="auto">
                      Clear consequence of the bias during training is
                      <em>
                        shrinkage
                      </em>
                      <cite class id="citation--sharkey2024feature--2">
                        (
                        <a href="#bib-sharkey2024feature" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Sharkey, 2024
                        </a>
                        )
                      </cite>
                      <sup>
                        <a href="#user-content-fn-shrinkage" id="user-content-fnref-shrinkage" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                          <span class="indicator-hook"></span>
                          4
                        </a>
                      </sup>
                    </p>
                    <p dir="auto">
                      Idea is to use
                      <a href="../thoughts/sparse-autoencoder/../../thoughts/optimization#gated-linear-units-and-variants" class="internal alias" data-slug="thoughts/optimization">
                        <span class="indicator-hook"></span>
                        gated ReLU
                      </a>
                      encoder
                      <cite class id="citation--shazeer2020gluvariantsimprovetransformer--dauphin2017languagemodelinggatedconvolutional--3">
                        (
                        <a href="#bib-dauphin2017languagemodelinggatedconvolutional" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Dauphin et al., 2017
                        </a>
                        ;
                        <a href="#bib-shazeer2020gluvariantsimprovetransformer" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Shazeer, 2020
                        </a>
                        )
                      </cite>
                      :
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mrow>
                                <mover accent="true">
                                  <mi>
                                    f
                                  </mi>
                                  <mo>
                                    ~
                                  </mo>
                                </mover>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi mathvariant="bold">
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mo>
                                  <mi mathvariant="normal">
                                    ≔
                                  </mi>
                                </mo>
                                <munder>
                                  <munder>
                                    <mrow>
                                      <mn mathvariant="double-struck">
                                        1
                                      </mn>
                                      <mo stretchy="false">
                                        [
                                      </mo>
                                      <munder>
                                        <munder>
                                          <mrow>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <msub>
                                              <mi mathvariant="bold">
                                                W
                                              </mi>
                                              <mtext>
                                                gate
                                              </mtext>
                                            </msub>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi mathvariant="bold">
                                              x
                                            </mi>
                                            <mo>
                                              −
                                            </mo>
                                            <msub>
                                              <mi mathvariant="bold">
                                                b
                                              </mi>
                                              <mtext>
                                                dec
                                              </mtext>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              +
                                            </mo>
                                            <msub>
                                              <mi mathvariant="bold">
                                                b
                                              </mi>
                                              <mtext>
                                                gate
                                              </mtext>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              >
                                            </mo>
                                            <mn>
                                              0
                                            </mn>
                                          </mrow>
                                          <mo stretchy="true">
                                            ⏟
                                          </mo>
                                        </munder>
                                        <mrow>
                                          <msub>
                                            <mi>
                                              π
                                            </mi>
                                            <mtext>
                                              gate
                                            </mtext>
                                          </msub>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mi mathvariant="bold">
                                            x
                                          </mi>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                        </mrow>
                                      </munder>
                                      <mo stretchy="false">
                                        ]
                                      </mo>
                                    </mrow>
                                    <mo stretchy="true">
                                      ⏟
                                    </mo>
                                  </munder>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mtext>
                                        gate
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi mathvariant="bold">
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </munder>
                                <mo>
                                  ⊙
                                </mo>
                                <munder>
                                  <munder>
                                    <mrow>
                                      <mtext>
                                        ReLU
                                      </mtext>
                                      <mo stretchy="false">
                                        (
                                      </mo>
                                      <msub>
                                        <mi mathvariant="bold">
                                          W
                                        </mi>
                                        <mtext>
                                          mag
                                        </mtext>
                                      </msub>
                                      <mo stretchy="false">
                                        (
                                      </mo>
                                      <mi mathvariant="bold">
                                        x
                                      </mi>
                                      <mo>
                                        −
                                      </mo>
                                      <msub>
                                        <mi mathvariant="bold">
                                          b
                                        </mi>
                                        <mtext>
                                          dec
                                        </mtext>
                                      </msub>
                                      <mo stretchy="false">
                                        )
                                      </mo>
                                      <mo>
                                        +
                                      </mo>
                                      <msub>
                                        <mi mathvariant="bold">
                                          b
                                        </mi>
                                        <mtext>
                                          mag
                                        </mtext>
                                      </msub>
                                      <mo stretchy="false">
                                        )
                                      </mo>
                                    </mrow>
                                    <mo stretchy="true">
                                      ⏟
                                    </mo>
                                  </munder>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mtext>
                                        mag
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi mathvariant="bold">
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </munder>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \tilde{f}(\mathbf{x}) \coloneqq \underbrace{\mathbb{1}[\underbrace{(\mathbf{W}_{\text{gate}}(\mathbf{x} - \mathbf{b}_{\text{dec}}) + \mathbf{b}_{\text{gate}}) > 0}_{\pi_{\text{gate}}(\mathbf{x})}]}_{f_{\text{gate}}(\mathbf{x})} \odot \underbrace{\text{ReLU}(\mathbf{W}_{\text{mag}}(\mathbf{x} - \mathbf{b}_{\text{dec}}) + \mathbf{b}_{\text{mag}})}_{f_{\text{mag}}(\mathbf{x})}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.1813em;vertical-align:-0.25em;"></span>
                            <span class="mord accent">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.9313em;">
                                    <span style="top:-3em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord mathnormal" style="margin-right:0.10764em;">
                                        f
                                      </span>
                                    </span>
                                    <span style="top:-3.6134em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="accent-body" style="left:-0.0833em;">
                                        <span class="mord">
                                          ~
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.1944em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathbf">
                              x
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              <span class="mrel">
                                <span class="mop" style="position:relative;top:-0.0347em;">
                                  :
                                </span>
                              </span>
                              <span class="mrel">
                                <span class="mspace" style="margin-right:-0.0667em;"></span>
                              </span>
                              <span class="mrel">
                                =
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:4.1767em;vertical-align:-3.4267em;"></span>
                            <span class="mord munder">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.75em;">
                                    <span style="top:0.2294em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.2963em;">
                                                    <span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;">
                                                      <span class="pstrut" style="height:2.5em;"></span>
                                                      <span class="sizing reset-size3 size1 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              gate
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.2819em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mopen mtight">
                                            (
                                          </span>
                                          <span class="mord mathbf mtight">
                                            x
                                          </span>
                                          <span class="mclose mtight">
                                            )
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord munder">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.75em;">
                                              <span class="svg-align" style="top:-0.4956em;">
                                                <span class="pstrut" style="height:3em;"></span>
                                                <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                                  <span class="brace-left" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                      <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                    </svg>
                                                  </span>
                                                  <span class="brace-center" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                      <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                    </svg>
                                                  </span>
                                                  <span class="brace-right" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                      <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                    </svg>
                                                  </span>
                                                </span>
                                              </span>
                                              <span style="top:-3em;">
                                                <span class="pstrut" style="height:3em;"></span>
                                                <span class="mord">
                                                  <span class="mord">
                                                    1
                                                  </span>
                                                  <span class="mopen">
                                                    [
                                                  </span>
                                                  <span class="mord munder">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.75em;">
                                                          <span style="top:-1.3409em;">
                                                            <span class="pstrut" style="height:3em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                <span class="mord mtight">
                                                                  <span class="mord mathnormal mtight" style="margin-right:0.03588em;">
                                                                    π
                                                                  </span>
                                                                  <span class="msupsub">
                                                                    <span class="vlist-t vlist-t2">
                                                                      <span class="vlist-r">
                                                                        <span class="vlist" style="height:0.2963em;">
                                                                          <span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;">
                                                                            <span class="pstrut" style="height:2.5em;"></span>
                                                                            <span class="sizing reset-size3 size1 mtight">
                                                                              <span class="mord mtight">
                                                                                <span class="mord text mtight">
                                                                                  <span class="mord mtight">
                                                                                    gate
                                                                                  </span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                        <span class="vlist-s">
                                                                          ​
                                                                        </span>
                                                                      </span>
                                                                      <span class="vlist-r">
                                                                        <span class="vlist" style="height:0.2819em;">
                                                                          <span></span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                                <span class="mopen mtight">
                                                                  (
                                                                </span>
                                                                <span class="mord mathbf mtight">
                                                                  x
                                                                </span>
                                                                <span class="mclose mtight">
                                                                  )
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span style="top:-3em;">
                                                            <span class="pstrut" style="height:3em;"></span>
                                                            <span class="mord munder">
                                                              <span class="vlist-t vlist-t2">
                                                                <span class="vlist-r">
                                                                  <span class="vlist" style="height:0.75em;">
                                                                    <span class="svg-align" style="top:-2.0659em;">
                                                                      <span class="pstrut" style="height:3em;"></span>
                                                                      <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                                                        <span class="brace-left" style="height:0.548em;">
                                                                          <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                                            <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                                          </svg>
                                                                        </span>
                                                                        <span class="brace-center" style="height:0.548em;">
                                                                          <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                                            <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                                          </svg>
                                                                        </span>
                                                                        <span class="brace-right" style="height:0.548em;">
                                                                          <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                                            <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                                          </svg>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                    <span style="top:-3em;">
                                                                      <span class="pstrut" style="height:3em;"></span>
                                                                      <span class="mord">
                                                                        <span class="mopen">
                                                                          (
                                                                        </span>
                                                                        <span class="mord">
                                                                          <span class="mord mathbf" style="margin-right:0.01597em;">
                                                                            W
                                                                          </span>
                                                                          <span class="msupsub">
                                                                            <span class="vlist-t vlist-t2">
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.2806em;">
                                                                                  <span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;">
                                                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                                                    <span class="sizing reset-size6 size3 mtight">
                                                                                      <span class="mord mtight">
                                                                                        <span class="mord text mtight">
                                                                                          <span class="mord mtight">
                                                                                            gate
                                                                                          </span>
                                                                                        </span>
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                                <span class="vlist-s">
                                                                                  ​
                                                                                </span>
                                                                              </span>
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.2861em;">
                                                                                  <span></span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                        <span class="mopen">
                                                                          (
                                                                        </span>
                                                                        <span class="mord mathbf">
                                                                          x
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                        <span class="mbin">
                                                                          −
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                        <span class="mord">
                                                                          <span class="mord mathbf">
                                                                            b
                                                                          </span>
                                                                          <span class="msupsub">
                                                                            <span class="vlist-t vlist-t2">
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.3361em;">
                                                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                                                    <span class="sizing reset-size6 size3 mtight">
                                                                                      <span class="mord mtight">
                                                                                        <span class="mord text mtight">
                                                                                          <span class="mord mtight">
                                                                                            dec
                                                                                          </span>
                                                                                        </span>
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                                <span class="vlist-s">
                                                                                  ​
                                                                                </span>
                                                                              </span>
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.15em;">
                                                                                  <span></span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                        <span class="mclose">
                                                                          )
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                        <span class="mbin">
                                                                          +
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                        <span class="mord">
                                                                          <span class="mord mathbf">
                                                                            b
                                                                          </span>
                                                                          <span class="msupsub">
                                                                            <span class="vlist-t vlist-t2">
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.2806em;">
                                                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                                                    <span class="sizing reset-size6 size3 mtight">
                                                                                      <span class="mord mtight">
                                                                                        <span class="mord text mtight">
                                                                                          <span class="mord mtight">
                                                                                            gate
                                                                                          </span>
                                                                                        </span>
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                                <span class="vlist-s">
                                                                                  ​
                                                                                </span>
                                                                              </span>
                                                                              <span class="vlist-r">
                                                                                <span class="vlist" style="height:0.2861em;">
                                                                                  <span></span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                        <span class="mclose">
                                                                          )
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                                                        <span class="mrel">
                                                                          >
                                                                        </span>
                                                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                                                        <span class="mord">
                                                                          0
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                  <span class="vlist-s">
                                                                    ​
                                                                  </span>
                                                                </span>
                                                                <span class="vlist-r">
                                                                  <span class="vlist" style="height:0.9341em;">
                                                                    <span></span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:1.8564em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="mclose">
                                                    ]
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:2.5044em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:3.4267em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              ⊙
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:2.6064em;vertical-align:-1.8564em;"></span>
                            <span class="mord munder">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.75em;">
                                    <span style="top:-1.3409em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.1645em;">
                                                    <span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;">
                                                      <span class="pstrut" style="height:2.5em;"></span>
                                                      <span class="sizing reset-size3 size1 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord text mtight">
                                                            <span class="mord mtight">
                                                              mag
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.2819em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mopen mtight">
                                            (
                                          </span>
                                          <span class="mord mathbf mtight">
                                            x
                                          </span>
                                          <span class="mclose mtight">
                                            )
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord munder">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.75em;">
                                              <span class="svg-align" style="top:-2.0659em;">
                                                <span class="pstrut" style="height:3em;"></span>
                                                <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                                  <span class="brace-left" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                      <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                    </svg>
                                                  </span>
                                                  <span class="brace-center" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                      <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                    </svg>
                                                  </span>
                                                  <span class="brace-right" style="height:0.548em;">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                      <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                    </svg>
                                                  </span>
                                                </span>
                                              </span>
                                              <span style="top:-3em;">
                                                <span class="pstrut" style="height:3em;"></span>
                                                <span class="mord">
                                                  <span class="mord text">
                                                    <span class="mord">
                                                      ReLU
                                                    </span>
                                                  </span>
                                                  <span class="mopen">
                                                    (
                                                  </span>
                                                  <span class="mord">
                                                    <span class="mord mathbf" style="margin-right:0.01597em;">
                                                      W
                                                    </span>
                                                    <span class="msupsub">
                                                      <span class="vlist-t vlist-t2">
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.1514em;">
                                                            <span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;">
                                                              <span class="pstrut" style="height:2.7em;"></span>
                                                              <span class="sizing reset-size6 size3 mtight">
                                                                <span class="mord mtight">
                                                                  <span class="mord text mtight">
                                                                    <span class="mord mtight">
                                                                      mag
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span class="vlist-s">
                                                            ​
                                                          </span>
                                                        </span>
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.2861em;">
                                                            <span></span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="mopen">
                                                    (
                                                  </span>
                                                  <span class="mord mathbf">
                                                    x
                                                  </span>
                                                  <span class="mspace" style="margin-right:0.2222em;"></span>
                                                  <span class="mbin">
                                                    −
                                                  </span>
                                                  <span class="mspace" style="margin-right:0.2222em;"></span>
                                                  <span class="mord">
                                                    <span class="mord mathbf">
                                                      b
                                                    </span>
                                                    <span class="msupsub">
                                                      <span class="vlist-t vlist-t2">
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.3361em;">
                                                            <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                              <span class="pstrut" style="height:2.7em;"></span>
                                                              <span class="sizing reset-size6 size3 mtight">
                                                                <span class="mord mtight">
                                                                  <span class="mord text mtight">
                                                                    <span class="mord mtight">
                                                                      dec
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span class="vlist-s">
                                                            ​
                                                          </span>
                                                        </span>
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.15em;">
                                                            <span></span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="mclose">
                                                    )
                                                  </span>
                                                  <span class="mspace" style="margin-right:0.2222em;"></span>
                                                  <span class="mbin">
                                                    +
                                                  </span>
                                                  <span class="mspace" style="margin-right:0.2222em;"></span>
                                                  <span class="mord">
                                                    <span class="mord mathbf">
                                                      b
                                                    </span>
                                                    <span class="msupsub">
                                                      <span class="vlist-t vlist-t2">
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.1514em;">
                                                            <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                              <span class="pstrut" style="height:2.7em;"></span>
                                                              <span class="sizing reset-size6 size3 mtight">
                                                                <span class="mord mtight">
                                                                  <span class="mord text mtight">
                                                                    <span class="mord mtight">
                                                                      mag
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span class="vlist-s">
                                                            ​
                                                          </span>
                                                        </span>
                                                        <span class="vlist-r">
                                                          <span class="vlist" style="height:0.2861em;">
                                                            <span></span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="mclose">
                                                    )
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.9341em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.8564em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <p dir="auto">
                      where
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mn mathvariant="double-struck">
                                  1
                                </mn>
                                <mo stretchy="false">
                                  [
                                </mo>
                                <mo>
                                  ∙
                                </mo>
                                <mo>
                                  >
                                </mo>
                                <mn>
                                  0
                                </mn>
                                <mo stretchy="false">
                                  ]
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \mathbb{1}[\bullet > 0]
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord">
                              1
                            </span>
                            <span class="mopen">
                              [
                            </span>
                            <span class="mord">
                              ∙
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              >
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord">
                              0
                            </span>
                            <span class="mclose">
                              ]
                            </span>
                          </span>
                        </span>
                      </span>
                      is the (point-wise) Heaviside step function and
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mo>
                                  ⊙
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \odot
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                            <span class="mord">
                              ⊙
                            </span>
                          </span>
                        </span>
                      </span>
                      denotes element-wise multiplication.
                    </p>
                    <div class="table-container">
                      <table>
                        <thead>
                          <tr>
                            <th>
                              term
                            </th>
                            <th>
                              annotations
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mtext>
                                            gate
                                          </mtext>
                                        </msub>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        f_\text{gate}
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right:0.10764em;">
                                        f
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2806em;">
                                              <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                <span class="pstrut" style="height:2.7em;"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord text mtight">
                                                    <span class="mord mtight">
                                                      gate
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2861em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </td>
                            <td>
                              which features are deemed to be active
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mtext>
                                            mag
                                          </mtext>
                                        </msub>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        f_\text{mag}
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right:0.10764em;">
                                        f
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.1514em;">
                                              <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                <span class="pstrut" style="height:2.7em;"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord text mtight">
                                                    <span class="mord mtight">
                                                      mag
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2861em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </td>
                            <td>
                              feature activation magnitudes (for features that have been deemed to be active)
                            </td>
                          </tr>
                          <tr>
                            <td>
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>
                                            π
                                          </mi>
                                          <mtext>
                                            gate
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        \pi_\text{gate}(x)
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right:0.03588em;">
                                        π
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2806em;">
                                              <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                                <span class="pstrut" style="height:2.7em;"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord text mtight">
                                                    <span class="mord mtight">
                                                      gate
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2861em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="mopen">
                                      (
                                    </span>
                                    <span class="mord mathnormal">
                                      x
                                    </span>
                                    <span class="mclose">
                                      )
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </td>
                            <td>
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mtext>
                                            gate
                                          </mtext>
                                        </msub>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        f_\text{gate}
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right:0.10764em;">
                                        f
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2806em;">
                                              <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                <span class="pstrut" style="height:2.7em;"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord text mtight">
                                                    <span class="mord mtight">
                                                      gate
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">
                                              ​
                                            </span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height:0.2861em;">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              sub-layer’s pre-activations
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <p dir="auto">
                      to negate the increases in parameters, use
                      <mark>
                        weight sharing
                      </mark>
                      :
                    </p>
                    <p dir="auto">
                      Scale
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    mag
                                  </mtext>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                W_\text{mag}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.1514em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              mag
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      in terms of
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    gate
                                  </mtext>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                W_\text{gate}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2806em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              gate
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      with a vector-valued rescaling parameter
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    r
                                  </mi>
                                  <mtext>
                                    mag
                                  </mtext>
                                </msub>
                                <mo>
                                  ∈
                                </mo>
                                <msup>
                                  <mi mathvariant="double-struck">
                                    R
                                  </mi>
                                  <mi>
                                    M
                                  </mi>
                                </msup>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                r_\text{mag} \in \mathbb{R}^M
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.02778em;">
                                r
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.1514em;">
                                      <span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              mag
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.8413em;"></span>
                            <span class="mord">
                              <span class="mord mathbb">
                                R
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8413em;">
                                      <span style="top:-3.063em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.10903em;">
                                            M
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      :
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mrow>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    mag
                                  </mtext>
                                </msub>
                                <msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                  <mrow>
                                    <mi>
                                      i
                                    </mi>
                                    <mi>
                                      j
                                    </mi>
                                  </mrow>
                                </msub>
                                <mo>
                                  <mi mathvariant="normal">
                                    ≔
                                  </mi>
                                </mo>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  exp
                                </mi>
                                <mo>
                                  ⁡
                                </mo>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    r
                                  </mi>
                                  <mtext>
                                    mag
                                  </mtext>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                  <mi>
                                    i
                                  </mi>
                                </msub>
                                <mo>
                                  ⋅
                                </mo>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    gate
                                  </mtext>
                                </msub>
                                <msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                  <mrow>
                                    <mi>
                                      i
                                    </mi>
                                    <mi>
                                      j
                                    </mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                (W_\text{mag})_{ij} \coloneqq (\exp (r_\text{mag}))_i \cdot (W_\text{gate})_{ij}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.1514em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              mag
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              <span class="mclose">
                                )
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                              ij
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              <span class="mrel">
                                <span class="mop" style="position:relative;top:-0.0347em;">
                                  :
                                </span>
                              </span>
                              <span class="mrel">
                                <span class="mspace" style="margin-right:-0.0667em;"></span>
                              </span>
                              <span class="mrel">
                                =
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mop">
                              exp
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.02778em;">
                                r
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.1514em;">
                                      <span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              mag
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mclose">
                              <span class="mclose">
                                )
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              ⋅
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2806em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              gate
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              <span class="mclose">
                                )
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                              ij
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <p dir="auto">
                      <img src="../thoughts/sparse-autoencoder/../../thoughts/images/gated-sae-architecture.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                    <p dir="auto">
                      <em>
                        Figure 3: Gated SAE with weight sharing between gating and magnitude paths
                      </em>
                    </p>
                    <p dir="auto">
                      <img src="../thoughts/sparse-autoencoder/../../thoughts/images/gated_jump_relu.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                    <p dir="auto">
                      <em>
                        Figure 4: A gated encoder become a single layer linear encoder with
                        <a href="../thoughts/sparse-autoencoder/../../thoughts/optimization#jumprelu" class="internal alias" data-slug="thoughts/optimization">
                          <span class="indicator-hook"></span>
                          JumpReLU
                        </a>
                      </em>
                      <cite class id="citation--erichson2019jumpreluretrofitdefensestrategy--4">
                        (
                        <a href="#bib-erichson2019jumpreluretrofitdefensestrategy" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Erichson et al., 2019
                        </a>
                        )
                      </cite>
                      <em>
                        activation function
                      </em>
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    σ
                                  </mi>
                                  <mi>
                                    θ
                                  </mi>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \sigma_\theta
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.03588em;">
                                σ
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3361em;">
                                      <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.02778em;">
                                            θ
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </p>
                    <h3 id="feature-suppression" dir="auto">
                      feature suppression
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#feature-suppression" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h3>
                    <p dir="auto">
                      See also:
                      <a href="https://www.alignmentforum.org/posts/3JuSjTZyMzaSeTxKk/addressing-feature-suppression-in-saes" class="external alias">
                        <span class="indicator-hook"></span>
                        link
                      </a>
                    </p>
                    <p dir="auto">
                      Loss function of SAEs combines a MSE reconstruction loss with sparsity term:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          L
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo separator="true">
                                          ,
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo separator="true">
                                          ,
                                        </mo>
                                        <mi>
                                          y
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mi>
                                          y
                                        </mi>
                                        <mo>
                                          −
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <msup>
                                          <mi mathvariant="normal">
                                            ∥
                                          </mi>
                                          <mn>
                                            2
                                          </mn>
                                        </msup>
                                        <mi mathvariant="normal">
                                          /
                                        </mi>
                                        <mi>
                                          d
                                        </mi>
                                        <mo>
                                          +
                                        </mo>
                                        <mi>
                                          c
                                        </mi>
                                        <mo>
                                          ∣
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          ∣
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <mi>
                                          d
                                        </mi>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           dimensionality of
                                        </mtext>
                                        <mi>
                                          x
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                L(x, f(x), y) &amp;= \|y-x\|^2/d + c\mid f(x) \mid \\[8pt]
                                &amp;\because d: \text{ dimensionality of }x
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:3.8241em;vertical-align:-1.6621em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.1621em;">
                                        <span style="top:-4.2979em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal">
                                              L
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord mathnormal" style="margin-right:0.03588em;">
                                              y
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.9979em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.6621em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.1621em;">
                                        <span style="top:-4.2979em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.03588em;">
                                              y
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mord">
                                              <span class="mord">
                                                ∥
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8641em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              /
                                            </span>
                                            <span class="mord mathnormal">
                                              d
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              c
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ∣
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ∣
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.9979em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord mathnormal">
                                              d
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 dimensionality of
                                              </span>
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.6621em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <blockquote>
                      <p dir="auto">
                        the reconstruction is not perfect, given that only one is reconstruction.
                        <strong>
                          For smaller value of
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f(x)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                  f
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                          , features will be suppressed
                        </strong>
                      </p>
                    </blockquote>
                    <blockquote class="callout note is-collapsible is-collapsed" data-callout="note" data-callout-fold>
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            illustrated example
                          </p>
                        </div>
                        <div class="fold-callout-icon" dir="auto"></div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          consider one binary feature in one dimension
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      =
                                    </mo>
                                    <mn>
                                      1
                                    </mn>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    x=1
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  =
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6444em;"></span>
                                <span class="mord">
                                  1
                                </span>
                              </span>
                            </span>
                          </span>
                          with probability
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      p
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    p
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span>
                                <span class="mord mathnormal">
                                  p
                                </span>
                              </span>
                            </span>
                          </span>
                          and
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      =
                                    </mo>
                                    <mn>
                                      0
                                    </mn>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    x=0
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  =
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6444em;"></span>
                                <span class="mord">
                                  0
                                </span>
                              </span>
                            </span>
                          </span>
                          otherwise. Ideally, optimal SAE would extract feature activation of
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mo stretchy="false">
                                      {
                                    </mo>
                                    <mn>
                                      0
                                    </mn>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <mn>
                                      1
                                    </mn>
                                    <mo stretchy="false">
                                      }
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f(x) \in \{0,1\}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                  f
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  ∈
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                                <span class="mopen">
                                  {
                                </span>
                                <span class="mord">
                                  0
                                </span>
                                <span class="mpunct">
                                  ,
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord">
                                  1
                                </span>
                                <span class="mclose">
                                  }
                                </span>
                              </span>
                            </span>
                          </span>
                          and have decoder
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        W
                                      </mi>
                                      <mi>
                                        d
                                      </mi>
                                    </msub>
                                    <mo>
                                      =
                                    </mo>
                                    <mn>
                                      1
                                    </mn>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    W_d=1
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.13889em;">
                                    W
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3361em;">
                                          <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight">
                                                d
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.15em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  =
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6444em;"></span>
                                <span class="mord">
                                  1
                                </span>
                              </span>
                            </span>
                          </span>
                        </p>
                        <p dir="auto">
                          However, if we train SAE optimizing loss function
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      L
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <mi>
                                      y
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    L(x, f(x), y)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                                <span class="mord mathnormal">
                                  L
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mpunct">
                                  ,
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                  f
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                                <span class="mpunct">
                                  ,
                                </span>
                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                <span class="mord mathnormal" style="margin-right:0.03588em;">
                                  y
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                          , let say encoder outputs feature activation
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      a
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    a
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  a
                                </span>
                              </span>
                            </span>
                          </span>
                          if
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      =
                                    </mo>
                                    <mn>
                                      1
                                    </mn>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    x=1
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  =
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6444em;"></span>
                                <span class="mord">
                                  1
                                </span>
                              </span>
                            </span>
                          </span>
                          and 0 otherwise, ignore bias term, the optimization problem becomes:
                        </p>
                        <span class="katex-display">
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                <semantics>
                                  <mrow>
                                    <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                      <mtr>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>
                                              a
                                            </mi>
                                          </mstyle>
                                        </mtd>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                              <mrow></mrow>
                                              <mo>
                                                =
                                              </mo>
                                              <mo>
                                                <mi mathvariant="normal">
                                                  arg min
                                                </mi>
                                                <mo>
                                                  ⁡
                                                </mo>
                                              </mo>
                                              <mi>
                                                p
                                              </mi>
                                              <mo>
                                                ∗
                                              </mo>
                                              <mi>
                                                L
                                              </mi>
                                              <mo stretchy="false">
                                                (
                                              </mo>
                                              <mn>
                                                1
                                              </mn>
                                              <mo separator="true">
                                                ,
                                              </mo>
                                              <mi>
                                                a
                                              </mi>
                                              <mo separator="true">
                                                ,
                                              </mo>
                                              <mi>
                                                a
                                              </mi>
                                              <mo stretchy="false">
                                                )
                                              </mo>
                                              <mo>
                                                +
                                              </mo>
                                              <mo stretchy="false">
                                                (
                                              </mo>
                                              <mn>
                                                1
                                              </mn>
                                              <mo>
                                                −
                                              </mo>
                                              <mi>
                                                p
                                              </mi>
                                              <mo stretchy="false">
                                                )
                                              </mo>
                                              <mo>
                                                ∗
                                              </mo>
                                              <mi>
                                                L
                                              </mi>
                                              <mo stretchy="false">
                                                (
                                              </mo>
                                              <mn>
                                                0
                                              </mn>
                                              <mo separator="true">
                                                ,
                                              </mo>
                                              <mn>
                                                0
                                              </mn>
                                              <mo separator="true">
                                                ,
                                              </mo>
                                              <mn>
                                                0
                                              </mn>
                                              <mo stretchy="false">
                                                )
                                              </mo>
                                            </mrow>
                                          </mstyle>
                                        </mtd>
                                      </mtr>
                                      <mtr>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                          </mstyle>
                                        </mtd>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                              <mrow></mrow>
                                              <mo>
                                                =
                                              </mo>
                                              <mo>
                                                <mi mathvariant="normal">
                                                  arg min
                                                </mi>
                                                <mo>
                                                  ⁡
                                                </mo>
                                              </mo>
                                              <mo stretchy="false">
                                                (
                                              </mo>
                                              <mn>
                                                1
                                              </mn>
                                              <mo>
                                                −
                                              </mo>
                                              <mi>
                                                a
                                              </mi>
                                              <msup>
                                                <mo stretchy="false">
                                                  )
                                                </mo>
                                                <mn>
                                                  2
                                                </mn>
                                              </msup>
                                              <mo>
                                                +
                                              </mo>
                                              <mo>
                                                ∣
                                              </mo>
                                              <mi>
                                                a
                                              </mi>
                                              <mo>
                                                ∣
                                              </mo>
                                              <mo>
                                                ∗
                                              </mo>
                                              <mi>
                                                c
                                              </mi>
                                            </mrow>
                                          </mstyle>
                                        </mtd>
                                      </mtr>
                                      <mtr>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                          </mstyle>
                                        </mtd>
                                        <mtd>
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                              <mrow></mrow>
                                              <mo>
                                                =
                                              </mo>
                                              <mo>
                                                <mi mathvariant="normal">
                                                  arg min
                                                </mi>
                                                <mo>
                                                  ⁡
                                                </mo>
                                              </mo>
                                              <msup>
                                                <mi>
                                                  a
                                                </mi>
                                                <mn>
                                                  2
                                                </mn>
                                              </msup>
                                              <mo>
                                                +
                                              </mo>
                                              <mo stretchy="false">
                                                (
                                              </mo>
                                              <mi>
                                                c
                                              </mi>
                                              <mo>
                                                −
                                              </mo>
                                              <mn>
                                                2
                                              </mn>
                                              <mo stretchy="false">
                                                )
                                              </mo>
                                              <mo>
                                                ∗
                                              </mo>
                                              <mi>
                                                a
                                              </mi>
                                              <mo>
                                                +
                                              </mo>
                                              <mn>
                                                1
                                              </mn>
                                            </mrow>
                                          </mstyle>
                                        </mtd>
                                      </mtr>
                                    </mtable>
                                    <mo>
                                      ⟹
                                    </mo>
                                    <menclose notation="box">
                                      <mstyle scriptlevel="0" displaystyle="false">
                                        <mstyle scriptlevel="0" displaystyle="false">
                                          <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                              <mi>
                                                a
                                              </mi>
                                              <mo>
                                                =
                                              </mo>
                                              <mn>
                                                1
                                              </mn>
                                              <mo>
                                                −
                                              </mo>
                                              <mfrac>
                                                <mi>
                                                  c
                                                </mi>
                                                <mn>
                                                  2
                                                </mn>
                                              </mfrac>
                                            </mrow>
                                          </mstyle>
                                        </mstyle>
                                      </mstyle>
                                    </menclose>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    \begin{aligned}
                                    a &amp;= \argmin p * L(1,a,a) + (1-p) * L(0,0,0) \\
                                    &amp;= \argmin (1-a)^2 + \mid a \mid * c  \\
                                    &amp;= \argmin a^2 + (c-2) *a +1
                                    \end{aligned}
                                    \Longrightarrow \boxed{a = 1-\frac{c}{2}}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:4.5482em;vertical-align:-2.0241em;"></span>
                                <span class="mord">
                                  <span class="mtable">
                                    <span class="col-align-r">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.5241em;">
                                            <span style="top:-4.6841em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.16em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord"></span>
                                            </span>
                                            <span style="top:-1.6359em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord"></span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.0241em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="col-align-l">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.5241em;">
                                            <span style="top:-4.6841em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mop">
                                                  <span class="mop">
                                                    <span class="mord mathrm" style="margin-right:0.01389em;">
                                                      arg
                                                    </span>
                                                    <span class="mspace" style="margin-right:0.1667em;"></span>
                                                    <span class="mord mathrm">
                                                      min
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathnormal">
                                                  p
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  ∗
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal">
                                                  L
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  1
                                                </span>
                                                <span class="mpunct">
                                                  ,
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mpunct">
                                                  ,
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  1
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  −
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal">
                                                  p
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  ∗
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal">
                                                  L
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  0
                                                </span>
                                                <span class="mpunct">
                                                  ,
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord">
                                                  0
                                                </span>
                                                <span class="mpunct">
                                                  ,
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord">
                                                  0
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.16em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mop">
                                                  <span class="mop">
                                                    <span class="mord mathrm" style="margin-right:0.01389em;">
                                                      arg
                                                    </span>
                                                    <span class="mspace" style="margin-right:0.1667em;"></span>
                                                    <span class="mord mathrm">
                                                      min
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  1
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  −
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mclose">
                                                  <span class="mclose">
                                                    )
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8641em;">
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                2
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  ∣
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  ∣
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  ∗
                                                </span>
                                                <span class="mord mathnormal">
                                                  c
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-1.6359em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mop">
                                                  <span class="mop">
                                                    <span class="mord mathrm" style="margin-right:0.01389em;">
                                                      arg
                                                    </span>
                                                    <span class="mspace" style="margin-right:0.1667em;"></span>
                                                    <span class="mord mathrm">
                                                      min
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    a
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8641em;">
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                2
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  c
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  −
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  2
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  ∗
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  1
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.0241em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  ⟹
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:2.4736em;vertical-align:-1.026em;"></span>
                                <span class="mord">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.4476em;">
                                        <span style="top:-4.4736em;">
                                          <span class="pstrut" style="height:4.4736em;"></span>
                                          <span class="boxpad">
                                            <span class="mord">
                                              <span class="mord">
                                                <span class="mord mathnormal">
                                                  a
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  1
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  −
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  <span class="mopen nulldelimiter"></span>
                                                  <span class="mfrac">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:1.1076em;">
                                                          <span style="top:-2.314em;">
                                                            <span class="pstrut" style="height:3em;"></span>
                                                            <span class="mord">
                                                              <span class="mord">
                                                                2
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span style="top:-3.23em;">
                                                            <span class="pstrut" style="height:3em;"></span>
                                                            <span class="frac-line" style="border-bottom-width:0.04em;"></span>
                                                          </span>
                                                          <span style="top:-3.677em;">
                                                            <span class="pstrut" style="height:3em;"></span>
                                                            <span class="mord">
                                                              <span class="mord mathnormal">
                                                                c
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.686em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="mclose nulldelimiter"></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.4476em;">
                                          <span class="pstrut" style="height:4.4736em;"></span>
                                          <span class="stretchy fbox" style="height:2.4736em;border-style:solid;border-width:0.04em;"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:1.026em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </div>
                    </blockquote>
                    <blockquote class="callout question is-collapsible" data-callout="question" data-callout-fold>
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            How do we fix feature suppression in training SAEs?
                          </p>
                        </div>
                        <div class="fold-callout-icon" dir="auto"></div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          introduce element-wise scaling factor per feature in-between encoder and decoder, represented by vector
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      s
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    s
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  s
                                </span>
                              </span>
                            </span>
                          </span>
                          :
                        </p>
                        <span class="katex-display">
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                <semantics>
                                  <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mi>
                                              f
                                            </mi>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              =
                                            </mo>
                                            <mtext>
                                              ReLU
                                            </mtext>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <msub>
                                              <mi>
                                                W
                                              </mi>
                                              <mi>
                                                e
                                              </mi>
                                            </msub>
                                            <mi>
                                              x
                                            </mi>
                                            <mo>
                                              +
                                            </mo>
                                            <msub>
                                              <mi>
                                                b
                                              </mi>
                                              <mi>
                                                e
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <msub>
                                              <mi>
                                                f
                                              </mi>
                                              <mi>
                                                s
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              =
                                            </mo>
                                            <mi>
                                              s
                                            </mi>
                                            <mo>
                                              ⊙
                                            </mo>
                                            <mi>
                                              f
                                            </mi>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mi>
                                            y
                                          </mi>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              =
                                            </mo>
                                            <msub>
                                              <mi>
                                                W
                                              </mi>
                                              <mi>
                                                d
                                              </mi>
                                            </msub>
                                            <msub>
                                              <mi>
                                                f
                                              </mi>
                                              <mi>
                                                s
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <mi>
                                              x
                                            </mi>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              +
                                            </mo>
                                            <msub>
                                              <mi>
                                                b
                                              </mi>
                                              <mi>
                                                d
                                              </mi>
                                            </msub>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                  </mtable>
                                  <annotation encoding="application/x-tex">
                                    \begin{aligned}
                                    f(x) &amp;= \text{ReLU}(W_e x + b_e) \\
                                    f_s(x) &amp;= s \odot f(x) \\
                                    y &amp;= W_d f_s(x) + b_d
                                    \end{aligned}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:4.5em;vertical-align:-2em;"></span>
                                <span class="mord">
                                  <span class="mtable">
                                    <span class="col-align-r">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.5em;">
                                            <span style="top:-4.66em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                  f
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.16em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                    f
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.1514em;">
                                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                s
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-1.66em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal" style="margin-right:0.03588em;">
                                                  y
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="col-align-l">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2.5em;">
                                            <span style="top:-4.66em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                    ReLU
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                    W
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.1514em;">
                                                          <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                e
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    b
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.1514em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                e
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.16em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord mathnormal">
                                                  s
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  ⊙
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                  f
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-1.66em;">
                                              <span class="pstrut" style="height:3em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                    W
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3361em;">
                                                          <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                d
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                    f
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.1514em;">
                                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                s
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord mathnormal">
                                                  x
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    b
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3361em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight">
                                                                d
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:2em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </div>
                    </blockquote>
                    <a href="../thoughts/sparse-autoencoder" class="internal transclude-src">
                      Lien vers l'original
                    </a>
                  </blockquote>
                  <p dir="auto"></p>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="sparse-crosscoders" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-sparse-crosscoders-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="sparse-crosscoders" dir="auto">
                  sparse crosscoders
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sparse-crosscoders" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-sparse-crosscoders-toggle" data-level="2" data-heading-id="sparse-crosscoders">
                  <p dir="auto"></p>
                  <blockquote class="transclude" data-url="thoughts/sparse-crosscoders" data-block data-embed-alias="undefined">
                    <blockquote class="callout tip" data-callout="tip">
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            maturity
                          </p>
                        </div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          a research preview from Anthroppic and this is pretty much still a work in progress
                        </p>
                      </div>
                    </blockquote>
                    <p dir="auto">
                      see also
                      <a href="https://colab.research.google.com/drive/124ODki4dUjfi21nuZPHRySALx9I74YHj?usp=sharing" class="external alias">
                        <span class="indicator-hook"></span>
                        reproduction on Gemma 2B
                      </a>
                      and
                      <a href="https://github.com/ckkissane/crosscoder-model-diff-replication" class="external alias">
                        <span class="indicator-hook"></span>
                        github
                      </a>
                    </p>
                    <p dir="auto">
                      A variant of
                      <a href="../thoughts/sparse-crosscoders/../../thoughts/sparse-autoencoder" class="internal alias" data-slug="thoughts/sparse-autoencoder">
                        <span class="indicator-hook"></span>
                        sparse autoencoder
                      </a>
                      where it reads and writes to multiple layers
                      <cite class id="citation--lindsey2024sparsecrosscoders--1">
                        (
                        <a href="#bib-lindsey2024sparsecrosscoders" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Lindsey et al., 2024
                        </a>
                        )
                      </cite>
                    </p>
                    <p dir="auto">
                      Crosscoders produces
                      <mark>
                        shared features across layers and even models
                      </mark>
                    </p>
                    <h2 id="motivations" dir="auto">
                      motivations
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#motivations" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h2>
                    <p dir="auto">
                      Resolve:
                    </p>
                    <ul dir="auto">
                      <li>
                        <p dir="auto">
                          cross-layer features: resolve cross-layer superposition
                        </p>
                      </li>
                      <li>
                        <p dir="auto">
                          circuit simplification: remove redundant features from analysis and enable jumping across training many uninteresting identity circuit connections
                        </p>
                      </li>
                      <li>
                        <p dir="auto">
                          model diffing: produce shared sets of features across models. This also introduce one model across training, and also completely independent models with different architectures.
                        </p>
                      </li>
                    </ul>
                    <h3 id="cross-layer-superposition" dir="auto">
                      cross-layer
                      <a href="../thoughts/sparse-crosscoders/../../thoughts/mechanistic-interpretability#superposition-hypothesis" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                        <span class="indicator-hook"></span>
                        superposition
                      </a>
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cross-layer-superposition" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h3>
                    <p dir="auto">
                      <img src="../thoughts/sparse-crosscoders/../../thoughts/images/additive-residual-stream-llm.webp" width="auto" height="auto" alt loading="lazy"/>
                      <em>
                        given the additive properties of transformers’ residual stream,
                        <strong>
                          adjacent layers
                        </strong>
                        in larger transformers can be thought as “almost parallel”
                      </em>
                    </p>
                    <blockquote class="callout tip is-collapsible is-collapsed" data-callout="tip" data-callout-fold>
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            intuition
                          </p>
                        </div>
                        <div class="fold-callout-icon" dir="auto"></div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          In basis of superposition hypothesis, a feature is a linear combinations of neurons at any given layers.
                        </p>
                        <p dir="auto">
                          <img src="../thoughts/sparse-crosscoders/../../thoughts/images/feature-neurons.webp" width="auto" height="auto" alt loading="lazy"/>
                        </p>
                      </div>
                    </blockquote>
                    <p dir="auto">
                      <img src="../thoughts/sparse-crosscoders/../../thoughts/images/one-step-circuit.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                    <p dir="auto">
                      <img src="../thoughts/sparse-crosscoders/../../thoughts/images/parallel-joint-branch.webp" width="auto" height="auto" alt loading="lazy"/>
                      <em>
                        if we think of adjacent layers as being “almost parallel branches that potentially have superposition between them”, then we can apply dictionary learning jointly
                        <sup>
                          <a href="#user-content-fn-jointlysae" id="user-content-fnref-jointlysae" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                            <span class="indicator-hook"></span>
                            5
                          </a>
                        </sup>
                      </em>
                    </p>
                    <h3 id="persistent-features-and-complexity" dir="auto">
                      persistent features and complexity
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#persistent-features-and-complexity" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h3>
                    <p dir="auto">
                      Current drawbacks of sparse autoencoders is that we have to train it against certain activations layers to extract features. In terms of the residual
                      stream per layers, we end up having lots of duplicate features across layers.
                    </p>
                    <blockquote>
                      <p dir="auto">
                        Crosscoders can simplify the circuit
                        <em>
                          given that we use an appropriate architecture
                        </em>
                        <sup>
                          <a href="#user-content-fn-risks" id="user-content-fnref-risks" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                            <span class="indicator-hook"></span>
                            6
                          </a>
                        </sup>
                      </p>
                    </blockquote>
                    <h2 id="setup" dir="auto">
                      setup.
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#setup" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h2>
                    <blockquote>
                      <p dir="auto">
                        Autoencoders and transcoders as special cases of crosscoders.
                      </p>
                      <ul dir="auto">
                        <li>
                          autoencoders: reads and predict the same layers
                        </li>
                        <li>
                          transcoders: read from layer
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      n
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    n
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.4306em;"></span>
                                <span class="mord mathnormal">
                                  n
                                </span>
                              </span>
                            </span>
                          </span>
                          and predict layer
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      n
                                    </mi>
                                    <mo>
                                      +
                                    </mo>
                                    <mn>
                                      1
                                    </mn>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    n+1
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                                <span class="mord mathnormal">
                                  n
                                </span>
                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                <span class="mbin">
                                  +
                                </span>
                                <span class="mspace" style="margin-right:0.2222em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6444em;"></span>
                                <span class="mord">
                                  1
                                </span>
                              </span>
                            </span>
                          </span>
                        </li>
                      </ul>
                    </blockquote>
                    <p dir="auto">
                      Crosscoder read/write to many layers, subject to causality constraints.
                    </p>
                    <blockquote class="callout math is-collapsible" data-callout="math" data-callout-fold>
                      <div class="callout-title" dir="auto">
                        <div class="callout-icon" dir="auto"></div>
                        <div class="callout-title-inner" dir="auto">
                          <p dir="auto">
                            crosscoders
                          </p>
                        </div>
                        <div class="fold-callout-icon" dir="auto"></div>
                      </div>
                      <div class="callout-content" dir="auto">
                        <p dir="auto">
                          Let one compute the vector of feature activation
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mo stretchy="false">
                                        (
                                      </mo>
                                    </msub>
                                    <msub>
                                      <mi>
                                        x
                                      </mi>
                                      <mi>
                                        j
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f_(x_j)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                    f
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3448em;">
                                          <span style="top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mopen mtight">
                                                (
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3552em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    x
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3117em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                j
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                          on data point
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        x
                                      </mi>
                                      <mi>
                                        j
                                      </mi>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    x_j
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    x
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3117em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                j
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          by summing over contributions of activations of different layers
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msup>
                                      <mi>
                                        a
                                      </mi>
                                      <mi>
                                        l
                                      </mi>
                                    </msup>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <msub>
                                      <mi>
                                        x
                                      </mi>
                                      <mi>
                                        j
                                      </mi>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    a^l(x_j)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1.1352em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    a
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.8491em;">
                                          <span style="top:-3.063em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                l
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord">
                                  <span class="mord mathnormal">
                                    x
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.3117em;">
                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                j
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                          for layers
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <mi>
                                      l
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    l \in L
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span>
                                <span class="mord mathnormal" style="margin-right:0.01968em;">
                                  l
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                <span class="mrel">
                                  ∈
                                </span>
                                <span class="mspace" style="margin-right:0.2778em;"></span>
                              </span>
                              <span class="base">
                                <span class="strut" style="height:0.6833em;"></span>
                                <span class="mord mathnormal">
                                  L
                                </span>
                              </span>
                            </span>
                          </span>
                          :
                        </p>
                        <span class="katex-display">
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                                <semantics>
                                  <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mi>
                                              f
                                            </mi>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <msub>
                                              <mi>
                                                x
                                              </mi>
                                              <mi>
                                                j
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              =
                                            </mo>
                                            <mtext>
                                              ReLU
                                            </mtext>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <munder>
                                              <mo>
                                                ∑
                                              </mo>
                                              <mrow>
                                                <mi>
                                                  l
                                                </mi>
                                                <mo>
                                                  ∈
                                                </mo>
                                                <mi>
                                                  L
                                                </mi>
                                              </mrow>
                                            </munder>
                                            <msubsup>
                                              <mi>
                                                W
                                              </mi>
                                              <mtext>
                                                enc
                                              </mtext>
                                              <mi>
                                                l
                                              </mi>
                                            </msubsup>
                                            <msup>
                                              <mi>
                                                a
                                              </mi>
                                              <mi>
                                                l
                                              </mi>
                                            </msup>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <msub>
                                              <mi>
                                                x
                                              </mi>
                                              <mi>
                                                j
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              +
                                            </mo>
                                            <msub>
                                              <mi>
                                                b
                                              </mi>
                                              <mtext>
                                                enc
                                              </mtext>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow></mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              ∵
                                            </mo>
                                            <msubsup>
                                              <mi>
                                                W
                                              </mi>
                                              <mtext>
                                                enc
                                              </mtext>
                                              <mi>
                                                l
                                              </mi>
                                            </msubsup>
                                            <mo>
                                              :
                                            </mo>
                                            <mtext>
                                               encoder weights at layer
                                            </mtext>
                                            <mi>
                                              l
                                            </mi>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                    <mtr>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow></mrow>
                                        </mstyle>
                                      </mtd>
                                      <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                          <mrow>
                                            <mrow></mrow>
                                            <mo>
                                              ∵
                                            </mo>
                                            <msup>
                                              <mi>
                                                a
                                              </mi>
                                              <mi>
                                                l
                                              </mi>
                                            </msup>
                                            <mo stretchy="false">
                                              (
                                            </mo>
                                            <msub>
                                              <mi>
                                                x
                                              </mi>
                                              <mi>
                                                j
                                              </mi>
                                            </msub>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mo>
                                              :
                                            </mo>
                                            <mtext>
                                               activation on datapoint
                                            </mtext>
                                            <msub>
                                              <mi>
                                                x
                                              </mi>
                                              <mi>
                                                j
                                              </mi>
                                            </msub>
                                            <mtext>
                                               at layer
                                            </mtext>
                                            <mi>
                                              l
                                            </mi>
                                          </mrow>
                                        </mstyle>
                                      </mtd>
                                    </mtr>
                                  </mtable>
                                  <annotation encoding="application/x-tex">
                                    \begin{aligned}
                                    f(x_j) &amp;= \text{ReLU}(\sum_{l\in L}W_{\text{enc}}^l a^l(x_j) + b_{\text{enc}}) \\[8pt]
                                    &amp;\because W^l_{\text{enc}} : \text{ encoder weights at layer } l \\[8pt]
                                    &amp;\because a^l(x_j) : \text{ activation on datapoint } x_j \text{ at layer } l \\
                                    \end{aligned}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:6.5977em;vertical-align:-3.0489em;"></span>
                                <span class="mord">
                                  <span class="mtable">
                                    <span class="col-align-r">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.5489em;">
                                            <span style="top:-5.5489em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord">
                                                <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                  f
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                                j
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.2861em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.0203em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord"></span>
                                            </span>
                                            <span style="top:-0.6612em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord"></span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.0489em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="col-align-l">
                                      <span class="vlist-t vlist-t2">
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.5489em;">
                                            <span style="top:-5.5489em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  =
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                    ReLU
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mop op-limits">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:1.05em;">
                                                        <span style="top:-1.8479em;margin-left:0em;">
                                                          <span class="pstrut" style="height:3.05em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                                l
                                                              </span>
                                                              <span class="mrel mtight">
                                                                ∈
                                                              </span>
                                                              <span class="mord mathnormal mtight">
                                                                L
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span style="top:-3.05em;">
                                                          <span class="pstrut" style="height:3.05em;"></span>
                                                          <span>
                                                            <span class="mop op-symbol large-op">
                                                              ∑
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:1.3295em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                    W
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8991em;">
                                                          <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                <span class="mord text mtight">
                                                                  <span class="mord mtight">
                                                                    enc
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                                l
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.247em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    a
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8991em;">
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                                l
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                                j
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.2861em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mbin">
                                                  +
                                                </span>
                                                <span class="mspace" style="margin-right:0.2222em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    b
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.1514em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                <span class="mord text mtight">
                                                                  <span class="mord mtight">
                                                                    enc
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.15em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-3.0203em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel amsrm">
                                                  ∵
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                    W
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8991em;">
                                                          <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mtight">
                                                                <span class="mord text mtight">
                                                                  <span class="mord mtight">
                                                                    enc
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                                l
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.247em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  :
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                     encoder weights at layer
                                                  </span>
                                                </span>
                                                <span class="mord mathnormal" style="margin-right:0.01968em;">
                                                  l
                                                </span>
                                              </span>
                                            </span>
                                            <span style="top:-0.6612em;">
                                              <span class="pstrut" style="height:3.05em;"></span>
                                              <span class="mord">
                                                <span class="mord"></span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel amsrm">
                                                  ∵
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    a
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.8991em;">
                                                          <span style="top:-3.113em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                                l
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mopen">
                                                  (
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                                j
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.2861em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mclose">
                                                  )
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mrel">
                                                  :
                                                </span>
                                                <span class="mspace" style="margin-right:0.2778em;"></span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                     activation on datapoint
                                                  </span>
                                                </span>
                                                <span class="mord">
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                  <span class="msupsub">
                                                    <span class="vlist-t vlist-t2">
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.3117em;">
                                                          <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                            <span class="pstrut" style="height:2.7em;"></span>
                                                            <span class="sizing reset-size6 size3 mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                                j
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                        <span class="vlist-s">
                                                          ​
                                                        </span>
                                                      </span>
                                                      <span class="vlist-r">
                                                        <span class="vlist" style="height:0.2861em;">
                                                          <span></span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="mord text">
                                                  <span class="mord">
                                                     at layer
                                                  </span>
                                                </span>
                                                <span class="mord mathnormal" style="margin-right:0.01968em;">
                                                  l
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="vlist-s">
                                            ​
                                          </span>
                                        </span>
                                        <span class="vlist-r">
                                          <span class="vlist" style="height:3.0489em;">
                                            <span></span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </div>
                    </blockquote>
                    <p dir="auto">
                      We have loss
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mrow>
                                <mi>
                                  L
                                </mi>
                                <mo>
                                  =
                                </mo>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mrow>
                                    <mi>
                                      l
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                </munder>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <msup>
                                  <mi>
                                    a
                                  </mi>
                                  <mi>
                                    l
                                  </mi>
                                </msup>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mo>
                                  −
                                </mo>
                                <msup>
                                  <mi>
                                    a
                                  </mi>
                                  <msup>
                                    <mi>
                                      l
                                    </mi>
                                    <msup>
                                      <mrow></mrow>
                                      <mo mathvariant="normal" lspace="0em" rspace="0em">
                                        ′
                                      </mo>
                                    </msup>
                                  </msup>
                                </msup>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <msup>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <mn>
                                    2
                                  </mn>
                                </msup>
                                <mo>
                                  +
                                </mo>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mrow>
                                    <mi>
                                      l
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                </munder>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mi>
                                    i
                                  </mi>
                                </munder>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mi>
                                    i
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <msubsup>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    dec,i
                                  </mtext>
                                  <mi>
                                    l
                                  </mi>
                                </msubsup>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                L = \sum_{l\in L} \|a^l(x_j) - a^{l^{'}}(x_j)\|^2 + \sum_{l\in L}\sum_i f_i(x_j) \|W^l_{\text{dec,i}}\|
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6833em;"></span>
                            <span class="mord mathnormal">
                              L
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8479em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="mrel mtight">
                                            ∈
                                          </span>
                                          <span class="mord mathnormal mtight">
                                            L
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.3295em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                a
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8991em;">
                                      <span style="top:-3.113em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              −
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:1.4806em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                a
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:1.1945em;">
                                      <span style="top:-3.1945em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7815em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord mtight">
                                              <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                l
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:1.1164em;">
                                                      <span style="top:-3.1164em;margin-right:0.0714em;">
                                                        <span class="pstrut" style="height:2.6854em;"></span>
                                                        <span class="sizing reset-size3 size1 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord mtight">
                                                              <span></span>
                                                              <span class="msupsub">
                                                                <span class="vlist-t">
                                                                  <span class="vlist-r">
                                                                    <span class="vlist" style="height:0.9596em;">
                                                                      <span style="top:-2.9596em;margin-right:0.1em;">
                                                                        <span class="pstrut" style="height:2.5556em;"></span>
                                                                        <span class="mord mtight">
                                                                          <span class="mord mtight">
                                                                            ′
                                                                          </span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mord">
                              <span class="mord">
                                ∥
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8641em;">
                                      <span style="top:-3.113em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            2
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              +
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8479em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="mrel mtight">
                                            ∈
                                          </span>
                                          <span class="mord mathnormal mtight">
                                            L
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.3295em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8723em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight">
                                          i
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.2777em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8991em;">
                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord text mtight">
                                              <span class="mord mtight">
                                                dec,i
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.113em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3831em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <p dir="auto">
                      and regularization can be rewritten as:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mrow>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mrow>
                                    <mi>
                                      l
                                    </mi>
                                    <mo>
                                      ∈
                                    </mo>
                                    <mi>
                                      L
                                    </mi>
                                  </mrow>
                                </munder>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mi>
                                    i
                                  </mi>
                                </munder>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mi>
                                    i
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <msubsup>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    dec,i
                                  </mtext>
                                  <mi>
                                    l
                                  </mi>
                                </msubsup>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <mo>
                                  =
                                </mo>
                                <munder>
                                  <mo>
                                    ∑
                                  </mo>
                                  <mi>
                                    i
                                  </mi>
                                </munder>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mi>
                                    i
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <munder>
                                    <mo>
                                      ∑
                                    </mo>
                                    <mrow>
                                      <mi>
                                        l
                                      </mi>
                                      <mo>
                                        ∈
                                      </mo>
                                      <mi>
                                        L
                                      </mi>
                                    </mrow>
                                  </munder>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <msubsup>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec,i
                                    </mtext>
                                    <mi>
                                      l
                                    </mi>
                                  </msubsup>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mstyle>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \sum_{l\in L}\sum_{i} f_i(x_j) \|W^l_{\text{dec,i}}\| = \sum_{i} f_i(x_j)(\displaystyle\sum_{l \in L} \|W^l_\text{dec,i}\|)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8479em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="mrel mtight">
                                            ∈
                                          </span>
                                          <span class="mord mathnormal mtight">
                                            L
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.3295em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8723em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.2777em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8991em;">
                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord text mtight">
                                              <span class="mord mtight">
                                                dec,i
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.113em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3831em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8723em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.2777em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mop op-limits">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.05em;">
                                    <span style="top:-1.8479em;margin-left:0em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="mrel mtight">
                                            ∈
                                          </span>
                                          <span class="mord mathnormal mtight">
                                            L
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.05em;">
                                      <span class="pstrut" style="height:3.05em;"></span>
                                      <span>
                                        <span class="mop op-symbol large-op">
                                          ∑
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.3295em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8991em;">
                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec,i
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.113em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3831em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <p dir="auto">
                      <em>
                        weight of L1 regularization penalty by L1 norm of per-layer decoder weight norms
                      </em>
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                                <msubsup>
                                  <mi>
                                    W
                                  </mi>
                                  <mtext>
                                    dec,i
                                  </mtext>
                                  <mi>
                                    l
                                  </mi>
                                </msubsup>
                                <mi mathvariant="normal">
                                  ∥
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \sum\limits{l\in L} \|W^l_\text{dec,i}\|
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                            <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                              ∑
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.01968em;">
                                l
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mrel">
                                ∈
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mord mathnormal">
                                L
                              </span>
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8491em;">
                                      <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec,i
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.063em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.4192em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              ∥
                            </span>
                          </span>
                        </span>
                      </span>
                      <sup>
                        <a href="#user-content-fn-l2weightnorm" id="user-content-fnref-l2weightnorm" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                          <span class="indicator-hook"></span>
                          7
                        </a>
                      </sup>
                    </p>
                    <p dir="auto">
                      We use L1 due to
                    </p>
                    <ul dir="auto">
                      <li>
                        <p dir="auto">
                          baseline loss comparison: L2 exhibits lower loss than sum of per-layer SAE losses, as they would effectively obtain a loss “bonus” by spreading features across layers
                        </p>
                      </li>
                      <li>
                        <p dir="auto">
                          <mark>
                            layer-wise sparsity surfaces layer-specific features
                          </mark>
                          : based on empirical results of
                          <a href="../thoughts/sparse-crosscoders/../../thoughts/sparse-crosscoders#model-diffing" class="internal alias" data-slug="thoughts/sparse-crosscoders">
                            <span class="indicator-hook"></span>
                            model diffing
                          </a>
                          , that L1 uncovers a mix of shared and model-specific features, whereas L2 tends to uncover only shared features.
                        </p>
                      </li>
                    </ul>
                    <h2 id="variants" dir="auto">
                      variants
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#variants" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h2>
                    <p dir="auto">
                      <img src="../thoughts/sparse-crosscoders/../../thoughts/images/crosscoders-variants.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                    <p dir="auto">
                      good to explore:
                    </p>
                    <ol dir="auto">
                      <li>
                        strictly causal crosscoders to capture MLP computation and treat computation performed by attention layers as linear
                      </li>
                      <li>
                        combine strictly causal crosscoders for MLP outputs without weakly causal crosscoders for attention outputs
                      </li>
                      <li>
                        interpretable attention replacement layers that could be used in combination with strictly causal crosscoders for a “replacement model”
                      </li>
                    </ol>
                    <h2 id="model-diffing" dir="auto">
                      model diffing
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#model-diffing" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h2>
                    <p dir="auto">
                      see also:
                      <a href="../thoughts/sparse-crosscoders/../../thoughts/model-stiching" class="internal alias" data-slug="thoughts/model-stiching">
                        <span class="indicator-hook"></span>
                        model stiching
                      </a>
                      and
                      <a href="../thoughts/sparse-crosscoders/../../thoughts/SVCCA" class="internal" data-slug="thoughts/SVCCA">
                        <span class="indicator-hook"></span>
                        SVCCA
                      </a>
                    </p>
                    <blockquote>
                      <p dir="auto">
                        <cite class id="citation--doi:10.1080/09515080050002726--2">
                          (
                          <a href="#bib-doi:10.1080/09515080050002726" data-no-popover data-bib class="internal alias">
                            <span class="indicator-hook"></span>
                            Laakso &amp; Cottrell, 2000
                          </a>
                          )
                        </cite>
                        proposes compare
                        <a href="../thoughts/sparse-crosscoders/../../thoughts/representations" class="internal" data-slug="thoughts/representations">
                          <span class="indicator-hook"></span>
                          representations
                        </a>
                        by transforming into representations of distances between data points.
                        <sup>
                          <a href="#user-content-fn-sne" id="user-content-fnref-sne" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                            <span class="indicator-hook"></span>
                            8
                          </a>
                        </sup>
                      </p>
                    </blockquote>
                    <h2 id="questions" dir="auto">
                      questions
                      <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#questions" class="internal">
                        <span class="indicator-hook"></span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                      </a>
                    </h2>
                    <blockquote>
                      <p dir="auto">
                        How do features change over model training? When do they form?
                      </p>
                    </blockquote>
                    <blockquote>
                      <p dir="auto">
                        As we make a model wider, do we get more features? or they are largely the same, packed less densely?
                      </p>
                    </blockquote>
                    <a href="../thoughts/sparse-crosscoders" class="internal transclude-src">
                      Lien vers l'original
                    </a>
                  </blockquote>
                  <p dir="auto"></p>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="superposition-hypothesis" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-superposition-hypothesis-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="superposition-hypothesis" dir="auto">
                  superposition hypothesis
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#superposition-hypothesis" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-superposition-hypothesis-toggle" data-level="2" data-heading-id="superposition-hypothesis">
                  <blockquote class="callout abstract is-collapsible" data-callout="abstract" data-callout-fold>
                    <div class="callout-title" dir="auto">
                      <div class="callout-icon" dir="auto"></div>
                      <div class="callout-title-inner" dir="auto">
                        <p dir="auto">
                          tl/dr
                        </p>
                      </div>
                      <div class="fold-callout-icon" dir="auto"></div>
                    </div>
                    <div class="callout-content" dir="auto">
                      <p dir="auto">
                        phenomena when a neural network represents
                        <em>
                          more
                        </em>
                        than
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    n
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  n
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.4306em;"></span>
                              <span class="mord mathnormal">
                                n
                              </span>
                            </span>
                          </span>
                        </span>
                        features in a
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    n
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  n
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.4306em;"></span>
                              <span class="mord mathnormal">
                                n
                              </span>
                            </span>
                          </span>
                        </span>
                        -dimensional space
                      </p>
                    </div>
                  </blockquote>
                  <blockquote>
                    <p dir="auto">
                      Linear representation of neurons can represent more features than dimensions. As sparsity increases, model use
                      superposition to represent more
                      <a href="../thoughts/mechanistic-interpretability#features" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                        <span class="indicator-hook"></span>
                        features
                      </a>
                      than dimensions.
                    </p>
                    <p dir="auto">
                      neural networks “want to represent more features than they have neurons”.
                    </p>
                  </blockquote>
                  <p dir="auto">
                    When features are sparsed, superposition allows compression beyond what linear model can do, at a cost of interference that requires non-linear filtering.
                  </p>
                  <p dir="auto">
                    reasoning: “noisy simulation”, where small neural networks exploit feature sparsity and properties of high-dimensional spaces to approximately simulate much larger much sparser neural networks
                  </p>
                  <p dir="auto">
                    In a sense, superposition is a form of
                    <strong>
                      lossy
                      <a href="../thoughts/Compression" class="internal alias" data-slug="thoughts/Compression">
                        <span class="indicator-hook"></span>
                        compression
                      </a>
                    </strong>
                  </p>
                  <section class="collapsible-header" id="importance" data-level="3">
                    <div class="header-controls">
                      <button id="collapsible-header-importance-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                        <div class="toggle-icons">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                            <circle cx="12" cy="12" r="3"></circle>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                        </div>
                      </button>
                      <h3 id="importance" dir="auto">
                        importance
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                          <circle cx="6" cy="12" r="2"></circle>
                          <circle cx="12" cy="12" r="2"></circle>
                          <circle cx="18" cy="12" r="2"></circle>
                        </svg>
                        <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#importance" class="internal">
                          <span class="indicator-hook"></span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                          </svg>
                        </a>
                      </h3>
                    </div>
                    <div class="collapsible-header-content-outer">
                      <div class="collapsible-header-content" data-references="collapsible-header-importance-toggle" data-level="3" data-heading-id="importance">
                        <ul dir="auto">
                          <li>
                            <p dir="auto">
                              sparsity: how
                              <em>
                                frequently
                              </em>
                              is it in the input?
                            </p>
                          </li>
                          <li>
                            <p dir="auto">
                              importance: how useful is it for lowering loss?
                            </p>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </section>
                  <section class="collapsible-header" id="over-complete-basis" data-level="3">
                    <div class="header-controls">
                      <button id="collapsible-header-over-complete-basis-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                        <div class="toggle-icons">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                            <circle cx="12" cy="12" r="3"></circle>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                          </svg>
                        </div>
                      </button>
                      <h3 id="over-complete-basis" dir="auto">
                        over-complete basis
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                          <circle cx="6" cy="12" r="2"></circle>
                          <circle cx="12" cy="12" r="2"></circle>
                          <circle cx="18" cy="12" r="2"></circle>
                        </svg>
                        <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#over-complete-basis" class="internal">
                          <span class="indicator-hook"></span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                          </svg>
                        </a>
                      </h3>
                    </div>
                    <div class="collapsible-header-content-outer">
                      <div class="collapsible-header-content" data-references="collapsible-header-over-complete-basis-toggle" data-level="3" data-heading-id="over-complete-basis">
                        <p dir="auto">
                          <em>
                            reasoning for the set of
                            <span class="katex">
                              <span class="katex-mathml">
                                <math xmlns="http://www.w3.org/1998/Math/MathML">
                                  <semantics>
                                    <mrow>
                                      <mi>
                                        n
                                      </mi>
                                    </mrow>
                                    <annotation encoding="application/x-tex">
                                      n
                                    </annotation>
                                  </semantics>
                                </math>
                              </span>
                              <span class="katex-html" aria-hidden="true">
                                <span class="base">
                                  <span class="strut" style="height:0.4306em;"></span>
                                  <span class="mord mathnormal">
                                    n
                                  </span>
                                </span>
                              </span>
                            </span>
                            directions
                            <sup>
                              <a href="#user-content-fn-direction" id="user-content-fnref-direction" data-footnote-ref aria-describedby="footnote-label" class="internal alias">
                                <span class="indicator-hook"></span>
                                9
                              </a>
                            </sup>
                          </em>
                        </p>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="features" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-features-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="features" dir="auto">
                  features
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#features" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-features-toggle" data-level="2" data-heading-id="features">
                  <blockquote>
                    <p dir="auto">
                      A property of an input to the model
                    </p>
                  </blockquote>
                  <p dir="auto">
                    When we talk about features
                    <cite class id="citation--elhage2022superposition--2">
                      (
                      <a href="#bib-elhage2022superposition" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Elhage et al., 2022, p. see “Empirical Phenomena”
                      </a>
                      )
                    </cite>
                    , the theory building around
                    several observed empirical phenomena:
                  </p>
                  <ol dir="auto">
                    <li>
                      Word Embeddings: have direction which corresponding to semantic properties
                      <cite class id="citation--mikolov-etal-2013-linguistic--3">
                        (
                        <a href="#bib-mikolov-etal-2013-linguistic" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Mikolov et al., 2013
                        </a>
                        )
                      </cite>
                      . For
                      example:
                      <figure data-rehype-pretty-code-figure>
                        <pre style="--shiki-light:#575279;--shiki-dark:#e0def4;--shiki-light-bg:#faf4ed;--shiki-dark-bg:#191724;" tabindex="0" data-language="prolog" data-theme="rose-pine-dawn rose-pine"><code data-language="prolog" data-theme="rose-pine-dawn rose-pine" style="display:grid;"><span data-line><span style="--shiki-light:#D7827E;--shiki-dark:#EBBCBA;">V</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">king</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) - </span><span style="--shiki-light:#907AA9;--shiki-light-font-style:italic;--shiki-dark:#C4A7E7;--shiki-dark-font-style:italic;">V</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">man</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) = </span><span style="--shiki-light:#907AA9;--shiki-light-font-style:italic;--shiki-dark:#C4A7E7;--shiki-dark-font-style:italic;">V</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">monarch</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">)</span></span></code></pre>
                      </figure>
                    </li>
                    <li>
                      Latent space: similar vector arithmetics and interpretable directions have also been found in generative adversarial
                      network.
                    </li>
                  </ol>
                  <p dir="auto">
                    We can define features as properties of inputs which a sufficiently large neural network will reliably dedicate
                    a neuron to represent
                    <cite class id="citation--elhage2022superposition--4">
                      (
                      <a href="#bib-elhage2022superposition" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Elhage et al., 2022, p. see “Features as Direction”
                      </a>
                      )
                    </cite>
                  </p>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="ablation" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-ablation-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="ablation" dir="auto">
                  ablation
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ablation" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-ablation-toggle" data-level="2" data-heading-id="ablation">
                  <blockquote>
                    <p dir="auto">
                      refers to the process of removing a subset of a model’s parameters to evaluate its predictions outcome.
                    </p>
                  </blockquote>
                  <p dir="auto">
                    idea: deletes one activation of the network to see how performance on a task changes.
                  </p>
                  <ul dir="auto">
                    <li>
                      zero ablation or
                      <em>
                        pruning
                      </em>
                      : Deletion by setting activations to zero
                    </li>
                    <li>
                      mean ablation: Deletion by setting activations to the mean of the dataset
                    </li>
                    <li>
                      random ablation or
                      <em>
                        resampling
                      </em>
                    </li>
                  </ul>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="residual-stream" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-residual-stream-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="residual-stream" dir="auto">
                  residual stream
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#residual-stream" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-residual-stream-toggle" data-level="2" data-heading-id="residual-stream">
                  <pre><button class="expand-button" aria-label="Expand mermaid diagram" aria-hidden="true" data-view-component="true" tabindex="-1"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M3.72 3.72a.75.75 0 011.06 1.06L2.56 7h10.88l-2.22-2.22a.75.75 0 011.06-1.06l3.5 3.5a.75.75 0 010 1.06l-3.5 3.5a.75.75 0 11-1.06-1.06l2.22-2.22H2.56l2.22 2.22a.75.75 0 11-1.06 1.06l-3.5-3.5a.75.75 0 010-1.06l3.5-3.5z"></path></svg></button><code class="mermaid" data-clipboard="flowchart LR
  A[Token] --> B[Embeddings] --> C[x0]
  C[x0] --> E[H] --> D[x1]
  C[x0] --> D
  D --> F[MLP] --> G[x2]
  D --> G[x2]
  G --> I[...] --> J[unembed] --> X[logits]">flowchart LR
  A[Token] --> B[Embeddings] --> C[x0]
  C[x0] --> E[H] --> D[x1]
  C[x0] --> D
  D --> F[MLP] --> G[x2]
  D --> G[x2]
  G --> I[...] --> J[unembed] --> X[logits]
</code></pre>
                  <p dir="auto">
                    residual stream
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  0
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x_{0}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            0
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    has dimension
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mo stretchy="false">
                                (
                              </mo>
                              <mi>
                                C
                              </mi>
                              <mo separator="true">
                                ,
                              </mo>
                              <mi>
                                E
                              </mi>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \mathit{(C,E)}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord">
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathit">
                              C
                            </span>
                            <span class="mpunct">
                              ,
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord mathit">
                              E
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    where
                  </p>
                  <ul dir="auto">
                    <li>
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  C
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \mathit{C}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6833em;"></span>
                            <span class="mord mathit">
                              C
                            </span>
                          </span>
                        </span>
                      </span>
                      : the number of tokens in context windows and
                    </li>
                    <li>
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  E
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \mathit{E}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6833em;"></span>
                            <span class="mord mathit">
                              E
                            </span>
                          </span>
                        </span>
                      </span>
                      : embedding dimension.
                    </li>
                  </ul>
                  <p dir="auto">
                    <a href="../thoughts/Attention" class="internal" data-slug="thoughts/Attention">
                      <span class="indicator-hook"></span>
                      Attention
                    </a>
                    mechanism
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                H
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \mathit{H}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.6833em;"></span>
                          <span class="mord mathit">
                            H
                          </span>
                        </span>
                      </span>
                    </span>
                    process given residual stream
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  0
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x_{0}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            0
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    as the result is added back to
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  1
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x_{1}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            1
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    :
                  </p>
                  <span class="katex-display">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  1
                                </mn>
                              </msub>
                              <mo>
                                =
                              </mo>
                              <mi>
                                H
                              </mi>
                              <mrow>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mn>
                                    0
                                  </mn>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <mo>
                                +
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  0
                                </mn>
                              </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x_{1} = \mathit{H}{(x_{0})} + x_{0}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            1
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            =
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord mathit">
                            H
                          </span>
                          <span class="mord">
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3011em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mtight">
                                            <span class="mord mtight">
                                              0
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            +
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            0
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </div>
              </div>
            </section>
            <section class="collapsible-header" id="grokking" data-level="2">
              <div class="header-controls">
                <button id="collapsible-header-grokking-toggle" aria-label="Toggle content visibility" aria-expanded="true" class="toggle-button">
                  <div class="toggle-icons">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--dark)" stroke="var(--dark)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="circle-icon">
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--tertiary)" stroke="var(--tertiary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="expand-icon">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="collapse-icon">
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </div>
                </button>
                <h2 id="grokking" dir="auto">
                  grokking
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0" stroke-linecap="round" stroke-linejoin="round" style="padding-left:0.2rem;" class="collapsed-dots">
                    <circle cx="6" cy="12" r="2"></circle>
                    <circle cx="12" cy="12" r="2"></circle>
                    <circle cx="18" cy="12" r="2"></circle>
                  </svg>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#grokking" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
              </div>
              <div class="collapsible-header-content-outer">
                <div class="collapsible-header-content" data-references="collapsible-header-grokking-toggle" data-level="2" data-heading-id="grokking">
                  <p dir="auto">
                    See also:
                    <a href="https://www.alignmentforum.org/posts/N6WM6hs7RQMKDhYjB/a-mechanistic-interpretability-analysis-of-grokking" class="external alias">
                      <span class="indicator-hook"></span>
                      writeup
                    </a>
                    ,
                    <a href="https://colab.research.google.com/drive/1F6_1_cWXE5M7WocUcpQWp3v8z4b1jL20" class="external alias">
                      <span class="indicator-hook"></span>
                      code
                    </a>
                    ,
                    <a href="https://transformer-circuits.pub/2022/in-context-learning-and-induction-heads/index.html" class="external alias">
                      <span class="indicator-hook"></span>
                      circuit threads
                    </a>
                  </p>
                  <blockquote>
                    <p dir="auto">
                      A phenomena discovered by
                      <cite class id="citation--power2022grokkinggeneralizationoverfittingsmall--5">
                        (
                        <a href="#bib-power2022grokkinggeneralizationoverfittingsmall" data-no-popover data-bib class="internal alias">
                          <span class="indicator-hook"></span>
                          Power et al., 2022
                        </a>
                        )
                      </cite>
                      where small algorithmic tasks like modular addition will initially memorise training data, but after a long time ti will suddenly learn to generalise to unseen data
                    </p>
                  </blockquote>
                  <blockquote class="callout tip" data-callout="tip">
                    <div class="callout-title" dir="auto">
                      <div class="callout-icon" dir="auto"></div>
                      <div class="callout-title-inner" dir="auto">
                        <p dir="auto">
                          empirical claims
                        </p>
                      </div>
                    </div>
                    <div class="callout-content" dir="auto">
                      <p dir="auto">
                        related to phase change
                      </p>
                    </div>
                  </blockquote>
                </div>
              </div>
            </section>
            <section data-references class="bibliography">
              <h2 id="reference-label" dir="auto">
                References
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reference-label" class="internal">
                  <span class="indicator-hook"></span>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <ul dir="auto">
                <li class="csl-entry" id="bib-dauphin2017languagemodelinggatedconvolutional">
                  Dauphin, Y. N., Fan, A., Auli, M., &amp; Grangier, D. (2017).
                  <i>
                    Language Modeling with Gated Convolutional Networks
                  </i>
                  . arXiv preprint arXiv:1612.08083
                  <a href="https://arxiv.org/abs/1612.08083" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="1612.08083">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-erichson2019jumpreluretrofitdefensestrategy">
                  Erichson, N. B., Yao, Z., &amp; Mahoney, M. W. (2019).
                  <i>
                    JumpReLU: A Retrofit Defense Strategy for Adversarial Attacks
                  </i>
                  . arXiv preprint arXiv:1904.03750
                  <a href="https://arxiv.org/abs/1904.03750" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="1904.03750">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-rajamanoharan2024improvingdictionarylearninggated">
                  Rajamanoharan, S., Conmy, A., Smith, L., Lieberum, T., Varma, V., Kramár, J., Shah, R., &amp; Nanda, N. (2024).
                  <i>
                    Improving Dictionary Learning with Gated Sparse Autoencoders
                  </i>
                  . arXiv preprint arXiv:2404.16014
                  <a href="https://arxiv.org/abs/2404.16014" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2404.16014">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-sharkey2024feature">
                  Sharkey, L. (2024).
                  <i>
                    Addressing Feature Suppression in SAEs
                  </i>
                  . AI Alignment Forum.
                  <a href="https://www.alignmentforum.org/posts/3JuSjTZyMzaSeTxKk/addressing-feature-suppression-in-saes" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                    <span class="indicator-hook"></span>
                    [post]
                  </a>
                </li>
                <li class="csl-entry" id="bib-shazeer2020gluvariantsimprovetransformer">
                  Shazeer, N. (2020).
                  <i>
                    GLU Variants Improve Transformer
                  </i>
                  . arXiv preprint arXiv:2002.05202
                  <a href="https://arxiv.org/abs/2002.05202" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2002.05202">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-gorton2024missingcurvedetectorsinceptionv1">
                  Gorton, L. (2024).
                  <i>
                    The Missing Curve Detectors of InceptionV1: Applying Sparse Autoencoders to InceptionV1 Early Vision
                  </i>
                  . arXiv preprint arXiv:2406.03662
                  <a href="https://arxiv.org/abs/2406.03662" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2406.03662">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-doi:10.1080/09515080050002726">
                  Laakso, A., &amp; Cottrell, G. (2000). Content and cluster analysis: Assessing representational similarity in neural systems.
                  <i>
                    Philosophical Psychology
                  </i>
                  ,
                  <i>
                    13
                  </i>
                  (1), 47–76.
                  <a href="https://doi.org/10.1080/09515080050002726" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                    <span class="indicator-hook"></span>
                    https://doi.org/10.1080/09515080050002726
                  </a>
                </li>
                <li class="csl-entry" id="bib-lindsey2024sparsecrosscoders">
                  Lindsey, J., Templeton, A., Marcus, J., Conerly, T., Batson, J., &amp; Olah, C. (2024). Sparse Crosscoders for Cross-Layer Features and Model Diffing.
                  <i>
                    Transformer Circuits Thread
                  </i>
                  .
                  <a href="https://transformer-circuits.pub/2024/crosscoders/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                    <span class="indicator-hook"></span>
                    [link]
                  </a>
                </li>
                <li class="csl-entry" id="bib-elhage2022superposition">
                  Elhage, N., Hume, T., Olsson, C., Schiefer, N., Henighan, T., Kravec, S., Hatfield-Dodds, Z., Lasenby, R., Drain, D., Chen, C., Grosse, R., McCandlish, S., Kaplan, J., Amodei, D., Wattenberg, M., &amp; Olah, C. (2022). Toy Models of Superposition.
                  <i>
                    Transformer Circuits Thread
                  </i>
                  .
                  <a href="https://transformer-circuits.pub/2022/toy_model/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                    <span class="indicator-hook"></span>
                    [link]
                  </a>
                </li>
                <li class="csl-entry" id="bib-mikolov-etal-2013-linguistic">
                  Mikolov, T., Yih, W., &amp; Zweig, G. (2013). Linguistic Regularities in Continuous Space Word Representations. In L. Vanderwende, H. Daumé III, &amp; K. Kirchhoff (Eds.),
                  <i>
                    Proceedings of the 2013 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
                  </i>
                  (pp. 746–751). Association for Computational Linguistics.
                  <a href="https://aclanthology.org/N13-1090" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                    <span class="indicator-hook"></span>
                    https://aclanthology.org/N13-1090
                  </a>
                </li>
                <li class="csl-entry" id="bib-panickssery2024steeringllama2contrastive">
                  Panickssery, N., Gabrieli, N., Schulz, J., Tong, M., Hubinger, E., &amp; Turner, A. M. (2024).
                  <i>
                    Steering Llama 2 via Contrastive Activation Addition
                  </i>
                  . arXiv preprint arXiv:2312.06681
                  <a href="https://arxiv.org/abs/2312.06681" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2312.06681">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
                <li class="csl-entry" id="bib-power2022grokkinggeneralizationoverfittingsmall">
                  Power, A., Burda, Y., Edwards, H., Babuschkin, I., &amp; Misra, V. (2022).
                  <i>
                    Grokking: Generalization Beyond Overfitting on Small Algorithmic Datasets
                  </i>
                  . arXiv preprint arXiv:2201.02177
                  <a href="https://arxiv.org/abs/2201.02177" target="_blank" rel="noopener noreferrer" class="csl-external-link internal alias" data-arxiv-id="2201.02177">
                    <span class="indicator-hook"></span>
                    arxiv
                  </a>
                </li>
              </ul>
            </section>
            <section data-footnotes class="footnotes">
              <h2 class="sr-only" id="footnote-label" dir="auto">
                Footnotes
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#footnote-label" class="internal">
                  <span class="indicator-hook"></span>
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <ol dir="auto">
                <li id="user-content-fn-lesswrongarc">
                  <p dir="auto">
                    good read from
                    <a href="https://www.lesswrong.com/posts/6FkWnktH3mjMAxdRT/what-i-would-do-if-i-wasn-t-at-arc-evals#Ambitious_mechanistic_interpretability" class="external alias">
                      <span class="indicator-hook"></span>
                      Lawrence C
                    </a>
                    for ambitious mech interp.
                    <a href="#user-content-fnref-lesswrongarc" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-vllm-caveats">
                  <p dir="auto">
                    <a href="https://github.com/vllm-project/vllm/pull/10046" class="external alias">
                      <span class="indicator-hook"></span>
                      the benchmark
                    </a>
                    was run against
                    <code>
                      vllm#0.6.3.dev236+g48138a84
                    </code>
                    , with all configuration specified in the pull request.
                    <a href="#user-content-fnref-vllm-caveats" data-footnote-backref aria-label="Back to reference 2" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-1">
                  <p dir="auto">
                    An example steering function can be:
                  </p>
                  <span class="katex-display">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                          <semantics>
                            <mrow>
                              <msub>
                                <mi>
                                  H
                                </mi>
                                <mn>
                                  3
                                </mn>
                              </msub>
                              <mo>
                                =
                              </mo>
                              <msub>
                                <mi>
                                  H
                                </mi>
                                <mn>
                                  2
                                </mn>
                              </msub>
                              <mo>
                                +
                              </mo>
                              <mtext>
                                steering_strength
                              </mtext>
                              <mo>
                                ∗
                              </mo>
                              <mtext>
                                SAE
                              </mtext>
                              <mi mathvariant="normal">
                                .
                              </mi>
                              <msub>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec
                                </mtext>
                              </msub>
                              <mo stretchy="false">
                                [
                              </mo>
                              <mn>
                                20
                              </mn>
                              <mo stretchy="false">
                                ]
                              </mo>
                              <mo>
                                ∗
                              </mo>
                              <mtext>
                                max_activation
                              </mtext>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              H_{3} = H_{2} + \text{steering\_strength} * \text{SAE}.W_{\text{dec}}[20] * \text{max\_activation}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.08125em;">
                              H
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            3
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            =
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.08125em;">
                              H
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            2
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            +
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span>
                          <span class="mord text">
                            <span class="mord">
                              steering_strength
                            </span>
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            ∗
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord text">
                            <span class="mord">
                              SAE
                            </span>
                          </span>
                          <span class="mord">
                            .
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3361em;">
                                    <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord text mtight">
                                            <span class="mord mtight">
                                              dec
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            [
                          </span>
                          <span class="mord">
                            20
                          </span>
                          <span class="mclose">
                            ]
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                          <span class="mbin">
                            ∗
                          </span>
                          <span class="mspace" style="margin-right:0.2222em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:0.9779em;vertical-align:-0.31em;"></span>
                          <span class="mord text">
                            <span class="mord">
                              max_activation
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  <a href="#user-content-fnref-1" data-footnote-backref aria-label="Back to reference 3" class="data-footnote-backref internal alias">
                    <span class="indicator-hook"></span>
                    ↩
                  </a>
                </li>
                <li id="user-content-fn-shrinkage">
                  <p dir="auto">
                    If we hold
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mover accent="true">
                                <mi>
                                  x
                                </mi>
                                <mo>
                                  ^
                                </mo>
                              </mover>
                              <mo stretchy="false">
                                (
                              </mo>
                              <mo>
                                ∙
                              </mo>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \hat{x}(\bullet)
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord accent">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.6944em;">
                                  <span style="top:-3em;">
                                    <span class="pstrut" style="height:3em;"></span>
                                    <span class="mord mathnormal">
                                      x
                                    </span>
                                  </span>
                                  <span style="top:-3em;">
                                    <span class="pstrut" style="height:3em;"></span>
                                    <span class="accent-body" style="left:-0.2222em;">
                                      <span class="mord">
                                        ^
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            ∙
                          </span>
                          <span class="mclose">
                            )
                          </span>
                        </span>
                      </span>
                    </span>
                    fixed, thus L1 pushes
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                f
                              </mi>
                              <mo stretchy="false">
                                (
                              </mo>
                              <mi>
                                x
                              </mi>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mo>
                                →
                              </mo>
                              <mn>
                                0
                              </mn>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              f(x) \to 0
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="mclose">
                            )
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            →
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:0.6444em;"></span>
                          <span class="mord">
                            0
                          </span>
                        </span>
                      </span>
                    </span>
                    , while reconstruction loss pushes
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                f
                              </mi>
                              <mo stretchy="false">
                                (
                              </mo>
                              <mi>
                                x
                              </mi>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              f(x)
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="mclose">
                            )
                          </span>
                        </span>
                      </span>
                    </span>
                    high enough to produce accurate reconstruction.
                  </p>
                  <p dir="auto">
                    An optimal value is somewhere between.
                  </p>
                  <p dir="auto">
                    However, rescaling the
                    <a href="../thoughts/sparse-autoencoder/../../thoughts/mechanistic-interpretability#feature-suppression" class="internal alias" data-slug="thoughts/mechanistic-interpretability">
                      <span class="indicator-hook"></span>
                      shrink
                    </a>
                    feature activations
                    <cite class id="citation--sharkey2024feature--5">
                      (
                      <a href="#bib-sharkey2024feature" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Sharkey, 2024
                      </a>
                      )
                    </cite>
                    is not necessarily enough to overcome bias induced by L1: a SAE might learnt sub-optimal encoder and decoder directions that is not improved by the fixed.
                    <a href="#user-content-fnref-shrinkage" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-jointlysae">
                  <p dir="auto">
                    <cite class id="citation--gorton2024missingcurvedetectorsinceptionv1--3">
                      (
                      <a href="#bib-gorton2024missingcurvedetectorsinceptionv1" data-no-popover data-bib class="internal alias">
                        <span class="indicator-hook"></span>
                        Gorton, 2024
                      </a>
                      )
                    </cite>
                    denotes that cross-branch superposition is significant in interpreting models with parallel branches (InceptionV1)
                    <a href="#user-content-fnref-jointlysae" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-risks">
                  <p dir="auto">
                    causal description it provides likely differs from that of the underlying model.
                    <a href="#user-content-fnref-risks" data-footnote-backref aria-label="Back to reference 2" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-l2weightnorm">
                  <p dir="auto">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \|W_\text{dec,i}^l\|
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                          <span class="mord">
                            ∥
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                              W
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.8491em;">
                                    <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.063em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                          l
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.4192em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mord">
                            ∥
                          </span>
                        </span>
                      </span>
                    </span>
                    is the L2 norm of a single feature’s decoder vector at a given layer.
                  </p>
                  <p dir="auto">
                    In principe, one might have expected to use L2 norm of per-layer norm
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <msqrt>
                                <mrow>
                                  <msub>
                                    <mo>
                                      ∑
                                    </mo>
                                    <mrow>
                                      <mi>
                                        l
                                      </mi>
                                      <mo>
                                        ∈
                                      </mo>
                                      <mi>
                                        L
                                      </mi>
                                    </mrow>
                                  </msub>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <msubsup>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec,i
                                    </mtext>
                                    <mi>
                                      l
                                    </mi>
                                  </msubsup>
                                  <msup>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mn>
                                      2
                                    </mn>
                                  </msup>
                                </mrow>
                              </msqrt>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \sqrt{\sum_{l \in L} \|W_\text{dec,i}^l\|^2}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:1.84em;vertical-align:-0.6583em;"></span>
                          <span class="mord sqrt">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.1817em;">
                                  <span class="svg-align" style="top:-3.8em;">
                                    <span class="pstrut" style="height:3.8em;"></span>
                                    <span class="mord" style="padding-left:1em;">
                                      <span class="mop">
                                        <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                                          ∑
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.1864em;">
                                                <span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                        l
                                                      </span>
                                                      <span class="mrel mtight">
                                                        ∈
                                                      </span>
                                                      <span class="mord mathnormal mtight">
                                                        L
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.3271em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mspace" style="margin-right:0.1667em;"></span>
                                      <span class="mord">
                                        ∥
                                      </span>
                                      <span class="mord">
                                        <span class="mord mathnormal" style="margin-right:0.13889em;">
                                          W
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.8309em;">
                                                <span style="top:-2.3987em;margin-left:-0.1389em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord text mtight">
                                                      <span class="mord mtight">
                                                        dec,i
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span style="top:-3.0448em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                      l
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.4374em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mord">
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.7401em;">
                                                <span style="top:-2.989em;margin-right:0.05em;">
                                                  <span class="pstrut" style="height:2.7em;"></span>
                                                  <span class="sizing reset-size6 size3 mtight">
                                                    <span class="mord mtight">
                                                      2
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.1417em;">
                                    <span class="pstrut" style="height:3.8em;"></span>
                                    <span class="hide-tail" style="min-width:1.02em;height:1.88em;">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice">
                                        <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path>
                                      </svg>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.6583em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                    <a href="#user-content-fnref-l2weightnorm" data-footnote-backref aria-label="Back to reference 3" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-sne">
                  <p dir="auto">
                    Chris Colah’s
                    <a href="https://colah.github.io/posts/2015-01-Visualizing-Representations/" class="external alias">
                      <span class="indicator-hook"></span>
                      blog post
                    </a>
                    explains how t-SNE can be used to visualize collections of networks in a function space.
                    <a href="#user-content-fnref-sne" data-footnote-backref aria-label="Back to reference 4" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
                <li id="user-content-fn-direction">
                  <p dir="auto">
                    Even though features still correspond to directions, the set of interpretable direction is larger than the number of dimensions
                    <a href="#user-content-fnref-direction" data-footnote-backref aria-label="Back to reference 4" class="data-footnote-backref internal alias">
                      <span class="indicator-hook"></span>
                      ↩
                    </a>
                  </p>
                </li>
              </ol>
            </section>
          </article>
          <div class="page-footer">
            <section data-backlinks="true" class="backlinks">
              <h2 id="backlinks-label">
                Liens retour
                <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#backlinks-label" class="internal">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                  </svg>
                </a>
              </h2>
              <div class="overflow">
                <a href="../" data-backlink="index">
                  <div class="small">
                    Aaron's notes
                  </div>
                  <div class="description">
                    Aaron's digital garden
                  </div>
                </a>
                <a href="../thoughts/Alignment" data-backlink="thoughts/Alignment">
                  <div class="small">
                    Alignment
                  </div>
                  <div class="description">
                    See also: Overton Window and this blog on alignment research The act of aligning oneself with a particular group or ideology. This can be done for a variety of reasons, including: To gain social acceptance To gain power To gain resources Often known as a solution to solve “hallucination” in large models token-generation.
                  </div>
                </a>
                <a href="../thoughts/LLMs" data-backlink="thoughts/LLMs">
                  <div class="small">
                    LLMs
                  </div>
                  <div class="description">
                    large language models, often implemented as autoregressive transformers models. GPTs and friends Most variants of LLMs are decoder-only Have “capabilities” to understand natural language.
                  </div>
                </a>
                <a href="../thoughts/Machine-learning" data-backlink="thoughts/Machine-learning">
                  <div class="small">
                    Machine learning
                  </div>
                  <div class="description">
                    Detects pattern within data and use it to make useful prediction. Generally AI \subset ML \subset DL Some main exploration: Transformers CNN Optimization Gradient descent hyperparameter tuning Recommender systems Reinforcement learning Q-learning Policy Gradient Monte-Carlo Tree Search Generative Models GAN VAE Autoencoder Supervised Q-learning Low-rank adapters Fields mechanistic interpretability Related: linear algebra.
                  </div>
                </a>
                <a href="../thoughts/mechanistic-interpretability" data-backlink="thoughts/mechanistic-interpretability">
                  <div class="small">
                    mechanistic interpretability
                  </div>
                  <div class="description">
                    and reverse engineering neural networks.
                  </div>
                </a>
                <a href="../thoughts/sparse-autoencoder" data-backlink="thoughts/sparse-autoencoder">
                  <div class="small">
                    sparse autoencoder
                  </div>
                  <div class="description">
                    abbrev: SAE see also: landspace Often contains one layers of MLP with few linear ReLU that is trained on a subset of datasets the main LLMs is trained on ...
                  </div>
                </a>
                <a href="../thoughts/sparse-crosscoders" data-backlink="thoughts/sparse-crosscoders">
                  <div class="small">
                    sparse crosscoders
                  </div>
                  <div class="description">
                    and how we observe multiple activation layers. SAE is a special case of sparse crosscoders.
                  </div>
                </a>
                <a href="../thoughts/university/twenty-four-twenty-five/sfwr-4ml3/a3/content" data-backlink="thoughts/university/twenty-four-twenty-five/sfwr-4ml3/a3/content">
                  <div class="small">
                    SVM and Logistic Regression
                  </div>
                  <div class="description">
                    implementation in pure PyTorch
                  </div>
                </a>
                <a href="../thoughts/work" data-backlink="thoughts/work">
                  <div class="small">
                    work.
                  </div>
                  <div class="description">
                    Crafts that I have been brewing for the past while.
                  </div>
                </a>
              </div>
            </section>
            <footer class="minimal-footer">
              <ul class="icons">
                <li>
                  <a href="/" target="_self" aria-label="home">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="home" width="1em" height="1em" fill="currentColor" aria-hidden="true">
                      <path d="M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://github.com/aarnphm" target="_blank" aria-label="github">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="var(--gray)" aria-label="true">
                      <path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://twitter.com/aarnphm_" target="_blank" aria-label="twitter">
                    <svg viewBox="64 64 896 896" focusable="false" data-icon="twitter" width="1em" height="1em" fill="var(--gray)" aria-hidden="true">
                      <path d="M928 254.3c-30.6 13.2-63.9 22.7-98.2 26.4a170.1 170.1 0 0075-94 336.64 336.64 0 01-108.2 41.2A170.1 170.1 0 00672 174c-94.5 0-170.5 76.6-170.5 170.6 0 13.2 1.6 26.4 4.2 39.1-141.5-7.4-267.7-75-351.6-178.5a169.32 169.32 0 00-23.2 86.1c0 59.2 30.1 111.4 76 142.1a172 172 0 01-77.1-21.7v2.1c0 82.9 58.6 151.6 136.7 167.4a180.6 180.6 0 01-44.9 5.8c-11.1 0-21.6-1.1-32.2-2.6C211 652 273.9 701.1 348.8 702.7c-58.6 45.9-132 72.9-211.7 72.9-14.3 0-27.5-.5-41.2-2.1C171.5 822 261.2 850 357.8 850 671.4 850 843 590.2 843 364.7c0-7.4 0-14.8-.5-22.2 33.2-24.3 62.3-54.4 85.5-88.2z"></path>
                    </svg>
                  </a>
                </li>
                <li>
                  <a href="https://bsky.app/profile/aarnphm.xyz" target="_blank" aria-label="bsky">
                    <svg viewBox="0 0 512 512" focusable="false" data-icon="bsky" width="1em" height="1em" aria-hidden="true">
                      <path d="M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2c42.1-31.6 110.3-56 110.3 21.8c0 15.5-8.9 130.5-14.1 149.2C478.2 298 412 314.6 353.1 304.5c102.9 17.5 129.1 75.5 72.5 133.5c-107.4 110.2-154.3-27.6-166.3-62.9l0 0c-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8l0 0c-12 35.3-59 173.1-166.3 62.9c-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1C10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z" fill="#1185fe"></path>
                    </svg>
                  </a>
                </li>
              </ul>
              <p class="info">
                Créé avec
                <a href="https://quartz.jzhao.xyz/" target="_blank" rel="noopener noreferrer" aria-label="Quartz links">
                  Quartz v4.4.0
                </a>
                © 2024
              </p>
            </footer>
          </div>
        </section>
        <section class="right sidebar">
          <div class="graph">
            <div id="global-graph-outer">
              <div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div>
            </div>
          </div>
          <div class="reader" id="reader-view">
            <div class="reader-backdrop"></div>
            <div class="reader-container">
              <div class="reader-header">
                <button class="reader-close" aria-label="Close reader">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div class="reader-content">
                <h1 class="reader-title">
                  mechanistic interpretability
                </h1>
                <p dir="auto">
                  <a href="https://www.youtube.com/watch?v=veT2VI4vHyU&amp;ab_channel=FAR%E2%80%A4AI" class="external alias">
                    <span class="indicator-hook"></span>
                    whirlwind tour
                  </a>
                  ,
                  <a href="../thoughts/pdfs/tinymorph-exploration.pdf" class="internal" data-slug="thoughts/pdfs/tinymorph-exploration.pdf" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    initial exploration
                  </a>
                  ,
                  <a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J" class="external alias">
                    <span class="indicator-hook"></span>
                    glossary
                  </a>
                </p>
                <blockquote>
                  <p dir="auto">
                    The subfield of alignment that delves into reverse engineering of a neural network, especially
                    <a href="../thoughts/LLMs" class="internal" data-slug="thoughts/LLMs" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      LLMs
                    </a>
                  </p>
                </blockquote>
                <p dir="auto">
                  To attack the
                  <em>
                    curse of dimensionality
                  </em>
                  , the question remains:
                  <em>
                    <mark>
                      how do we hope to understand a function over such a large space, without an exponential amount of time?
                    </mark>
                  </em>
                  <sup>
                    <a href="#user-content-fn-lesswrongarc-reader" id="user-content-fnref-lesswrongarc-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      1
                    </a>
                  </sup>
                </p>
                <h2 id="inference-reader" dir="auto">
                  inference
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#inference-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  application in the wild:
                  <a href="https://goodfire.ai/" class="external alias">
                    <span class="indicator-hook"></span>
                    Goodfire
                  </a>
                  and
                  <a href="https://transluce.org/" class="external alias">
                    <span class="indicator-hook"></span>
                    Transluce
                  </a>
                </p>
                <blockquote class="callout" data-callout="question" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        How we would do inference with SAE?
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <blockquote class="twitter-tweet" data-lang="fr">
                      <p lang="en" dir="auto">
                        Quick 🧵 and some of quick introspection into how they might run inference
                        <a href="https://t.co/1N3JrxFHSp" class="external">
                          <span class="indicator-hook"></span>
                          https://t.co/1N3JrxFHSp
                        </a>
                      </p>
                      — aaron (@aarnphm_)
                      <a href="https://twitter.com/aarnphm_/status/1839016131321016380?ref_src=twsrc%5Etfw" class="alias">
                        <span class="indicator-hook"></span>
                        25 septembre 2024
                      </a>
                    </blockquote>
                  </div>
                </blockquote>
                <p dir="auto">
                  idea: treat SAEs as a
                  <code>
                    logit_processor
                  </code>
                  , similar to
                  <a href="../thoughts/vllm#guided-decoding" class="internal" data-slug="thoughts/vllm" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    guided decoding
                  </a>
                </p>
                <p dir="auto">
                  Current known bottleneck in vLLM:
                </p>
                <ul dir="auto">
                  <li>
                    <code>
                      logit_processor
                    </code>
                    are row-wise, or logits are processed synchronously and blocking
                    <sup>
                      <a href="#user-content-fn-vllm-caveats-reader" id="user-content-fnref-vllm-caveats-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        2
                      </a>
                    </sup>
                  </li>
                  <li>
                    no SPMD currently implemented
                  </li>
                </ul>
                <h2 id="steering-reader" dir="auto">
                  steering
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#steering-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  refers to the process of manually modifying certain activations and hidden state of the neural net to influence its
                  outputs
                </p>
                <p dir="auto">
                  For example, the following is a toy example of how a decoder-only transformers (i.e: GPT-2) generate text given the prompt “The weather in California is”
                </p>
                <pre><code class="mermaid" data-clipboard="flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H2] --> C[... hot]">flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H2] --> C[... hot]</code></pre>
                <p dir="auto">
                  To steer to model, we modify
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                H
                              </mi>
                              <mn>
                                2
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            H_2
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.08125em;">
                            H
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        2
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  layers with certain features amplifier with scale 20 (called it
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                H
                              </mi>
                              <mn>
                                3
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            H_{3}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.08125em;">
                            H
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          3
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  )
                  <sup>
                    <a href="#user-content-fn-1-reader" id="user-content-fnref-1-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      3
                    </a>
                  </sup>
                </p>
                <pre><code class="mermaid" data-clipboard="flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H3] --> C[... cold]">flowchart LR
  A[The weather in California is] --> B[H0] --> D[H1] --> E[H3] --> C[... cold]</code></pre>
                <p dir="auto">
                  One usually use techniques such as
                  <a href="../thoughts/mechanistic-interpretability#sparse-autoencoders" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    sparse autoencoders
                  </a>
                  to decompose model activations into a set of
                  interpretable features.
                </p>
                <p dir="auto">
                  For feature
                  <a href="../thoughts/mechanistic-interpretability#ablation" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    ablation
                  </a>
                  , we observe that manipulation of features activation can be strengthened or weakened
                  to directly influence the model’s outputs
                </p>
                <p dir="auto">
                  A few examples where
                  <cite class id="citation--panickssery2024steeringllama2contrastive--1">
                    (
                    <a href="#bib-panickssery2024steeringllama2contrastive-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Panickssery et al., 2024
                    </a>
                    )
                  </cite>
                  uses contrastive activation additions to steer Llama 2
                </p>
                <h3 id="contrastive-activation-additions-reader" dir="auto">
                  contrastive activation additions
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#contrastive-activation-additions-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  intuition: using a contrast pair for steering vector additions at certain activations layers
                </p>
                <p dir="auto">
                  Uses
                  <em>
                    mean difference
                  </em>
                  which produce difference vector similar to PCA:
                </p>
                <p dir="auto">
                  Given a dataset
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi mathvariant="script">
                              D
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \mathcal{D}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6833em;"></span>
                        <span class="mord mathcal" style="margin-right:0.02778em;">
                          D
                        </span>
                      </span>
                    </span>
                  </span>
                  of prompt
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi>
                              p
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            p
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span>
                        <span class="mord mathnormal">
                          p
                        </span>
                      </span>
                    </span>
                  </span>
                  with positive completion
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                c
                              </mi>
                              <mi>
                                p
                              </mi>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            c_p
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            c
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        p
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  and negative completion
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                c
                              </mi>
                              <mi>
                                n
                              </mi>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            c_n
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            c
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        n
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  , we calculate mean-difference
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                v
                              </mi>
                              <mtext>
                                MD
                              </mtext>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            v_\text{MD}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.03588em;">
                            v
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3283em;">
                                  <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          MD
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  at layer
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi>
                              L
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            L
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6833em;"></span>
                        <span class="mord mathnormal">
                          L
                        </span>
                      </span>
                    </span>
                  </span>
                  as follow:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                v
                              </mi>
                              <mtext>
                                MD
                              </mtext>
                            </msub>
                            <mo>
                              =
                            </mo>
                            <mfrac>
                              <mn>
                                1
                              </mn>
                              <mrow>
                                <mo>
                                  ∣
                                </mo>
                                <mi mathvariant="script">
                                  D
                                </mi>
                                <mo>
                                  ∣
                                </mo>
                              </mrow>
                            </mfrac>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  p
                                </mi>
                                <mo separator="true">
                                  ,
                                </mo>
                                <msub>
                                  <mi>
                                    c
                                  </mi>
                                  <mi>
                                    p
                                  </mi>
                                </msub>
                                <mo separator="true">
                                  ,
                                </mo>
                                <msub>
                                  <mi>
                                    c
                                  </mi>
                                  <mi>
                                    n
                                  </mi>
                                </msub>
                                <mo>
                                  ∈
                                </mo>
                                <mi mathvariant="script">
                                  D
                                </mi>
                              </mrow>
                            </munder>
                            <msub>
                              <mi>
                                a
                              </mi>
                              <mi>
                                L
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi>
                              p
                            </mi>
                            <mo separator="true">
                              ,
                            </mo>
                            <msub>
                              <mi>
                                c
                              </mi>
                              <mi>
                                p
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo>
                              −
                            </mo>
                            <msub>
                              <mi>
                                a
                              </mi>
                              <mi>
                                L
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi>
                              p
                            </mi>
                            <mo separator="true">
                              ,
                            </mo>
                            <msub>
                              <mi>
                                c
                              </mi>
                              <mi>
                                n
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            v_\text{MD} = \frac{1}{\mid \mathcal{D} \mid} \sum_{p,c_p,c_n \in \mathcal{D}} a_L(p,c_p) - a_L(p, c_n)
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.03588em;">
                            v
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3283em;">
                                  <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          MD
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.8131em;vertical-align:-1.4917em;"></span>
                        <span class="mord">
                          <span class="mopen nulldelimiter"></span>
                          <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.3214em;">
                                  <span style="top:-2.314em;">
                                    <span class="pstrut" style="height:3em;"></span>
                                    <span class="mord">
                                      <span class="mrel">
                                        ∣
                                      </span>
                                      <span class="mspace" style="margin-right:0.2778em;"></span>
                                      <span class="mord mathcal" style="margin-right:0.02778em;">
                                        D
                                      </span>
                                      <span class="mspace" style="margin-right:0.2778em;"></span>
                                      <span class="mrel">
                                        ∣
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.23em;">
                                    <span class="pstrut" style="height:3em;"></span>
                                    <span class="frac-line" style="border-bottom-width:0.04em;"></span>
                                  </span>
                                  <span style="top:-3.677em;">
                                    <span class="pstrut" style="height:3em;"></span>
                                    <span class="mord">
                                      <span class="mord">
                                        1
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.936em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose nulldelimiter"></span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8557em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight">
                                        p
                                      </span>
                                      <span class="mpunct mtight">
                                        ,
                                      </span>
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                          c
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.1645em;">
                                                <span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;">
                                                  <span class="pstrut" style="height:2.5em;"></span>
                                                  <span class="sizing reset-size3 size1 mtight">
                                                    <span class="mord mathnormal mtight">
                                                      p
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.2819em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mpunct mtight">
                                        ,
                                      </span>
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                          c
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.1645em;">
                                                <span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;">
                                                  <span class="pstrut" style="height:2.5em;"></span>
                                                  <span class="sizing reset-size3 size1 mtight">
                                                    <span class="mord mathnormal mtight">
                                                      n
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.143em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathcal mtight" style="margin-right:0.02778em;">
                                        D
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.4917em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3283em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord mathnormal">
                          p
                        </span>
                        <span class="mpunct">
                          ,
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            c
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        p
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3283em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord mathnormal">
                          p
                        </span>
                        <span class="mpunct">
                          ,
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            c
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        n
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <blockquote class="callout tip" data-callout="tip">
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        implication
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      by steering existing learned representations of behaviors, CAA results in better out-of-distribution generalization than basic supervised finetuning of the entire model.
                    </p>
                  </div>
                </blockquote>
                <h2 id="sparse-autoencoders-reader" dir="auto">
                  sparse autoencoders
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sparse-autoencoders-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto"></p>
                <p dir="auto">
                  abbrev: SAE
                </p>
                <p dir="auto">
                  <em>
                    see also:
                    <a href="https://docs.google.com/document/d/1lHvRXJsbi41bNGZ_znGN7DmlLXITXyWyISan7Qx2y6s/edit?tab=t.0#heading=h.j9b3g3x1o1z4" class="external alias">
                      <span class="indicator-hook"></span>
                      landspace
                    </a>
                  </em>
                </p>
                <p dir="auto">
                  Often contains one layers of MLP with few linear ReLU that is trained on a subset of datasets the main LLMs is trained on.
                </p>
                <blockquote>
                  <p dir="auto">
                    empirical example: if we wish to interpret all features related to the author Camus, we might want to train an SAEs based on all given text of Camus
                    to interpret “similar” features from Llama-3.1
                  </p>
                </blockquote>
                <blockquote class="callout abstract" data-callout="abstract">
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        definition
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      We wish to decompose a models’ activitation
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  x
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <msup>
                                  <mi mathvariant="double-struck">
                                    R
                                  </mi>
                                  <mi>
                                    n
                                  </mi>
                                </msup>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x \in \mathbb{R}^n
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6889em;"></span>
                            <span class="mord">
                              <span class="mord mathbb">
                                R
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.6644em;">
                                      <span style="top:-3.063em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            n
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      into sparse, linear combination of feature directions:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          x
                                        </mi>
                                        <mo>
                                          ∼
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mn>
                                            0
                                          </mn>
                                        </msub>
                                        <mo>
                                          +
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <munderover>
                                          <mo>
                                            ∑
                                          </mo>
                                          <mrow>
                                            <mi>
                                              i
                                            </mi>
                                            <mo>
                                              =
                                            </mo>
                                            <mn>
                                              1
                                            </mn>
                                          </mrow>
                                          <mi>
                                            M
                                          </mi>
                                        </munderover>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mi>
                                            i
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <msub>
                                          <mi>
                                            d
                                          </mi>
                                          <mi>
                                            i
                                          </mi>
                                        </msub>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <mspace width="1em"></mspace>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <msub>
                                          <mi>
                                            d
                                          </mi>
                                          <mi>
                                            i
                                          </mi>
                                        </msub>
                                        <mi>
                                          M
                                        </mi>
                                        <mo>
                                          ≫
                                        </mo>
                                        <mi>
                                          n
                                        </mi>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           latent unit-norm feature direction
                                        </mtext>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mi>
                                            i
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          ≥
                                        </mo>
                                        <mn>
                                          0
                                        </mn>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           corresponding feature activation for
                                        </mtext>
                                        <mi>
                                          x
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                x \sim x_{0} + &amp;\sum_{i=1}^{M} f_i(x) d_i \\[8pt]
                                \because \quad &amp;d_i M \gg n:\text{ latent unit-norm feature direction} \\
                                &amp;f_i(x) \ge 0: \text{ corresponding feature activation for }x
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:6.406em;vertical-align:-2.953em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.453em;">
                                        <span style="top:-5.453em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ∼
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3011em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord mtight">
                                                              0
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              +
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0353em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord">
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:1em;"></span>
                                          </span>
                                        </span>
                                        <span style="top:-1.5353em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.953em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.453em;">
                                        <span style="top:-5.453em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mop op-limits">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.8283em;">
                                                    <span style="top:-1.8723em;margin-left:0em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight">
                                                            i
                                                          </span>
                                                          <span class="mrel mtight">
                                                            =
                                                          </span>
                                                          <span class="mord mtight">
                                                            1
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-3.05em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span>
                                                        <span class="mop op-symbol large-op">
                                                          ∑
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-4.3em;margin-left:0em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.10903em;">
                                                            M
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.2777em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                f
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                d
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0353em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                d
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.10903em;">
                                              M
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ≫
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord mathnormal">
                                              n
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 latent unit-norm feature direction
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.5353em;">
                                          <span class="pstrut" style="height:3.8283em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                f
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ≥
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              0
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 corresponding feature activation for
                                              </span>
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.953em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </div>
                </blockquote>
                <p dir="auto">
                  Thus, the baseline architecture of SAEs is a linear autoencoder with L1 penalty on the activations:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      <mi mathvariant="normal">
                                        ≔
                                      </mi>
                                    </mo>
                                    <mtext>
                                      ReLU
                                    </mtext>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <msub>
                                      <mi>
                                        W
                                      </mi>
                                      <mtext>
                                        enc
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      −
                                    </mo>
                                    <msub>
                                      <mi>
                                        b
                                      </mi>
                                      <mtext>
                                        dec
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo>
                                      +
                                    </mo>
                                    <msub>
                                      <mi>
                                        b
                                      </mi>
                                      <mtext>
                                        enc
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mover accent="true">
                                      <mi>
                                        x
                                      </mi>
                                      <mo>
                                        ^
                                      </mo>
                                    </mover>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      <mi mathvariant="normal">
                                        ≔
                                      </mi>
                                    </mo>
                                    <msub>
                                      <mi>
                                        W
                                      </mi>
                                      <mtext>
                                        dec
                                      </mtext>
                                    </msub>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo>
                                      +
                                    </mo>
                                    <msub>
                                      <mi>
                                        b
                                      </mi>
                                      <mtext>
                                        dec
                                      </mtext>
                                    </msub>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                          </mtable>
                          <annotation encoding="application/x-tex">
                            \begin{aligned}
                            f(x) &amp;\coloneqq \text{ReLU}(W_\text{enc}(x - b_\text{dec}) + b_\text{enc}) \\
                            \hat{x}(f) &amp;\coloneqq W_\text{dec} f(x) + b_\text{dec}
                            \end{aligned}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:3em;vertical-align:-1.25em;"></span>
                        <span class="mord">
                          <span class="mtable">
                            <span class="col-align-r">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.75em;">
                                    <span style="top:-3.91em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-2.41em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord accent">
                                          <span class="vlist-t">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.6944em;">
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                </span>
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="accent-body" style="left:-0.2222em;">
                                                    <span class="mord">
                                                      ^
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.25em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="col-align-l">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.75em;">
                                    <span style="top:-3.91em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          <span class="mrel">
                                            <span class="mop" style="position:relative;top:-0.0347em;">
                                              :
                                            </span>
                                          </span>
                                          <span class="mrel">
                                            <span class="mspace" style="margin-right:-0.0667em;"></span>
                                          </span>
                                          <span class="mrel">
                                            =
                                          </span>
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord text">
                                          <span class="mord">
                                            ReLU
                                          </span>
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord">
                                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                                            W
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.1514em;">
                                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          enc
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          −
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord">
                                          <span class="mord mathnormal">
                                            b
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.3361em;">
                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          dec
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          +
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord">
                                          <span class="mord mathnormal">
                                            b
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.1514em;">
                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          enc
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-2.41em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          <span class="mrel">
                                            <span class="mop" style="position:relative;top:-0.0347em;">
                                              :
                                            </span>
                                          </span>
                                          <span class="mrel">
                                            <span class="mspace" style="margin-right:-0.0667em;"></span>
                                          </span>
                                          <span class="mrel">
                                            =
                                          </span>
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord">
                                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                                            W
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.3361em;">
                                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          dec
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          +
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord">
                                          <span class="mord mathnormal">
                                            b
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.3361em;">
                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          dec
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.25em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <blockquote>
                  <p dir="auto">
                    training it to reconstruct a large dataset of model activations
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                x
                              </mi>
                              <mo>
                                ∼
                              </mo>
                              <mi mathvariant="script">
                                D
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x \sim \mathcal{D}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.4306em;"></span>
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            ∼
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height:0.6833em;"></span>
                          <span class="mord mathcal" style="margin-right:0.02778em;">
                            D
                          </span>
                        </span>
                      </span>
                    </span>
                    , constraining hidden representation
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                f
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              f
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span>
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                        </span>
                      </span>
                    </span>
                    to be sparse
                  </p>
                </blockquote>
                <p dir="auto">
                  <a href="../thoughts/sparse-autoencoder/../../thoughts/university/twenty-four-twenty-five/sfwr-4ml3/tut/tut1#l1norm" class="internal" data-slug="thoughts/university/twenty-four-twenty-five/sfwr-4ml3/tut/tut1" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    L1 norm
                  </a>
                  with coefficient
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi>
                              λ
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \lambda
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6944em;"></span>
                        <span class="mord mathnormal">
                          λ
                        </span>
                      </span>
                    </span>
                  </span>
                  to construct loss during training:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mi mathvariant="script">
                                      L
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      <mi mathvariant="normal">
                                        ≔
                                      </mi>
                                    </mo>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      −
                                    </mo>
                                    <mover accent="true">
                                      <mi>
                                        x
                                      </mi>
                                      <mo>
                                        ^
                                      </mo>
                                    </mover>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <msubsup>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <mn>
                                        2
                                      </mn>
                                      <mn>
                                        2
                                      </mn>
                                    </msubsup>
                                    <mo>
                                      +
                                    </mo>
                                    <mi>
                                      λ
                                    </mi>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <msub>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <mn>
                                        1
                                      </mn>
                                    </msub>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow></mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      ∵
                                    </mo>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      −
                                    </mo>
                                    <mover accent="true">
                                      <mi>
                                        x
                                      </mi>
                                      <mo>
                                        ^
                                      </mo>
                                    </mover>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <msubsup>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <mn>
                                        2
                                      </mn>
                                      <mn>
                                        2
                                      </mn>
                                    </msubsup>
                                    <mo>
                                      :
                                    </mo>
                                    <mtext>
                                       reconstruction loss
                                    </mtext>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                          </mtable>
                          <annotation encoding="application/x-tex">
                            \begin{aligned}
                            \mathcal{L}(x) &amp;\coloneqq \| x-\hat{x}(f(x)) \|_2^2 + \lambda \| f(x) \|_1 \\[8pt]
                            &amp;\because \|x-\hat{x}(f(x)) \|_2^2 : \text{ reconstruction loss}
                            \end{aligned}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:3.8482em;vertical-align:-1.6741em;"></span>
                        <span class="mord">
                          <span class="mtable">
                            <span class="col-align-r">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:2.1741em;">
                                    <span style="top:-4.31em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord mathcal">
                                          L
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-1.9859em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord"></span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.6741em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="col-align-l">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:2.1741em;">
                                    <span style="top:-4.31em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          <span class="mrel">
                                            <span class="mop" style="position:relative;top:-0.0347em;">
                                              :
                                            </span>
                                          </span>
                                          <span class="mrel">
                                            <span class="mspace" style="margin-right:-0.0667em;"></span>
                                          </span>
                                          <span class="mrel">
                                            =
                                          </span>
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          −
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord accent">
                                          <span class="vlist-t">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.6944em;">
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                </span>
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="accent-body" style="left:-0.2222em;">
                                                    <span class="mord">
                                                      ^
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          ))
                                        </span>
                                        <span class="mord">
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.8641em;">
                                                  <span style="top:-2.453em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        2
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span style="top:-3.113em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        2
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.247em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          +
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord mathnormal">
                                          λ
                                        </span>
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                        <span class="mord">
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.3011em;">
                                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        1
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.15em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-1.9859em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel amsrm">
                                          ∵
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          −
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord accent">
                                          <span class="vlist-t">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.6944em;">
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="mord mathnormal">
                                                    x
                                                  </span>
                                                </span>
                                                <span style="top:-3em;">
                                                  <span class="pstrut" style="height:3em;"></span>
                                                  <span class="accent-body" style="left:-0.2222em;">
                                                    <span class="mord">
                                                      ^
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          ))
                                        </span>
                                        <span class="mord">
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t vlist-t2">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.8641em;">
                                                  <span style="top:-2.453em;margin-left:0em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        2
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span style="top:-3.113em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        2
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                                <span class="vlist-s">
                                                  ​
                                                </span>
                                              </span>
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.247em;">
                                                  <span></span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          :
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord text">
                                          <span class="mord">
                                             reconstruction loss
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.6741em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <blockquote class="callout tip" data-callout="tip">
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        intuition
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      We need to reconstruction fidelity at a given sparsity level, as measured by
                      L0 via a mixture of reconstruction fidelity and L1 regularization.
                    </p>
                  </div>
                </blockquote>
                <p dir="auto">
                  We can reduce sparsity loss term without affecting reconstruction by scaling up norm of
                  decoder weights, or constraining norms of columns
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec
                              </mtext>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            W_\text{dec}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3361em;">
                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          dec
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  during training
                </p>
                <p dir="auto">
                  Ideas: output of decoder
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi>
                              f
                            </mi>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi>
                              x
                            </mi>
                            <mo stretchy="false">
                              )
                            </mo>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            f(x)
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                          f
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord mathnormal">
                          x
                        </span>
                        <span class="mclose">
                          )
                        </span>
                      </span>
                    </span>
                  </span>
                  has two roles
                </p>
                <ul dir="auto">
                  <li>
                    detects what features acre active
                    <span>
                      ⇐
                    </span>
                    L1 is crucial to ensure sparsity in decomposition
                  </li>
                  <li>
                    <em>
                      estimates
                    </em>
                    magnitudes of active features
                    <span>
                      ⇐
                    </span>
                    L1 is unwanted bias
                  </li>
                </ul>
                <h3 id="gated-sae-reader" dir="auto">
                  Gated SAE
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#gated-sae-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  <em>
                    uses Pareto improvement over training to reduce L1 penalty
                  </em>
                  <cite class id="citation--rajamanoharan2024improvingdictionarylearninggated--1">
                    (
                    <a href="#bib-rajamanoharan2024improvingdictionarylearninggated-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Rajamanoharan et al., 2024
                    </a>
                    )
                  </cite>
                </p>
                <p dir="auto">
                  Clear consequence of the bias during training is
                  <em>
                    shrinkage
                  </em>
                  <cite class id="citation--sharkey2024feature--2">
                    (
                    <a href="#bib-sharkey2024feature-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Sharkey, 2024
                    </a>
                    )
                  </cite>
                  <sup>
                    <a href="#user-content-fn-shrinkage-reader" id="user-content-fnref-shrinkage-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      4
                    </a>
                  </sup>
                </p>
                <p dir="auto">
                  Idea is to use
                  <a href="../thoughts/sparse-autoencoder/../../thoughts/optimization#gated-linear-units-and-variants" class="internal" data-slug="thoughts/optimization" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    gated ReLU
                  </a>
                  encoder
                  <cite class id="citation--shazeer2020gluvariantsimprovetransformer--dauphin2017languagemodelinggatedconvolutional--3">
                    (
                    <a href="#bib-dauphin2017languagemodelinggatedconvolutional-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Dauphin et al., 2017
                    </a>
                    ;
                    <a href="#bib-shazeer2020gluvariantsimprovetransformer-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Shazeer, 2020
                    </a>
                    )
                  </cite>
                  :
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <mover accent="true">
                              <mi>
                                f
                              </mi>
                              <mo>
                                ~
                              </mo>
                            </mover>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi mathvariant="bold">
                              x
                            </mi>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo>
                              <mi mathvariant="normal">
                                ≔
                              </mi>
                            </mo>
                            <munder>
                              <munder>
                                <mrow>
                                  <mn mathvariant="double-struck">
                                    1
                                  </mn>
                                  <mo stretchy="false">
                                    [
                                  </mo>
                                  <munder>
                                    <munder>
                                      <mrow>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi mathvariant="bold">
                                            W
                                          </mi>
                                          <mtext>
                                            gate
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi mathvariant="bold">
                                          x
                                        </mi>
                                        <mo>
                                          −
                                        </mo>
                                        <msub>
                                          <mi mathvariant="bold">
                                            b
                                          </mi>
                                          <mtext>
                                            dec
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi mathvariant="bold">
                                            b
                                          </mi>
                                          <mtext>
                                            gate
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          >
                                        </mo>
                                        <mn>
                                          0
                                        </mn>
                                      </mrow>
                                      <mo stretchy="true">
                                        ⏟
                                      </mo>
                                    </munder>
                                    <mrow>
                                      <msub>
                                        <mi>
                                          π
                                        </mi>
                                        <mtext>
                                          gate
                                        </mtext>
                                      </msub>
                                      <mo stretchy="false">
                                        (
                                      </mo>
                                      <mi mathvariant="bold">
                                        x
                                      </mi>
                                      <mo stretchy="false">
                                        )
                                      </mo>
                                    </mrow>
                                  </munder>
                                  <mo stretchy="false">
                                    ]
                                  </mo>
                                </mrow>
                                <mo stretchy="true">
                                  ⏟
                                </mo>
                              </munder>
                              <mrow>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mtext>
                                    gate
                                  </mtext>
                                </msub>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi mathvariant="bold">
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                            </munder>
                            <mo>
                              ⊙
                            </mo>
                            <munder>
                              <munder>
                                <mrow>
                                  <mtext>
                                    ReLU
                                  </mtext>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <msub>
                                    <mi mathvariant="bold">
                                      W
                                    </mi>
                                    <mtext>
                                      mag
                                    </mtext>
                                  </msub>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <mi mathvariant="bold">
                                    x
                                  </mi>
                                  <mo>
                                    −
                                  </mo>
                                  <msub>
                                    <mi mathvariant="bold">
                                      b
                                    </mi>
                                    <mtext>
                                      dec
                                    </mtext>
                                  </msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                  <mo>
                                    +
                                  </mo>
                                  <msub>
                                    <mi mathvariant="bold">
                                      b
                                    </mi>
                                    <mtext>
                                      mag
                                    </mtext>
                                  </msub>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mrow>
                                <mo stretchy="true">
                                  ⏟
                                </mo>
                              </munder>
                              <mrow>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mtext>
                                    mag
                                  </mtext>
                                </msub>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi mathvariant="bold">
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                            </munder>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \tilde{f}(\mathbf{x}) \coloneqq \underbrace{\mathbb{1}[\underbrace{(\mathbf{W}_{\text{gate}}(\mathbf{x} - \mathbf{b}_{\text{dec}}) + \mathbf{b}_{\text{gate}}) > 0}_{\pi_{\text{gate}}(\mathbf{x})}]}_{f_{\text{gate}}(\mathbf{x})} \odot \underbrace{\text{ReLU}(\mathbf{W}_{\text{mag}}(\mathbf{x} - \mathbf{b}_{\text{dec}}) + \mathbf{b}_{\text{mag}})}_{f_{\text{mag}}(\mathbf{x})}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1.1813em;vertical-align:-0.25em;"></span>
                        <span class="mord accent">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:0.9313em;">
                                <span style="top:-3em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                    f
                                  </span>
                                </span>
                                <span style="top:-3.6134em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="accent-body" style="left:-0.0833em;">
                                    <span class="mord">
                                      ~
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:0.1944em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord mathbf">
                          x
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          <span class="mrel">
                            <span class="mop" style="position:relative;top:-0.0347em;">
                              :
                            </span>
                          </span>
                          <span class="mrel">
                            <span class="mspace" style="margin-right:-0.0667em;"></span>
                          </span>
                          <span class="mrel">
                            =
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:4.1767em;vertical-align:-3.4267em;"></span>
                        <span class="mord munder">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:0.75em;">
                                <span style="top:0.2294em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.2963em;">
                                                <span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;">
                                                  <span class="pstrut" style="height:2.5em;"></span>
                                                  <span class="sizing reset-size3 size1 mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          gate
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.2819em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mopen mtight">
                                        (
                                      </span>
                                      <span class="mord mathbf mtight">
                                        x
                                      </span>
                                      <span class="mclose mtight">
                                        )
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="mord munder">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.75em;">
                                          <span class="svg-align" style="top:-0.4956em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                              <span class="brace-left" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                  <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                </svg>
                                              </span>
                                              <span class="brace-center" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                  <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                </svg>
                                              </span>
                                              <span class="brace-right" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                  <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                </svg>
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-3em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="mord">
                                              <span class="mord">
                                                1
                                              </span>
                                              <span class="mopen">
                                                [
                                              </span>
                                              <span class="mord munder">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.75em;">
                                                      <span style="top:-1.3409em;">
                                                        <span class="pstrut" style="height:3em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord mathnormal mtight" style="margin-right:0.03588em;">
                                                                π
                                                              </span>
                                                              <span class="msupsub">
                                                                <span class="vlist-t vlist-t2">
                                                                  <span class="vlist-r">
                                                                    <span class="vlist" style="height:0.2963em;">
                                                                      <span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;">
                                                                        <span class="pstrut" style="height:2.5em;"></span>
                                                                        <span class="sizing reset-size3 size1 mtight">
                                                                          <span class="mord mtight">
                                                                            <span class="mord text mtight">
                                                                              <span class="mord mtight">
                                                                                gate
                                                                              </span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                    <span class="vlist-s">
                                                                      ​
                                                                    </span>
                                                                  </span>
                                                                  <span class="vlist-r">
                                                                    <span class="vlist" style="height:0.2819em;">
                                                                      <span></span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                            <span class="mopen mtight">
                                                              (
                                                            </span>
                                                            <span class="mord mathbf mtight">
                                                              x
                                                            </span>
                                                            <span class="mclose mtight">
                                                              )
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3em;">
                                                        <span class="pstrut" style="height:3em;"></span>
                                                        <span class="mord munder">
                                                          <span class="vlist-t vlist-t2">
                                                            <span class="vlist-r">
                                                              <span class="vlist" style="height:0.75em;">
                                                                <span class="svg-align" style="top:-2.0659em;">
                                                                  <span class="pstrut" style="height:3em;"></span>
                                                                  <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                                                    <span class="brace-left" style="height:0.548em;">
                                                                      <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                                        <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                                      </svg>
                                                                    </span>
                                                                    <span class="brace-center" style="height:0.548em;">
                                                                      <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                                        <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                                      </svg>
                                                                    </span>
                                                                    <span class="brace-right" style="height:0.548em;">
                                                                      <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                                        <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                                      </svg>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                                <span style="top:-3em;">
                                                                  <span class="pstrut" style="height:3em;"></span>
                                                                  <span class="mord">
                                                                    <span class="mopen">
                                                                      (
                                                                    </span>
                                                                    <span class="mord">
                                                                      <span class="mord mathbf" style="margin-right:0.01597em;">
                                                                        W
                                                                      </span>
                                                                      <span class="msupsub">
                                                                        <span class="vlist-t vlist-t2">
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.2806em;">
                                                                              <span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;">
                                                                                <span class="pstrut" style="height:2.7em;"></span>
                                                                                <span class="sizing reset-size6 size3 mtight">
                                                                                  <span class="mord mtight">
                                                                                    <span class="mord text mtight">
                                                                                      <span class="mord mtight">
                                                                                        gate
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                            <span class="vlist-s">
                                                                              ​
                                                                            </span>
                                                                          </span>
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.2861em;">
                                                                              <span></span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                    <span class="mopen">
                                                                      (
                                                                    </span>
                                                                    <span class="mord mathbf">
                                                                      x
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                    <span class="mbin">
                                                                      −
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                    <span class="mord">
                                                                      <span class="mord mathbf">
                                                                        b
                                                                      </span>
                                                                      <span class="msupsub">
                                                                        <span class="vlist-t vlist-t2">
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.3361em;">
                                                                              <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                                                <span class="pstrut" style="height:2.7em;"></span>
                                                                                <span class="sizing reset-size6 size3 mtight">
                                                                                  <span class="mord mtight">
                                                                                    <span class="mord text mtight">
                                                                                      <span class="mord mtight">
                                                                                        dec
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                            <span class="vlist-s">
                                                                              ​
                                                                            </span>
                                                                          </span>
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.15em;">
                                                                              <span></span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                    <span class="mclose">
                                                                      )
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                    <span class="mbin">
                                                                      +
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2222em;"></span>
                                                                    <span class="mord">
                                                                      <span class="mord mathbf">
                                                                        b
                                                                      </span>
                                                                      <span class="msupsub">
                                                                        <span class="vlist-t vlist-t2">
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.2806em;">
                                                                              <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                                                <span class="pstrut" style="height:2.7em;"></span>
                                                                                <span class="sizing reset-size6 size3 mtight">
                                                                                  <span class="mord mtight">
                                                                                    <span class="mord text mtight">
                                                                                      <span class="mord mtight">
                                                                                        gate
                                                                                      </span>
                                                                                    </span>
                                                                                  </span>
                                                                                </span>
                                                                              </span>
                                                                            </span>
                                                                            <span class="vlist-s">
                                                                              ​
                                                                            </span>
                                                                          </span>
                                                                          <span class="vlist-r">
                                                                            <span class="vlist" style="height:0.2861em;">
                                                                              <span></span>
                                                                            </span>
                                                                          </span>
                                                                        </span>
                                                                      </span>
                                                                    </span>
                                                                    <span class="mclose">
                                                                      )
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2778em;"></span>
                                                                    <span class="mrel">
                                                                      >
                                                                    </span>
                                                                    <span class="mspace" style="margin-right:0.2778em;"></span>
                                                                    <span class="mord">
                                                                      0
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                              <span class="vlist-s">
                                                                ​
                                                              </span>
                                                            </span>
                                                            <span class="vlist-r">
                                                              <span class="vlist" style="height:0.9341em;">
                                                                <span></span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:1.8564em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                ]
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:2.5044em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:3.4267em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          ⊙
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.6064em;vertical-align:-1.8564em;"></span>
                        <span class="mord munder">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:0.75em;">
                                <span style="top:-1.3409em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.1645em;">
                                                <span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;">
                                                  <span class="pstrut" style="height:2.5em;"></span>
                                                  <span class="sizing reset-size3 size1 mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord mtight">
                                                          mag
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="vlist-s">
                                                ​
                                              </span>
                                            </span>
                                            <span class="vlist-r">
                                              <span class="vlist" style="height:0.2819em;">
                                                <span></span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="mopen mtight">
                                        (
                                      </span>
                                      <span class="mord mathbf mtight">
                                        x
                                      </span>
                                      <span class="mclose mtight">
                                        )
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3em;">
                                  <span class="pstrut" style="height:3em;"></span>
                                  <span class="mord munder">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.75em;">
                                          <span class="svg-align" style="top:-2.0659em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="stretchy" style="height:0.548em;min-width:1.6em;">
                                              <span class="brace-left" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice">
                                                  <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path>
                                                </svg>
                                              </span>
                                              <span class="brace-center" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice">
                                                  <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path>
                                                </svg>
                                              </span>
                                              <span class="brace-right" style="height:0.548em;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice">
                                                  <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path>
                                                </svg>
                                              </span>
                                            </span>
                                          </span>
                                          <span style="top:-3em;">
                                            <span class="pstrut" style="height:3em;"></span>
                                            <span class="mord">
                                              <span class="mord text">
                                                <span class="mord">
                                                  ReLU
                                                </span>
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mord">
                                                <span class="mord mathbf" style="margin-right:0.01597em;">
                                                  W
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.1514em;">
                                                        <span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  mag
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mopen">
                                                (
                                              </span>
                                              <span class="mord mathbf">
                                                x
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mbin">
                                                −
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mord">
                                                <span class="mord mathbf">
                                                  b
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.3361em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  dec
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.15em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mbin">
                                                +
                                              </span>
                                              <span class="mspace" style="margin-right:0.2222em;"></span>
                                              <span class="mord">
                                                <span class="mord mathbf">
                                                  b
                                                </span>
                                                <span class="msupsub">
                                                  <span class="vlist-t vlist-t2">
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.1514em;">
                                                        <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                          <span class="pstrut" style="height:2.7em;"></span>
                                                          <span class="sizing reset-size6 size3 mtight">
                                                            <span class="mord mtight">
                                                              <span class="mord text mtight">
                                                                <span class="mord mtight">
                                                                  mag
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span class="vlist-s">
                                                        ​
                                                      </span>
                                                    </span>
                                                    <span class="vlist-r">
                                                      <span class="vlist" style="height:0.2861em;">
                                                        <span></span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose">
                                                )
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.9341em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.8564em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  where
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mn mathvariant="double-struck">
                              1
                            </mn>
                            <mo stretchy="false">
                              [
                            </mo>
                            <mo>
                              ∙
                            </mo>
                            <mo>
                              >
                            </mo>
                            <mn>
                              0
                            </mn>
                            <mo stretchy="false">
                              ]
                            </mo>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \mathbb{1}[\bullet > 0]
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord">
                          1
                        </span>
                        <span class="mopen">
                          [
                        </span>
                        <span class="mord">
                          ∙
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          >
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord">
                          0
                        </span>
                        <span class="mclose">
                          ]
                        </span>
                      </span>
                    </span>
                  </span>
                  is the (point-wise) Heaviside step function and
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mo>
                              ⊙
                            </mo>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \odot
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                        <span class="mord">
                          ⊙
                        </span>
                      </span>
                    </span>
                  </span>
                  denotes element-wise multiplication.
                </p>
                <div class="table-container">
                  <table>
                    <thead>
                      <tr>
                        <th>
                          term
                        </th>
                        <th>
                          annotations
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mtext>
                                        gate
                                      </mtext>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f_\text{gate}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                    f
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2806em;">
                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  gate
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </td>
                        <td>
                          which features are deemed to be active
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mtext>
                                        mag
                                      </mtext>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f_\text{mag}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                    f
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.1514em;">
                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  mag
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </td>
                        <td>
                          feature activation magnitudes (for features that have been deemed to be active)
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        π
                                      </mi>
                                      <mtext>
                                        gate
                                      </mtext>
                                    </msub>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    \pi_\text{gate}(x)
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.03588em;">
                                    π
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2806em;">
                                          <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  gate
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="mopen">
                                  (
                                </span>
                                <span class="mord mathnormal">
                                  x
                                </span>
                                <span class="mclose">
                                  )
                                </span>
                              </span>
                            </span>
                          </span>
                        </td>
                        <td>
                          <span class="katex">
                            <span class="katex-mathml">
                              <math xmlns="http://www.w3.org/1998/Math/MathML">
                                <semantics>
                                  <mrow>
                                    <msub>
                                      <mi>
                                        f
                                      </mi>
                                      <mtext>
                                        gate
                                      </mtext>
                                    </msub>
                                  </mrow>
                                  <annotation encoding="application/x-tex">
                                    f_\text{gate}
                                  </annotation>
                                </semantics>
                              </math>
                            </span>
                            <span class="katex-html" aria-hidden="true">
                              <span class="base">
                                <span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span>
                                <span class="mord">
                                  <span class="mord mathnormal" style="margin-right:0.10764em;">
                                    f
                                  </span>
                                  <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2806em;">
                                          <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                            <span class="pstrut" style="height:2.7em;"></span>
                                            <span class="sizing reset-size6 size3 mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  gate
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="vlist-s">
                                          ​
                                        </span>
                                      </span>
                                      <span class="vlist-r">
                                        <span class="vlist" style="height:0.2861em;">
                                          <span></span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          sub-layer’s pre-activations
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <p dir="auto">
                  to negate the increases in parameters, use
                  <mark>
                    weight sharing
                  </mark>
                  :
                </p>
                <p dir="auto">
                  Scale
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                mag
                              </mtext>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            W_\text{mag}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          mag
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  in terms of
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                gate
                              </mtext>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            W_\text{gate}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2806em;">
                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          gate
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  with a vector-valued rescaling parameter
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                r
                              </mi>
                              <mtext>
                                mag
                              </mtext>
                            </msub>
                            <mo>
                              ∈
                            </mo>
                            <msup>
                              <mi mathvariant="double-struck">
                                R
                              </mi>
                              <mi>
                                M
                              </mi>
                            </msup>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            r_\text{mag} \in \mathbb{R}^M
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.02778em;">
                            r
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          mag
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          ∈
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:0.8413em;"></span>
                        <span class="mord">
                          <span class="mord mathbb">
                            R
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8413em;">
                                  <span style="top:-3.063em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.10903em;">
                                        M
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  :
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                mag
                              </mtext>
                            </msub>
                            <msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mrow>
                                <mi>
                                  i
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </mrow>
                            </msub>
                            <mo>
                              <mi mathvariant="normal">
                                ≔
                              </mi>
                            </mo>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi>
                              exp
                            </mi>
                            <mo>
                              ⁡
                            </mo>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                r
                              </mi>
                              <mtext>
                                mag
                              </mtext>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo>
                              ⋅
                            </mo>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                gate
                              </mtext>
                            </msub>
                            <msub>
                              <mo stretchy="false">
                                )
                              </mo>
                              <mrow>
                                <mi>
                                  i
                                </mi>
                                <mi>
                                  j
                                </mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            (W_\text{mag})_{ij} \coloneqq (\exp (r_\text{mag}))_i \cdot (W_\text{gate})_{ij}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          mag
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          <span class="mclose">
                            )
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          ij
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          <span class="mrel">
                            <span class="mop" style="position:relative;top:-0.0347em;">
                              :
                            </span>
                          </span>
                          <span class="mrel">
                            <span class="mspace" style="margin-right:-0.0667em;"></span>
                          </span>
                          <span class="mrel">
                            =
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mop">
                          exp
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.02778em;">
                            r
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.1514em;">
                                  <span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          mag
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mclose">
                          <span class="mclose">
                            )
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          ⋅
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2806em;">
                                  <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          gate
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          <span class="mclose">
                            )
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                          ij
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  <img src="../thoughts/sparse-autoencoder/../../thoughts/images/gated-sae-architecture.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  <em>
                    Figure 3: Gated SAE with weight sharing between gating and magnitude paths
                  </em>
                </p>
                <p dir="auto">
                  <img src="../thoughts/sparse-autoencoder/../../thoughts/images/gated_jump_relu.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  <em>
                    Figure 4: A gated encoder become a single layer linear encoder with
                    <a href="../thoughts/sparse-autoencoder/../../thoughts/optimization#jumprelu" class="internal" data-slug="thoughts/optimization" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      JumpReLU
                    </a>
                  </em>
                  <cite class id="citation--erichson2019jumpreluretrofitdefensestrategy--4">
                    (
                    <a href="#bib-erichson2019jumpreluretrofitdefensestrategy-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Erichson et al., 2019
                    </a>
                    )
                  </cite>
                  <em>
                    activation function
                  </em>
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                σ
                              </mi>
                              <mi>
                                θ
                              </mi>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \sigma_\theta
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.03588em;">
                            σ
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3361em;">
                                  <span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.02778em;">
                                        θ
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </p>
                <h3 id="feature-suppression-reader" dir="auto">
                  feature suppression
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#feature-suppression-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  See also:
                  <a href="https://www.alignmentforum.org/posts/3JuSjTZyMzaSeTxKk/addressing-feature-suppression-in-saes" class="external alias">
                    <span class="indicator-hook"></span>
                    link
                  </a>
                </p>
                <p dir="auto">
                  Loss function of SAEs combines a MSE reconstruction loss with sparsity term:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mi>
                                      L
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo separator="true">
                                      ,
                                    </mo>
                                    <mi>
                                      y
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      =
                                    </mo>
                                    <mi mathvariant="normal">
                                      ∥
                                    </mi>
                                    <mi>
                                      y
                                    </mi>
                                    <mo>
                                      −
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <msup>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <mn>
                                        2
                                      </mn>
                                    </msup>
                                    <mi mathvariant="normal">
                                      /
                                    </mi>
                                    <mi>
                                      d
                                    </mi>
                                    <mo>
                                      +
                                    </mo>
                                    <mi>
                                      c
                                    </mi>
                                    <mo>
                                      ∣
                                    </mo>
                                    <mi>
                                      f
                                    </mi>
                                    <mo stretchy="false">
                                      (
                                    </mo>
                                    <mi>
                                      x
                                    </mi>
                                    <mo stretchy="false">
                                      )
                                    </mo>
                                    <mo>
                                      ∣
                                    </mo>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                            <mtr>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow></mrow>
                                </mstyle>
                              </mtd>
                              <mtd>
                                <mstyle scriptlevel="0" displaystyle="true">
                                  <mrow>
                                    <mrow></mrow>
                                    <mo>
                                      ∵
                                    </mo>
                                    <mi>
                                      d
                                    </mi>
                                    <mo>
                                      :
                                    </mo>
                                    <mtext>
                                       dimensionality of
                                    </mtext>
                                    <mi>
                                      x
                                    </mi>
                                  </mrow>
                                </mstyle>
                              </mtd>
                            </mtr>
                          </mtable>
                          <annotation encoding="application/x-tex">
                            \begin{aligned}
                            L(x, f(x), y) &amp;= \|y-x\|^2/d + c\mid f(x) \mid \\[8pt]
                            &amp;\because d: \text{ dimensionality of }x
                            \end{aligned}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:3.8241em;vertical-align:-1.6621em;"></span>
                        <span class="mord">
                          <span class="mtable">
                            <span class="col-align-r">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:2.1621em;">
                                    <span style="top:-4.2979em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord mathnormal">
                                          L
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mpunct">
                                          ,
                                        </span>
                                        <span class="mspace" style="margin-right:0.1667em;"></span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                        <span class="mpunct">
                                          ,
                                        </span>
                                        <span class="mspace" style="margin-right:0.1667em;"></span>
                                        <span class="mord mathnormal" style="margin-right:0.03588em;">
                                          y
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-1.9979em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord"></span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.6621em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="col-align-l">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:2.1621em;">
                                    <span style="top:-4.2979em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          =
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord">
                                          ∥
                                        </span>
                                        <span class="mord mathnormal" style="margin-right:0.03588em;">
                                          y
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          −
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mord">
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:0.8641em;">
                                                  <span style="top:-3.113em;margin-right:0.05em;">
                                                    <span class="pstrut" style="height:2.7em;"></span>
                                                    <span class="sizing reset-size6 size3 mtight">
                                                      <span class="mord mtight">
                                                        2
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span class="mord">
                                          /
                                        </span>
                                        <span class="mord mathnormal">
                                          d
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mbin">
                                          +
                                        </span>
                                        <span class="mspace" style="margin-right:0.2222em;"></span>
                                        <span class="mord mathnormal">
                                          c
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          ∣
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord mathnormal" style="margin-right:0.10764em;">
                                          f
                                        </span>
                                        <span class="mopen">
                                          (
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                        <span class="mclose">
                                          )
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          ∣
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-1.9979em;">
                                      <span class="pstrut" style="height:3em;"></span>
                                      <span class="mord">
                                        <span class="mord"></span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel amsrm">
                                          ∵
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord mathnormal">
                                          d
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mrel">
                                          :
                                        </span>
                                        <span class="mspace" style="margin-right:0.2778em;"></span>
                                        <span class="mord text">
                                          <span class="mord">
                                             dimensionality of
                                          </span>
                                        </span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.6621em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <blockquote>
                  <p dir="auto">
                    the reconstruction is not perfect, given that only one is reconstruction.
                    <strong>
                      For smaller value of
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  f
                                </mi>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                f(x)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      , features will be suppressed
                    </strong>
                  </p>
                </blockquote>
                <blockquote class="callout" data-callout="note" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        illustrated example
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      consider one binary feature in one dimension
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  x
                                </mi>
                                <mo>
                                  =
                                </mo>
                                <mn>
                                  1
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x=1
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              1
                            </span>
                          </span>
                        </span>
                      </span>
                      with probability
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  p
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                p
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span>
                            <span class="mord mathnormal">
                              p
                            </span>
                          </span>
                        </span>
                      </span>
                      and
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  x
                                </mi>
                                <mo>
                                  =
                                </mo>
                                <mn>
                                  0
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x=0
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              0
                            </span>
                          </span>
                        </span>
                      </span>
                      otherwise. Ideally, optimal SAE would extract feature activation of
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  f
                                </mi>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mo>
                                  ∈
                                </mo>
                                <mo stretchy="false">
                                  {
                                </mo>
                                <mn>
                                  0
                                </mn>
                                <mo separator="true">
                                  ,
                                </mo>
                                <mn>
                                  1
                                </mn>
                                <mo stretchy="false">
                                  }
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                f(x) \in \{0,1\}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mopen">
                              {
                            </span>
                            <span class="mord">
                              0
                            </span>
                            <span class="mpunct">
                              ,
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord">
                              1
                            </span>
                            <span class="mclose">
                              }
                            </span>
                          </span>
                        </span>
                      </span>
                      and have decoder
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    W
                                  </mi>
                                  <mi>
                                    d
                                  </mi>
                                </msub>
                                <mo>
                                  =
                                </mo>
                                <mn>
                                  1
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                W_d=1
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                W
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3361em;">
                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight">
                                            d
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.15em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              1
                            </span>
                          </span>
                        </span>
                      </span>
                    </p>
                    <p dir="auto">
                      However, if we train SAE optimizing loss function
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  L
                                </mi>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  x
                                </mi>
                                <mo separator="true">
                                  ,
                                </mo>
                                <mi>
                                  f
                                </mi>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <mi>
                                  x
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                                <mo separator="true">
                                  ,
                                </mo>
                                <mi>
                                  y
                                </mi>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                L(x, f(x), y)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                            <span class="mord mathnormal">
                              L
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mpunct">
                              ,
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                              f
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mclose">
                              )
                            </span>
                            <span class="mpunct">
                              ,
                            </span>
                            <span class="mspace" style="margin-right:0.1667em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.03588em;">
                              y
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      , let say encoder outputs feature activation
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  a
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                a
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              a
                            </span>
                          </span>
                        </span>
                      </span>
                      if
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  x
                                </mi>
                                <mo>
                                  =
                                </mo>
                                <mn>
                                  1
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x=1
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              =
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              1
                            </span>
                          </span>
                        </span>
                      </span>
                      and 0 otherwise, ignore bias term, the optimization problem becomes:
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mrow>
                                <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>
                                          a
                                        </mi>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            =
                                          </mo>
                                          <mo>
                                            <mi mathvariant="normal">
                                              arg min
                                            </mi>
                                            <mo>
                                              ⁡
                                            </mo>
                                          </mo>
                                          <mi>
                                            p
                                          </mi>
                                          <mo>
                                            ∗
                                          </mo>
                                          <mi>
                                            L
                                          </mi>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mn>
                                            1
                                          </mn>
                                          <mo separator="true">
                                            ,
                                          </mo>
                                          <mi>
                                            a
                                          </mi>
                                          <mo separator="true">
                                            ,
                                          </mo>
                                          <mi>
                                            a
                                          </mi>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                          <mo>
                                            +
                                          </mo>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mn>
                                            1
                                          </mn>
                                          <mo>
                                            −
                                          </mo>
                                          <mi>
                                            p
                                          </mi>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                          <mo>
                                            ∗
                                          </mo>
                                          <mi>
                                            L
                                          </mi>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mn>
                                            0
                                          </mn>
                                          <mo separator="true">
                                            ,
                                          </mo>
                                          <mn>
                                            0
                                          </mn>
                                          <mo separator="true">
                                            ,
                                          </mo>
                                          <mn>
                                            0
                                          </mn>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow></mrow>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            =
                                          </mo>
                                          <mo>
                                            <mi mathvariant="normal">
                                              arg min
                                            </mi>
                                            <mo>
                                              ⁡
                                            </mo>
                                          </mo>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mn>
                                            1
                                          </mn>
                                          <mo>
                                            −
                                          </mo>
                                          <mi>
                                            a
                                          </mi>
                                          <msup>
                                            <mo stretchy="false">
                                              )
                                            </mo>
                                            <mn>
                                              2
                                            </mn>
                                          </msup>
                                          <mo>
                                            +
                                          </mo>
                                          <mo>
                                            ∣
                                          </mo>
                                          <mi>
                                            a
                                          </mi>
                                          <mo>
                                            ∣
                                          </mo>
                                          <mo>
                                            ∗
                                          </mo>
                                          <mi>
                                            c
                                          </mi>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                  <mtr>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow></mrow>
                                      </mstyle>
                                    </mtd>
                                    <mtd>
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mrow></mrow>
                                          <mo>
                                            =
                                          </mo>
                                          <mo>
                                            <mi mathvariant="normal">
                                              arg min
                                            </mi>
                                            <mo>
                                              ⁡
                                            </mo>
                                          </mo>
                                          <msup>
                                            <mi>
                                              a
                                            </mi>
                                            <mn>
                                              2
                                            </mn>
                                          </msup>
                                          <mo>
                                            +
                                          </mo>
                                          <mo stretchy="false">
                                            (
                                          </mo>
                                          <mi>
                                            c
                                          </mi>
                                          <mo>
                                            −
                                          </mo>
                                          <mn>
                                            2
                                          </mn>
                                          <mo stretchy="false">
                                            )
                                          </mo>
                                          <mo>
                                            ∗
                                          </mo>
                                          <mi>
                                            a
                                          </mi>
                                          <mo>
                                            +
                                          </mo>
                                          <mn>
                                            1
                                          </mn>
                                        </mrow>
                                      </mstyle>
                                    </mtd>
                                  </mtr>
                                </mtable>
                                <mo>
                                  ⟹
                                </mo>
                                <menclose notation="box">
                                  <mstyle scriptlevel="0" displaystyle="false">
                                    <mstyle scriptlevel="0" displaystyle="false">
                                      <mstyle scriptlevel="0" displaystyle="true">
                                        <mrow>
                                          <mi>
                                            a
                                          </mi>
                                          <mo>
                                            =
                                          </mo>
                                          <mn>
                                            1
                                          </mn>
                                          <mo>
                                            −
                                          </mo>
                                          <mfrac>
                                            <mi>
                                              c
                                            </mi>
                                            <mn>
                                              2
                                            </mn>
                                          </mfrac>
                                        </mrow>
                                      </mstyle>
                                    </mstyle>
                                  </mstyle>
                                </menclose>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                a &amp;= \argmin p * L(1,a,a) + (1-p) * L(0,0,0) \\
                                &amp;= \argmin (1-a)^2 + \mid a \mid * c  \\
                                &amp;= \argmin a^2 + (c-2) *a +1
                                \end{aligned}
                                \Longrightarrow \boxed{a = 1-\frac{c}{2}}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:4.5482em;vertical-align:-2.0241em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.5241em;">
                                        <span style="top:-4.6841em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.16em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                        <span style="top:-1.6359em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.0241em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.5241em;">
                                        <span style="top:-4.6841em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mop">
                                              <span class="mop">
                                                <span class="mord mathrm" style="margin-right:0.01389em;">
                                                  arg
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathrm">
                                                  min
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord mathnormal">
                                              p
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              ∗
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              L
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              1
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              1
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              p
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              ∗
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              L
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              0
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              0
                                            </span>
                                            <span class="mpunct">
                                              ,
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              0
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.16em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mop">
                                              <span class="mop">
                                                <span class="mord mathrm" style="margin-right:0.01389em;">
                                                  arg
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathrm">
                                                  min
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              1
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mclose">
                                              <span class="mclose">
                                                )
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8641em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ∣
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              ∣
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              ∗
                                            </span>
                                            <span class="mord mathnormal">
                                              c
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.6359em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mop">
                                              <span class="mop">
                                                <span class="mord mathrm" style="margin-right:0.01389em;">
                                                  arg
                                                </span>
                                                <span class="mspace" style="margin-right:0.1667em;"></span>
                                                <span class="mord mathrm">
                                                  min
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                a
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8641em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              c
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              2
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              ∗
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              1
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.0241em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ⟹
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:2.4736em;vertical-align:-1.026em;"></span>
                            <span class="mord">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.4476em;">
                                    <span style="top:-4.4736em;">
                                      <span class="pstrut" style="height:4.4736em;"></span>
                                      <span class="boxpad">
                                        <span class="mord">
                                          <span class="mord">
                                            <span class="mord mathnormal">
                                              a
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              1
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              −
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mopen nulldelimiter"></span>
                                              <span class="mfrac">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:1.1076em;">
                                                      <span style="top:-2.314em;">
                                                        <span class="pstrut" style="height:3em;"></span>
                                                        <span class="mord">
                                                          <span class="mord">
                                                            2
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.23em;">
                                                        <span class="pstrut" style="height:3em;"></span>
                                                        <span class="frac-line" style="border-bottom-width:0.04em;"></span>
                                                      </span>
                                                      <span style="top:-3.677em;">
                                                        <span class="pstrut" style="height:3em;"></span>
                                                        <span class="mord">
                                                          <span class="mord mathnormal">
                                                            c
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.686em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                              <span class="mclose nulldelimiter"></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top:-3.4476em;">
                                      <span class="pstrut" style="height:4.4736em;"></span>
                                      <span class="stretchy fbox" style="height:2.4736em;border-style:solid;border-width:0.04em;"></span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:1.026em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </div>
                </blockquote>
                <blockquote class="callout" data-callout="question" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        How do we fix feature suppression in training SAEs?
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      introduce element-wise scaling factor per feature in-between encoder and decoder, represented by vector
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  s
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                s
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              s
                            </span>
                          </span>
                        </span>
                      </span>
                      :
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <mtext>
                                          ReLU
                                        </mtext>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            W
                                          </mi>
                                          <mi>
                                            e
                                          </mi>
                                        </msub>
                                        <mi>
                                          x
                                        </mi>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mi>
                                            e
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mi>
                                            s
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <mi>
                                          s
                                        </mi>
                                        <mo>
                                          ⊙
                                        </mo>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mi>
                                        y
                                      </mi>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <msub>
                                          <mi>
                                            W
                                          </mi>
                                          <mi>
                                            d
                                          </mi>
                                        </msub>
                                        <msub>
                                          <mi>
                                            f
                                          </mi>
                                          <mi>
                                            s
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <mi>
                                          x
                                        </mi>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mi>
                                            d
                                          </mi>
                                        </msub>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                f(x) &amp;= \text{ReLU}(W_e x + b_e) \\
                                f_s(x) &amp;= s \odot f(x) \\
                                y &amp;= W_d f_s(x) + b_d
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:4.5em;vertical-align:-2em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.5em;">
                                        <span style="top:-4.66em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.16em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                f
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            s
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.66em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.03588em;">
                                              y
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2.5em;">
                                        <span style="top:-4.66em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                ReLU
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            e
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            e
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.16em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord mathnormal">
                                              s
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              ⊙
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-1.66em;">
                                          <span class="pstrut" style="height:3em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3361em;">
                                                      <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            d
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                                f
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            s
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord mathnormal">
                                              x
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3361em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight">
                                                            d
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:2em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </div>
                </blockquote>
                <p dir="auto"></p>
                <h2 id="sparse-crosscoders-reader" dir="auto">
                  sparse crosscoders
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sparse-crosscoders-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto"></p>
                <blockquote class="callout tip" data-callout="tip">
                  <div class="callout-title" dir="auto">
                    <div class="callout-icon" dir="auto"></div>
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        maturity
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      a research preview from Anthroppic and this is pretty much still a work in progress
                    </p>
                  </div>
                </blockquote>
                <p dir="auto">
                  see also
                  <a href="https://colab.research.google.com/drive/124ODki4dUjfi21nuZPHRySALx9I74YHj?usp=sharing" class="external alias">
                    <span class="indicator-hook"></span>
                    reproduction on Gemma 2B
                  </a>
                  and
                  <a href="https://github.com/ckkissane/crosscoder-model-diff-replication" class="external alias">
                    <span class="indicator-hook"></span>
                    github
                  </a>
                </p>
                <p dir="auto">
                  A variant of
                  <a href="../thoughts/sparse-crosscoders/../../thoughts/sparse-autoencoder" class="internal" data-slug="thoughts/sparse-autoencoder" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    sparse autoencoder
                  </a>
                  where it reads and writes to multiple layers
                  <cite class id="citation--lindsey2024sparsecrosscoders--1">
                    (
                    <a href="#bib-lindsey2024sparsecrosscoders-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Lindsey et al., 2024
                    </a>
                    )
                  </cite>
                </p>
                <p dir="auto">
                  Crosscoders produces
                  <mark>
                    shared features across layers and even models
                  </mark>
                </p>
                <h2 id="motivations-reader" dir="auto">
                  motivations
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#motivations-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  Resolve:
                </p>
                <ul dir="auto">
                  <li>
                    <p dir="auto">
                      cross-layer features: resolve cross-layer superposition
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      circuit simplification: remove redundant features from analysis and enable jumping across training many uninteresting identity circuit connections
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      model diffing: produce shared sets of features across models. This also introduce one model across training, and also completely independent models with different architectures.
                    </p>
                  </li>
                </ul>
                <h3 id="cross-layer-superposition-reader" dir="auto">
                  cross-layer
                  <a href="../thoughts/sparse-crosscoders/../../thoughts/mechanistic-interpretability#superposition-hypothesis" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    superposition
                  </a>
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cross-layer-superposition-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  <img src="../thoughts/sparse-crosscoders/../../thoughts/images/additive-residual-stream-llm.webp" width="auto" height="auto" alt loading="lazy"/>
                  <em>
                    given the additive properties of transformers’ residual stream,
                    <strong>
                      adjacent layers
                    </strong>
                    in larger transformers can be thought as “almost parallel”
                  </em>
                </p>
                <blockquote class="callout" data-callout="tip" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        intuition
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      In basis of superposition hypothesis, a feature is a linear combinations of neurons at any given layers.
                    </p>
                    <p dir="auto">
                      <img src="../thoughts/sparse-crosscoders/../../thoughts/images/feature-neurons.webp" width="auto" height="auto" alt loading="lazy"/>
                    </p>
                  </div>
                </blockquote>
                <p dir="auto">
                  <img src="../thoughts/sparse-crosscoders/../../thoughts/images/one-step-circuit.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  <img src="../thoughts/sparse-crosscoders/../../thoughts/images/parallel-joint-branch.webp" width="auto" height="auto" alt loading="lazy"/>
                  <em>
                    if we think of adjacent layers as being “almost parallel branches that potentially have superposition between them”, then we can apply dictionary learning jointly
                    <sup>
                      <a href="#user-content-fn-jointlysae-reader" id="user-content-fnref-jointlysae-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        5
                      </a>
                    </sup>
                  </em>
                </p>
                <h3 id="persistent-features-and-complexity-reader" dir="auto">
                  persistent features and complexity
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#persistent-features-and-complexity-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  Current drawbacks of sparse autoencoders is that we have to train it against certain activations layers to extract features. In terms of the residual
                  stream per layers, we end up having lots of duplicate features across layers.
                </p>
                <blockquote>
                  <p dir="auto">
                    Crosscoders can simplify the circuit
                    <em>
                      given that we use an appropriate architecture
                    </em>
                    <sup>
                      <a href="#user-content-fn-risks-reader" id="user-content-fnref-risks-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        6
                      </a>
                    </sup>
                  </p>
                </blockquote>
                <h2 id="setup-reader" dir="auto">
                  setup.
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#setup-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    Autoencoders and transcoders as special cases of crosscoders.
                  </p>
                  <ul dir="auto">
                    <li>
                      autoencoders: reads and predict the same layers
                    </li>
                    <li>
                      transcoders: read from layer
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                          </span>
                        </span>
                      </span>
                      and predict layer
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                                <mo>
                                  +
                                </mo>
                                <mn>
                                  1
                                </mn>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n+1
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                            <span class="mbin">
                              +
                            </span>
                            <span class="mspace" style="margin-right:0.2222em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6444em;"></span>
                            <span class="mord">
                              1
                            </span>
                          </span>
                        </span>
                      </span>
                    </li>
                  </ul>
                </blockquote>
                <p dir="auto">
                  Crosscoder read/write to many layers, subject to causality constraints.
                </p>
                <blockquote class="callout" data-callout="math" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        crosscoders
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      Let one compute the vector of feature activation
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    f
                                  </mi>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                </msub>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                f_(x_j)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3448em;">
                                      <span style="top:-2.5198em;margin-left:-0.1076em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mopen mtight">
                                            (
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3552em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      on data point
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                x_j
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      by summing over contributions of activations of different layers
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <msup>
                                  <mi>
                                    a
                                  </mi>
                                  <mi>
                                    l
                                  </mi>
                                </msup>
                                <mo stretchy="false">
                                  (
                                </mo>
                                <msub>
                                  <mi>
                                    x
                                  </mi>
                                  <mi>
                                    j
                                  </mi>
                                </msub>
                                <mo stretchy="false">
                                  )
                                </mo>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                a^l(x_j)
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:1.1352em;vertical-align:-0.2861em;"></span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                a
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.8491em;">
                                      <span style="top:-3.063em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mopen">
                              (
                            </span>
                            <span class="mord">
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.3117em;">
                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                        <span class="pstrut" style="height:2.7em;"></span>
                                        <span class="sizing reset-size6 size3 mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                            j
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.2861em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose">
                              )
                            </span>
                          </span>
                        </span>
                      </span>
                      for layers
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                l \in L
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span>
                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                              l
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                            <span class="mrel">
                              ∈
                            </span>
                            <span class="mspace" style="margin-right:0.2778em;"></span>
                          </span>
                          <span class="base">
                            <span class="strut" style="height:0.6833em;"></span>
                            <span class="mord mathnormal">
                              L
                            </span>
                          </span>
                        </span>
                      </span>
                      :
                    </p>
                    <span class="katex-display">
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                            <semantics>
                              <mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mi>
                                          f
                                        </mi>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          =
                                        </mo>
                                        <mtext>
                                          ReLU
                                        </mtext>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <munder>
                                          <mo>
                                            ∑
                                          </mo>
                                          <mrow>
                                            <mi>
                                              l
                                            </mi>
                                            <mo>
                                              ∈
                                            </mo>
                                            <mi>
                                              L
                                            </mi>
                                          </mrow>
                                        </munder>
                                        <msubsup>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </msubsup>
                                        <msup>
                                          <mi>
                                            a
                                          </mi>
                                          <mi>
                                            l
                                          </mi>
                                        </msup>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          +
                                        </mo>
                                        <msub>
                                          <mi>
                                            b
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <msubsup>
                                          <mi>
                                            W
                                          </mi>
                                          <mtext>
                                            enc
                                          </mtext>
                                          <mi>
                                            l
                                          </mi>
                                        </msubsup>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           encoder weights at layer
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow></mrow>
                                    </mstyle>
                                  </mtd>
                                  <mtd>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                      <mrow>
                                        <mrow></mrow>
                                        <mo>
                                          ∵
                                        </mo>
                                        <msup>
                                          <mi>
                                            a
                                          </mi>
                                          <mi>
                                            l
                                          </mi>
                                        </msup>
                                        <mo stretchy="false">
                                          (
                                        </mo>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mo stretchy="false">
                                          )
                                        </mo>
                                        <mo>
                                          :
                                        </mo>
                                        <mtext>
                                           activation on datapoint
                                        </mtext>
                                        <msub>
                                          <mi>
                                            x
                                          </mi>
                                          <mi>
                                            j
                                          </mi>
                                        </msub>
                                        <mtext>
                                           at layer
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </mrow>
                                    </mstyle>
                                  </mtd>
                                </mtr>
                              </mtable>
                              <annotation encoding="application/x-tex">
                                \begin{aligned}
                                f(x_j) &amp;= \text{ReLU}(\sum_{l\in L}W_{\text{enc}}^l a^l(x_j) + b_{\text{enc}}) \\[8pt]
                                &amp;\because W^l_{\text{enc}} : \text{ encoder weights at layer } l \\[8pt]
                                &amp;\because a^l(x_j) : \text{ activation on datapoint } x_j \text{ at layer } l \\
                                \end{aligned}
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:6.5977em;vertical-align:-3.0489em;"></span>
                            <span class="mord">
                              <span class="mtable">
                                <span class="col-align-r">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.5489em;">
                                        <span style="top:-5.5489em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.10764em;">
                                              f
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0203em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                        <span style="top:-0.6612em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord"></span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.0489em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="col-align-l">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.5489em;">
                                        <span style="top:-5.5489em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              =
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                ReLU
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mop op-limits">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.05em;">
                                                    <span style="top:-1.8479em;margin-left:0em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                          <span class="mrel mtight">
                                                            ∈
                                                          </span>
                                                          <span class="mord mathnormal mtight">
                                                            L
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-3.05em;">
                                                      <span class="pstrut" style="height:3.05em;"></span>
                                                      <span>
                                                        <span class="mop op-symbol large-op">
                                                          ∑
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:1.3295em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.1667em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                a
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mbin">
                                              +
                                            </span>
                                            <span class="mspace" style="margin-right:0.2222em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                b
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.1514em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.15em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.0203em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal" style="margin-right:0.13889em;">
                                                W
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mtight">
                                                            <span class="mord text mtight">
                                                              <span class="mord mtight">
                                                                enc
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.247em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 encoder weights at layer
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-0.6612em;">
                                          <span class="pstrut" style="height:3.05em;"></span>
                                          <span class="mord">
                                            <span class="mord"></span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel amsrm">
                                              ∵
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                a
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.8991em;">
                                                      <span style="top:-3.113em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mopen">
                                              (
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mclose">
                                              )
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mrel">
                                              :
                                            </span>
                                            <span class="mspace" style="margin-right:0.2778em;"></span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 activation on datapoint
                                              </span>
                                            </span>
                                            <span class="mord">
                                              <span class="mord mathnormal">
                                                x
                                              </span>
                                              <span class="msupsub">
                                                <span class="vlist-t vlist-t2">
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.3117em;">
                                                      <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                                        <span class="pstrut" style="height:2.7em;"></span>
                                                        <span class="sizing reset-size6 size3 mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                                            j
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span class="vlist-s">
                                                      ​
                                                    </span>
                                                  </span>
                                                  <span class="vlist-r">
                                                    <span class="vlist" style="height:0.2861em;">
                                                      <span></span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="mord text">
                                              <span class="mord">
                                                 at layer
                                              </span>
                                            </span>
                                            <span class="mord mathnormal" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:3.0489em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </div>
                </blockquote>
                <p dir="auto">
                  We have loss
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <mi>
                              L
                            </mi>
                            <mo>
                              =
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msup>
                              <mi>
                                a
                              </mi>
                              <mi>
                                l
                              </mi>
                            </msup>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo>
                              −
                            </mo>
                            <msup>
                              <mi>
                                a
                              </mi>
                              <msup>
                                <mi>
                                  l
                                </mi>
                                <msup>
                                  <mrow></mrow>
                                  <mo mathvariant="normal" lspace="0em" rspace="0em">
                                    ′
                                  </mo>
                                </msup>
                              </msup>
                            </msup>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <msup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <mn>
                                2
                              </mn>
                            </msup>
                            <mo>
                              +
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            L = \sum_{l\in L} \|a^l(x_j) - a^{l^{'}}(x_j)\|^2 + \sum_{l\in L}\sum_i f_i(x_j) \|W^l_{\text{dec,i}}\|
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6833em;"></span>
                        <span class="mord mathnormal">
                          L
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          −
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1.4806em;vertical-align:-0.2861em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            a
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:1.1945em;">
                                  <span style="top:-3.1945em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7815em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                            l
                                          </span>
                                          <span class="msupsub">
                                            <span class="vlist-t">
                                              <span class="vlist-r">
                                                <span class="vlist" style="height:1.1164em;">
                                                  <span style="top:-3.1164em;margin-right:0.0714em;">
                                                    <span class="pstrut" style="height:2.6854em;"></span>
                                                    <span class="sizing reset-size3 size1 mtight">
                                                      <span class="mord mtight">
                                                        <span class="mord mtight">
                                                          <span></span>
                                                          <span class="msupsub">
                                                            <span class="vlist-t">
                                                              <span class="vlist-r">
                                                                <span class="vlist" style="height:0.9596em;">
                                                                  <span style="top:-2.9596em;margin-right:0.1em;">
                                                                    <span class="pstrut" style="height:2.5556em;"></span>
                                                                    <span class="mord mtight">
                                                                      <span class="mord mtight">
                                                                        ′
                                                                      </span>
                                                                    </span>
                                                                  </span>
                                                                </span>
                                                              </span>
                                                            </span>
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          <span class="mord">
                            ∥
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8641em;">
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        2
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          +
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mathnormal mtight">
                                      i
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  and regularization can be rewritten as:
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mrow>
                                <mi>
                                  l
                                </mi>
                                <mo>
                                  ∈
                                </mo>
                                <mi>
                                  L
                                </mi>
                              </mrow>
                            </munder>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <mo>
                              =
                            </mo>
                            <munder>
                              <mo>
                                ∑
                              </mo>
                              <mi>
                                i
                              </mi>
                            </munder>
                            <msub>
                              <mi>
                                f
                              </mi>
                              <mi>
                                i
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              (
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mi>
                                j
                              </mi>
                            </msub>
                            <mo stretchy="false">
                              )
                            </mo>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mstyle scriptlevel="0" displaystyle="true">
                              <munder>
                                <mo>
                                  ∑
                                </mo>
                                <mrow>
                                  <mi>
                                    l
                                  </mi>
                                  <mo>
                                    ∈
                                  </mo>
                                  <mi>
                                    L
                                  </mi>
                                </mrow>
                              </munder>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <msubsup>
                                <mi>
                                  W
                                </mi>
                                <mtext>
                                  dec,i
                                </mtext>
                                <mi>
                                  l
                                </mi>
                              </msubsup>
                              <mi mathvariant="normal">
                                ∥
                              </mi>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mstyle>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \sum_{l\in L}\sum_{i} f_i(x_j) \|W^l_{\text{dec,i}}\| = \sum_{i} f_i(x_j)(\displaystyle\sum_{l \in L} \|W^l_\text{dec,i}\|)
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord text mtight">
                                          <span class="mord mtight">
                                            dec,i
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:2.3795em;vertical-align:-1.3295em;"></span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8723em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.2777em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.10764em;">
                            f
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight">
                                        i
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3117em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.05724em;">
                                        j
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.2861em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mclose">
                          )
                        </span>
                        <span class="mopen">
                          (
                        </span>
                        <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.05em;">
                                <span style="top:-1.8479em;margin-left:0em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span class="sizing reset-size6 size3 mtight">
                                    <span class="mord mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                      <span class="mrel mtight">
                                        ∈
                                      </span>
                                      <span class="mord mathnormal mtight">
                                        L
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span style="top:-3.05em;">
                                  <span class="pstrut" style="height:3.05em;"></span>
                                  <span>
                                    <span class="mop op-symbol large-op">
                                      ∑
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="vlist-s">
                                ​
                              </span>
                            </span>
                            <span class="vlist-r">
                              <span class="vlist" style="height:1.3295em;">
                                <span></span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8991em;">
                                  <span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          dec,i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.113em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3831em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mclose">
                          )
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <p dir="auto">
                  <em>
                    weight of L1 regularization penalty by L1 norm of per-layer decoder weight norms
                  </em>
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mo>
                              ∑
                            </mo>
                            <mrow>
                              <mi>
                                l
                              </mi>
                              <mo>
                                ∈
                              </mo>
                              <mi>
                                L
                              </mi>
                            </mrow>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                            <msubsup>
                              <mi>
                                W
                              </mi>
                              <mtext>
                                dec,i
                              </mtext>
                              <mi>
                                l
                              </mi>
                            </msubsup>
                            <mi mathvariant="normal">
                              ∥
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \sum\limits{l\in L} \|W^l_\text{dec,i}\|
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                        <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                          ∑
                        </span>
                        <span class="mspace" style="margin-right:0.1667em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.01968em;">
                            l
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mrel">
                            ∈
                          </span>
                          <span class="mspace" style="margin-right:0.2778em;"></span>
                          <span class="mord mathnormal">
                            L
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                        <span class="mord">
                          <span class="mord mathnormal" style="margin-right:0.13889em;">
                            W
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.8491em;">
                                  <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord text mtight">
                                        <span class="mord mtight">
                                          dec,i
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span style="top:-3.063em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                        l
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.4192em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mord">
                          ∥
                        </span>
                      </span>
                    </span>
                  </span>
                  <sup>
                    <a href="#user-content-fn-l2weightnorm-reader" id="user-content-fnref-l2weightnorm-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      7
                    </a>
                  </sup>
                </p>
                <p dir="auto">
                  We use L1 due to
                </p>
                <ul dir="auto">
                  <li>
                    <p dir="auto">
                      baseline loss comparison: L2 exhibits lower loss than sum of per-layer SAE losses, as they would effectively obtain a loss “bonus” by spreading features across layers
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      <mark>
                        layer-wise sparsity surfaces layer-specific features
                      </mark>
                      : based on empirical results of
                      <a href="../thoughts/sparse-crosscoders/../../thoughts/sparse-crosscoders#model-diffing" class="internal" data-slug="thoughts/sparse-crosscoders" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        model diffing
                      </a>
                      , that L1 uncovers a mix of shared and model-specific features, whereas L2 tends to uncover only shared features.
                    </p>
                  </li>
                </ul>
                <h2 id="variants-reader" dir="auto">
                  variants
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#variants-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  <img src="../thoughts/sparse-crosscoders/../../thoughts/images/crosscoders-variants.webp" width="auto" height="auto" alt loading="lazy"/>
                </p>
                <p dir="auto">
                  good to explore:
                </p>
                <ol dir="auto">
                  <li>
                    strictly causal crosscoders to capture MLP computation and treat computation performed by attention layers as linear
                  </li>
                  <li>
                    combine strictly causal crosscoders for MLP outputs without weakly causal crosscoders for attention outputs
                  </li>
                  <li>
                    interpretable attention replacement layers that could be used in combination with strictly causal crosscoders for a “replacement model”
                  </li>
                </ol>
                <h2 id="model-diffing-reader" dir="auto">
                  model diffing
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#model-diffing-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  see also:
                  <a href="../thoughts/sparse-crosscoders/../../thoughts/model-stiching" class="internal" data-slug="thoughts/model-stiching" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    model stiching
                  </a>
                  and
                  <a href="../thoughts/sparse-crosscoders/../../thoughts/SVCCA" class="internal" data-slug="thoughts/SVCCA" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    SVCCA
                  </a>
                </p>
                <blockquote>
                  <p dir="auto">
                    <cite class id="citation--doi:10.1080/09515080050002726--2">
                      (
                      <a href="#bib-doi:10.1080/09515080050002726-reader" data-no-popover="true" data-bib class="internal">
                        <span class="indicator-hook"></span>
                        Laakso &amp; Cottrell, 2000
                      </a>
                      )
                    </cite>
                    proposes compare
                    <a href="../thoughts/sparse-crosscoders/../../thoughts/representations" class="internal" data-slug="thoughts/representations" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      representations
                    </a>
                    by transforming into representations of distances between data points.
                    <sup>
                      <a href="#user-content-fn-sne-reader" id="user-content-fnref-sne-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        8
                      </a>
                    </sup>
                  </p>
                </blockquote>
                <h2 id="questions-reader" dir="auto">
                  questions
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#questions-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    How do features change over model training? When do they form?
                  </p>
                </blockquote>
                <blockquote>
                  <p dir="auto">
                    As we make a model wider, do we get more features? or they are largely the same, packed less densely?
                  </p>
                </blockquote>
                <p dir="auto"></p>
                <h2 id="superposition-hypothesis-reader" dir="auto">
                  superposition hypothesis
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#superposition-hypothesis-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote class="callout" data-callout="abstract" data-callout-fold>
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        tl/dr
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      phenomena when a neural network represents
                      <em>
                        more
                      </em>
                      than
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                          </span>
                        </span>
                      </span>
                      features in a
                      <span class="katex">
                        <span class="katex-mathml">
                          <math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                              <mrow>
                                <mi>
                                  n
                                </mi>
                              </mrow>
                              <annotation encoding="application/x-tex">
                                n
                              </annotation>
                            </semantics>
                          </math>
                        </span>
                        <span class="katex-html" aria-hidden="true">
                          <span class="base">
                            <span class="strut" style="height:0.4306em;"></span>
                            <span class="mord mathnormal">
                              n
                            </span>
                          </span>
                        </span>
                      </span>
                      -dimensional space
                    </p>
                  </div>
                </blockquote>
                <blockquote>
                  <p dir="auto">
                    Linear representation of neurons can represent more features than dimensions. As sparsity increases, model use
                    superposition to represent more
                    <a href="../thoughts/mechanistic-interpretability#features" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      features
                    </a>
                    than dimensions.
                  </p>
                  <p dir="auto">
                    neural networks “want to represent more features than they have neurons”.
                  </p>
                </blockquote>
                <p dir="auto">
                  When features are sparsed, superposition allows compression beyond what linear model can do, at a cost of interference that requires non-linear filtering.
                </p>
                <p dir="auto">
                  reasoning: “noisy simulation”, where small neural networks exploit feature sparsity and properties of high-dimensional spaces to approximately simulate much larger much sparser neural networks
                </p>
                <p dir="auto">
                  In a sense, superposition is a form of
                  <strong>
                    lossy
                    <a href="../thoughts/Compression" class="internal" data-slug="thoughts/Compression" data-no-popover="true">
                      <span class="indicator-hook"></span>
                      compression
                    </a>
                  </strong>
                </p>
                <h3 id="importance-reader" dir="auto">
                  importance
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#importance-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <ul dir="auto">
                  <li>
                    <p dir="auto">
                      sparsity: how
                      <em>
                        frequently
                      </em>
                      is it in the input?
                    </p>
                  </li>
                  <li>
                    <p dir="auto">
                      importance: how useful is it for lowering loss?
                    </p>
                  </li>
                </ul>
                <h3 id="over-complete-basis-reader" dir="auto">
                  over-complete basis
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#over-complete-basis-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h3>
                <p dir="auto">
                  <em>
                    reasoning for the set of
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                n
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              n
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.4306em;"></span>
                          <span class="mord mathnormal">
                            n
                          </span>
                        </span>
                      </span>
                    </span>
                    directions
                    <sup>
                      <a href="#user-content-fn-direction-reader" id="user-content-fnref-direction-reader" data-footnote-ref aria-describedby="footnote-label" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        9
                      </a>
                    </sup>
                  </em>
                </p>
                <h2 id="features-reader" dir="auto">
                  features
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#features-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    A property of an input to the model
                  </p>
                </blockquote>
                <p dir="auto">
                  When we talk about features
                  <cite class id="citation--elhage2022superposition--2">
                    (
                    <a href="#bib-elhage2022superposition-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Elhage et al., 2022, p. see “Empirical Phenomena”
                    </a>
                    )
                  </cite>
                  , the theory building around
                  several observed empirical phenomena:
                </p>
                <ol dir="auto">
                  <li>
                    Word Embeddings: have direction which corresponding to semantic properties
                    <cite class id="citation--mikolov-etal-2013-linguistic--3">
                      (
                      <a href="#bib-mikolov-etal-2013-linguistic-reader" data-no-popover="true" data-bib class="internal">
                        <span class="indicator-hook"></span>
                        Mikolov et al., 2013
                      </a>
                      )
                    </cite>
                    . For
                    example:
                    <figure data-rehype-pretty-code-figure>
                      <pre tabindex="0" data-language="prolog"><code data-language="prolog" style="display:grid;"><span data-line><span style="--shiki-light:#D7827E;--shiki-dark:#EBBCBA;">V</span><span style="--shiki-light:#797593;--shiki-dark:#908CAA;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">king</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) - </span><span style="--shiki-light:#907AA9;--shiki-light-font-style:italic;--shiki-dark:#C4A7E7;--shiki-dark-font-style:italic;">V</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">man</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">) = </span><span style="--shiki-light:#907AA9;--shiki-light-font-style:italic;--shiki-dark:#C4A7E7;--shiki-dark-font-style:italic;">V</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">(</span><span style="--shiki-light:#286983;--shiki-dark:#31748F;">monarch</span><span style="--shiki-light:#575279;--shiki-dark:#E0DEF4;">)</span></span></code></pre>
                    </figure>
                  </li>
                  <li>
                    Latent space: similar vector arithmetics and interpretable directions have also been found in generative adversarial
                    network.
                  </li>
                </ol>
                <p dir="auto">
                  We can define features as properties of inputs which a sufficiently large neural network will reliably dedicate
                  a neuron to represent
                  <cite class id="citation--elhage2022superposition--4">
                    (
                    <a href="#bib-elhage2022superposition-reader" data-no-popover="true" data-bib class="internal">
                      <span class="indicator-hook"></span>
                      Elhage et al., 2022, p. see “Features as Direction”
                    </a>
                    )
                  </cite>
                </p>
                <h2 id="ablation-reader" dir="auto">
                  ablation
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ablation-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <blockquote>
                  <p dir="auto">
                    refers to the process of removing a subset of a model’s parameters to evaluate its predictions outcome.
                  </p>
                </blockquote>
                <p dir="auto">
                  idea: deletes one activation of the network to see how performance on a task changes.
                </p>
                <ul dir="auto">
                  <li>
                    zero ablation or
                    <em>
                      pruning
                    </em>
                    : Deletion by setting activations to zero
                  </li>
                  <li>
                    mean ablation: Deletion by setting activations to the mean of the dataset
                  </li>
                  <li>
                    random ablation or
                    <em>
                      resampling
                    </em>
                  </li>
                </ul>
                <h2 id="residual-stream-reader" dir="auto">
                  residual stream
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#residual-stream-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <pre><code class="mermaid" data-clipboard="flowchart LR
  A[Token] --> B[Embeddings] --> C[x0]
  C[x0] --> E[H] --> D[x1]
  C[x0] --> D
  D --> F[MLP] --> G[x2]
  D --> G[x2]
  G --> I[...] --> J[unembed] --> X[logits]">flowchart LR
  A[Token] --> B[Embeddings] --> C[x0]
  C[x0] --> E[H] --> D[x1]
  C[x0] --> D
  D --> F[MLP] --> G[x2]
  D --> G[x2]
  G --> I[...] --> J[unembed] --> X[logits]</code></pre>
                <p dir="auto">
                  residual stream
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mn>
                                0
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            x_{0}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          0
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  has dimension
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mo stretchy="false">
                              (
                            </mo>
                            <mi>
                              C
                            </mi>
                            <mo separator="true">
                              ,
                            </mo>
                            <mi>
                              E
                            </mi>
                            <mo stretchy="false">
                              )
                            </mo>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \mathit{(C,E)}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord">
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord mathit">
                            C
                          </span>
                          <span class="mpunct">
                            ,
                          </span>
                          <span class="mspace" style="margin-right:0.1667em;"></span>
                          <span class="mord mathit">
                            E
                          </span>
                          <span class="mclose">
                            )
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  where
                </p>
                <ul dir="auto">
                  <li>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                C
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \mathit{C}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.6833em;"></span>
                          <span class="mord mathit">
                            C
                          </span>
                        </span>
                      </span>
                    </span>
                    : the number of tokens in context windows and
                  </li>
                  <li>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>
                                E
                              </mi>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              \mathit{E}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height:0.6833em;"></span>
                          <span class="mord mathit">
                            E
                          </span>
                        </span>
                      </span>
                    </span>
                    : embedding dimension.
                  </li>
                </ul>
                <p dir="auto">
                  <a href="../thoughts/Attention" class="internal" data-slug="thoughts/Attention" data-no-popover="true">
                    <span class="indicator-hook"></span>
                    Attention
                  </a>
                  mechanism
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <mi>
                              H
                            </mi>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            \mathit{H}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.6833em;"></span>
                        <span class="mord mathit">
                          H
                        </span>
                      </span>
                    </span>
                  </span>
                  process given residual stream
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mn>
                                0
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            x_{0}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          0
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  as the result is added back to
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mn>
                                1
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            x_{1}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          1
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  :
                </p>
                <span class="katex-display">
                  <span class="katex">
                    <span class="katex-mathml">
                      <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                        <semantics>
                          <mrow>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mn>
                                1
                              </mn>
                            </msub>
                            <mo>
                              =
                            </mo>
                            <mi>
                              H
                            </mi>
                            <mrow>
                              <mo stretchy="false">
                                (
                              </mo>
                              <msub>
                                <mi>
                                  x
                                </mi>
                                <mn>
                                  0
                                </mn>
                              </msub>
                              <mo stretchy="false">
                                )
                              </mo>
                            </mrow>
                            <mo>
                              +
                            </mo>
                            <msub>
                              <mi>
                                x
                              </mi>
                              <mn>
                                0
                              </mn>
                            </msub>
                          </mrow>
                          <annotation encoding="application/x-tex">
                            x_{1} = \mathit{H}{(x_{0})} + x_{0}
                          </annotation>
                        </semantics>
                      </math>
                    </span>
                    <span class="katex-html" aria-hidden="true">
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          1
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                        <span class="mrel">
                          =
                        </span>
                        <span class="mspace" style="margin-right:0.2778em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                        <span class="mord mathit">
                          H
                        </span>
                        <span class="mord">
                          <span class="mopen">
                            (
                          </span>
                          <span class="mord">
                            <span class="mord mathnormal">
                              x
                            </span>
                            <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.3011em;">
                                    <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                      <span class="pstrut" style="height:2.7em;"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">
                                            0
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">
                                    ​
                                  </span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height:0.15em;">
                                    <span></span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                          <span class="mclose">
                            )
                          </span>
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                        <span class="mbin">
                          +
                        </span>
                        <span class="mspace" style="margin-right:0.2222em;"></span>
                      </span>
                      <span class="base">
                        <span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span>
                        <span class="mord">
                          <span class="mord mathnormal">
                            x
                          </span>
                          <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.3011em;">
                                  <span style="top:-2.55em;margin-left:0em;margin-right:0.05em;">
                                    <span class="pstrut" style="height:2.7em;"></span>
                                    <span class="sizing reset-size6 size3 mtight">
                                      <span class="mord mtight">
                                        <span class="mord mtight">
                                          0
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                                <span class="vlist-s">
                                  ​
                                </span>
                              </span>
                              <span class="vlist-r">
                                <span class="vlist" style="height:0.15em;">
                                  <span></span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </span>
                <h2 id="grokking-reader" dir="auto">
                  grokking
                  <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#grokking-reader" class="internal">
                    <span class="indicator-hook"></span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                  </a>
                </h2>
                <p dir="auto">
                  See also:
                  <a href="https://www.alignmentforum.org/posts/N6WM6hs7RQMKDhYjB/a-mechanistic-interpretability-analysis-of-grokking" class="external alias">
                    <span class="indicator-hook"></span>
                    writeup
                  </a>
                  ,
                  <a href="https://colab.research.google.com/drive/1F6_1_cWXE5M7WocUcpQWp3v8z4b1jL20" class="external alias">
                    <span class="indicator-hook"></span>
                    code
                  </a>
                  ,
                  <a href="https://transformer-circuits.pub/2022/in-context-learning-and-induction-heads/index.html" class="external alias">
                    <span class="indicator-hook"></span>
                    circuit threads
                  </a>
                </p>
                <blockquote>
                  <p dir="auto">
                    A phenomena discovered by
                    <cite class id="citation--power2022grokkinggeneralizationoverfittingsmall--5">
                      (
                      <a href="#bib-power2022grokkinggeneralizationoverfittingsmall-reader" data-no-popover="true" data-bib class="internal">
                        <span class="indicator-hook"></span>
                        Power et al., 2022
                      </a>
                      )
                    </cite>
                    where small algorithmic tasks like modular addition will initially memorise training data, but after a long time ti will suddenly learn to generalise to unseen data
                  </p>
                </blockquote>
                <blockquote class="callout tip" data-callout="tip">
                  <div class="callout-title" dir="auto">
                    <div class="callout-title-inner" dir="auto">
                      <p dir="auto">
                        empirical claims
                      </p>
                    </div>
                  </div>
                  <div class="callout-content" dir="auto">
                    <p dir="auto">
                      related to phase change
                    </p>
                  </div>
                </blockquote>
                <section data-references class="bibliography">
                  <h2 id="reference-label-reader" dir="auto">
                    References
                    <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reference-label-reader" class="internal">
                      <span class="indicator-hook"></span>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                      </svg>
                    </a>
                  </h2>
                  <ul dir="auto">
                    <li class="csl-entry" id="bib-dauphin2017languagemodelinggatedconvolutional-reader">
                      Dauphin, Y. N., Fan, A., Auli, M., &amp; Grangier, D. (2017).
                      <i>
                        Language Modeling with Gated Convolutional Networks
                      </i>
                      . arXiv preprint arXiv:1612.08083
                      <a href="https://arxiv.org/abs/1612.08083" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="1612.08083" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-erichson2019jumpreluretrofitdefensestrategy-reader">
                      Erichson, N. B., Yao, Z., &amp; Mahoney, M. W. (2019).
                      <i>
                        JumpReLU: A Retrofit Defense Strategy for Adversarial Attacks
                      </i>
                      . arXiv preprint arXiv:1904.03750
                      <a href="https://arxiv.org/abs/1904.03750" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="1904.03750" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-rajamanoharan2024improvingdictionarylearninggated-reader">
                      Rajamanoharan, S., Conmy, A., Smith, L., Lieberum, T., Varma, V., Kramár, J., Shah, R., &amp; Nanda, N. (2024).
                      <i>
                        Improving Dictionary Learning with Gated Sparse Autoencoders
                      </i>
                      . arXiv preprint arXiv:2404.16014
                      <a href="https://arxiv.org/abs/2404.16014" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2404.16014" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-sharkey2024feature-reader">
                      Sharkey, L. (2024).
                      <i>
                        Addressing Feature Suppression in SAEs
                      </i>
                      . AI Alignment Forum.
                      <a href="https://www.alignmentforum.org/posts/3JuSjTZyMzaSeTxKk/addressing-feature-suppression-in-saes" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                        <span class="indicator-hook"></span>
                        [post]
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-shazeer2020gluvariantsimprovetransformer-reader">
                      Shazeer, N. (2020).
                      <i>
                        GLU Variants Improve Transformer
                      </i>
                      . arXiv preprint arXiv:2002.05202
                      <a href="https://arxiv.org/abs/2002.05202" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2002.05202" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-gorton2024missingcurvedetectorsinceptionv1-reader">
                      Gorton, L. (2024).
                      <i>
                        The Missing Curve Detectors of InceptionV1: Applying Sparse Autoencoders to InceptionV1 Early Vision
                      </i>
                      . arXiv preprint arXiv:2406.03662
                      <a href="https://arxiv.org/abs/2406.03662" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2406.03662" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-doi:10.1080/09515080050002726-reader">
                      Laakso, A., &amp; Cottrell, G. (2000). Content and cluster analysis: Assessing representational similarity in neural systems.
                      <i>
                        Philosophical Psychology
                      </i>
                      ,
                      <i>
                        13
                      </i>
                      (1), 47–76.
                      <a href="https://doi.org/10.1080/09515080050002726" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                        <span class="indicator-hook"></span>
                        https://doi.org/10.1080/09515080050002726
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-lindsey2024sparsecrosscoders-reader">
                      Lindsey, J., Templeton, A., Marcus, J., Conerly, T., Batson, J., &amp; Olah, C. (2024). Sparse Crosscoders for Cross-Layer Features and Model Diffing.
                      <i>
                        Transformer Circuits Thread
                      </i>
                      .
                      <a href="https://transformer-circuits.pub/2024/crosscoders/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                        <span class="indicator-hook"></span>
                        [link]
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-elhage2022superposition-reader">
                      Elhage, N., Hume, T., Olsson, C., Schiefer, N., Henighan, T., Kravec, S., Hatfield-Dodds, Z., Lasenby, R., Drain, D., Chen, C., Grosse, R., McCandlish, S., Kaplan, J., Amodei, D., Wattenberg, M., &amp; Olah, C. (2022). Toy Models of Superposition.
                      <i>
                        Transformer Circuits Thread
                      </i>
                      .
                      <a href="https://transformer-circuits.pub/2022/toy_model/index.html" target="_blank" rel="noopener noreferrer" class="csl-external-link external alias">
                        <span class="indicator-hook"></span>
                        [link]
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-mikolov-etal-2013-linguistic-reader">
                      Mikolov, T., Yih, W., &amp; Zweig, G. (2013). Linguistic Regularities in Continuous Space Word Representations. In L. Vanderwende, H. Daumé III, &amp; K. Kirchhoff (Eds.),
                      <i>
                        Proceedings of the 2013 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies
                      </i>
                      (pp. 746–751). Association for Computational Linguistics.
                      <a href="https://aclanthology.org/N13-1090" target="_blank" rel="noopener noreferrer" class="csl-external-link external">
                        <span class="indicator-hook"></span>
                        https://aclanthology.org/N13-1090
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-panickssery2024steeringllama2contrastive-reader">
                      Panickssery, N., Gabrieli, N., Schulz, J., Tong, M., Hubinger, E., &amp; Turner, A. M. (2024).
                      <i>
                        Steering Llama 2 via Contrastive Activation Addition
                      </i>
                      . arXiv preprint arXiv:2312.06681
                      <a href="https://arxiv.org/abs/2312.06681" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2312.06681" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                    <li class="csl-entry" id="bib-power2022grokkinggeneralizationoverfittingsmall-reader">
                      Power, A., Burda, Y., Edwards, H., Babuschkin, I., &amp; Misra, V. (2022).
                      <i>
                        Grokking: Generalization Beyond Overfitting on Small Algorithmic Datasets
                      </i>
                      . arXiv preprint arXiv:2201.02177
                      <a href="https://arxiv.org/abs/2201.02177" target="_blank" rel="noopener noreferrer" class="internal" data-arxiv-id="2201.02177" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        arxiv
                      </a>
                    </li>
                  </ul>
                </section>
                <section data-footnotes class="footnotes">
                  <h2 class="sr-only" id="footnote-label-reader" dir="auto">
                    Footnotes
                    <a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#footnote-label-reader" class="internal">
                      <span class="indicator-hook"></span>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                      </svg>
                    </a>
                  </h2>
                  <ol dir="auto">
                    <li id="user-content-fn-lesswrongarc-reader">
                      <p dir="auto">
                        good read from
                        <a href="https://www.lesswrong.com/posts/6FkWnktH3mjMAxdRT/what-i-would-do-if-i-wasn-t-at-arc-evals#Ambitious_mechanistic_interpretability" class="external alias">
                          <span class="indicator-hook"></span>
                          Lawrence C
                        </a>
                        for ambitious mech interp.
                        <a href="#user-content-fnref-lesswrongarc-reader" data-footnote-backref aria-label="Back to reference 1" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-vllm-caveats-reader">
                      <p dir="auto">
                        <a href="https://github.com/vllm-project/vllm/pull/10046" class="external alias">
                          <span class="indicator-hook"></span>
                          the benchmark
                        </a>
                        was run against
                        <code>
                          vllm#0.6.3.dev236+g48138a84
                        </code>
                        , with all configuration specified in the pull request.
                        <a href="#user-content-fnref-vllm-caveats-reader" data-footnote-backref aria-label="Back to reference 2" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-1-reader">
                      <p dir="auto">
                        An example steering function can be:
                      </p>
                      <span class="katex-display">
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                              <semantics>
                                <mrow>
                                  <msub>
                                    <mi>
                                      H
                                    </mi>
                                    <mn>
                                      3
                                    </mn>
                                  </msub>
                                  <mo>
                                    =
                                  </mo>
                                  <msub>
                                    <mi>
                                      H
                                    </mi>
                                    <mn>
                                      2
                                    </mn>
                                  </msub>
                                  <mo>
                                    +
                                  </mo>
                                  <mtext>
                                    steering_strength
                                  </mtext>
                                  <mo>
                                    ∗
                                  </mo>
                                  <mtext>
                                    SAE
                                  </mtext>
                                  <mi mathvariant="normal">
                                    .
                                  </mi>
                                  <msub>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec
                                    </mtext>
                                  </msub>
                                  <mo stretchy="false">
                                    [
                                  </mo>
                                  <mn>
                                    20
                                  </mn>
                                  <mo stretchy="false">
                                    ]
                                  </mo>
                                  <mo>
                                    ∗
                                  </mo>
                                  <mtext>
                                    max_activation
                                  </mtext>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  H_{3} = H_{2} + \text{steering\_strength} * \text{SAE}.W_{\text{dec}}[20] * \text{max\_activation}
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.08125em;">
                                  H
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3011em;">
                                        <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mtight">
                                              <span class="mord mtight">
                                                3
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.15em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mrel">
                                =
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.08125em;">
                                  H
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3011em;">
                                        <span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mtight">
                                              <span class="mord mtight">
                                                2
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.15em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                              <span class="mbin">
                                +
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span>
                              <span class="mord text">
                                <span class="mord">
                                  steering_strength
                                </span>
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                              <span class="mbin">
                                ∗
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                              <span class="mord text">
                                <span class="mord">
                                  SAE
                                </span>
                              </span>
                              <span class="mord">
                                .
                              </span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.13889em;">
                                  W
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.3361em;">
                                        <span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mtight">
                                              <span class="mord text mtight">
                                                <span class="mord mtight">
                                                  dec
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.15em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mopen">
                                [
                              </span>
                              <span class="mord">
                                20
                              </span>
                              <span class="mclose">
                                ]
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                              <span class="mbin">
                                ∗
                              </span>
                              <span class="mspace" style="margin-right:0.2222em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.9779em;vertical-align:-0.31em;"></span>
                              <span class="mord text">
                                <span class="mord">
                                  max_activation
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                      </span>
                      <a href="#user-content-fnref-1-reader" data-footnote-backref aria-label="Back to reference 3" class="internal" data-no-popover="true">
                        <span class="indicator-hook"></span>
                        ↩
                      </a>
                    </li>
                    <li id="user-content-fn-shrinkage-reader">
                      <p dir="auto">
                        If we hold
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mover accent="true">
                                    <mi>
                                      x
                                    </mi>
                                    <mo>
                                      ^
                                    </mo>
                                  </mover>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <mo>
                                    ∙
                                  </mo>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  \hat{x}(\bullet)
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                              <span class="mord accent">
                                <span class="vlist-t">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.6944em;">
                                      <span style="top:-3em;">
                                        <span class="pstrut" style="height:3em;"></span>
                                        <span class="mord mathnormal">
                                          x
                                        </span>
                                      </span>
                                      <span style="top:-3em;">
                                        <span class="pstrut" style="height:3em;"></span>
                                        <span class="accent-body" style="left:-0.2222em;">
                                          <span class="mord">
                                            ^
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mopen">
                                (
                              </span>
                              <span class="mord">
                                ∙
                              </span>
                              <span class="mclose">
                                )
                              </span>
                            </span>
                          </span>
                        </span>
                        fixed, thus L1 pushes
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    f
                                  </mi>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <mi>
                                    x
                                  </mi>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                  <mo>
                                    →
                                  </mo>
                                  <mn>
                                    0
                                  </mn>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  f(x) \to 0
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="mopen">
                                (
                              </span>
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="mclose">
                                )
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                              <span class="mrel">
                                →
                              </span>
                              <span class="mspace" style="margin-right:0.2778em;"></span>
                            </span>
                            <span class="base">
                              <span class="strut" style="height:0.6444em;"></span>
                              <span class="mord">
                                0
                              </span>
                            </span>
                          </span>
                        </span>
                        , while reconstruction loss pushes
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi>
                                    f
                                  </mi>
                                  <mo stretchy="false">
                                    (
                                  </mo>
                                  <mi>
                                    x
                                  </mi>
                                  <mo stretchy="false">
                                    )
                                  </mo>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  f(x)
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1em;vertical-align:-0.25em;"></span>
                              <span class="mord mathnormal" style="margin-right:0.10764em;">
                                f
                              </span>
                              <span class="mopen">
                                (
                              </span>
                              <span class="mord mathnormal">
                                x
                              </span>
                              <span class="mclose">
                                )
                              </span>
                            </span>
                          </span>
                        </span>
                        high enough to produce accurate reconstruction.
                      </p>
                      <p dir="auto">
                        An optimal value is somewhere between.
                      </p>
                      <p dir="auto">
                        However, rescaling the
                        <a href="../thoughts/sparse-autoencoder/../../thoughts/mechanistic-interpretability#feature-suppression" class="internal" data-slug="thoughts/mechanistic-interpretability" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          shrink
                        </a>
                        feature activations
                        <cite class id="citation--sharkey2024feature--5">
                          (
                          <a href="#bib-sharkey2024feature-reader" data-no-popover="true" data-bib class="internal">
                            <span class="indicator-hook"></span>
                            Sharkey, 2024
                          </a>
                          )
                        </cite>
                        is not necessarily enough to overcome bias induced by L1: a SAE might learnt sub-optimal encoder and decoder directions that is not improved by the fixed.
                        <a href="#user-content-fnref-shrinkage-reader" data-footnote-backref aria-label="Back to reference 1" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-jointlysae-reader">
                      <p dir="auto">
                        <cite class id="citation--gorton2024missingcurvedetectorsinceptionv1--3">
                          (
                          <a href="#bib-gorton2024missingcurvedetectorsinceptionv1-reader" data-no-popover="true" data-bib class="internal">
                            <span class="indicator-hook"></span>
                            Gorton, 2024
                          </a>
                          )
                        </cite>
                        denotes that cross-branch superposition is significant in interpreting models with parallel branches (InceptionV1)
                        <a href="#user-content-fnref-jointlysae-reader" data-footnote-backref aria-label="Back to reference 1" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-risks-reader">
                      <p dir="auto">
                        causal description it provides likely differs from that of the underlying model.
                        <a href="#user-content-fnref-risks-reader" data-footnote-backref aria-label="Back to reference 2" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-l2weightnorm-reader">
                      <p dir="auto">
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                  <msubsup>
                                    <mi>
                                      W
                                    </mi>
                                    <mtext>
                                      dec,i
                                    </mtext>
                                    <mi>
                                      l
                                    </mi>
                                  </msubsup>
                                  <mi mathvariant="normal">
                                    ∥
                                  </mi>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  \|W_\text{dec,i}^l\|
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.2683em;vertical-align:-0.4192em;"></span>
                              <span class="mord">
                                ∥
                              </span>
                              <span class="mord">
                                <span class="mord mathnormal" style="margin-right:0.13889em;">
                                  W
                                </span>
                                <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.8491em;">
                                        <span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord text mtight">
                                              <span class="mord mtight">
                                                dec,i
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                        <span style="top:-3.063em;margin-right:0.05em;">
                                          <span class="pstrut" style="height:2.7em;"></span>
                                          <span class="sizing reset-size6 size3 mtight">
                                            <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                              l
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span class="vlist-s">
                                        ​
                                      </span>
                                    </span>
                                    <span class="vlist-r">
                                      <span class="vlist" style="height:0.4192em;">
                                        <span></span>
                                      </span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="mord">
                                ∥
                              </span>
                            </span>
                          </span>
                        </span>
                        is the L2 norm of a single feature’s decoder vector at a given layer.
                      </p>
                      <p dir="auto">
                        In principe, one might have expected to use L2 norm of per-layer norm
                        <span class="katex">
                          <span class="katex-mathml">
                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                              <semantics>
                                <mrow>
                                  <msqrt>
                                    <mrow>
                                      <msub>
                                        <mo>
                                          ∑
                                        </mo>
                                        <mrow>
                                          <mi>
                                            l
                                          </mi>
                                          <mo>
                                            ∈
                                          </mo>
                                          <mi>
                                            L
                                          </mi>
                                        </mrow>
                                      </msub>
                                      <mi mathvariant="normal">
                                        ∥
                                      </mi>
                                      <msubsup>
                                        <mi>
                                          W
                                        </mi>
                                        <mtext>
                                          dec,i
                                        </mtext>
                                        <mi>
                                          l
                                        </mi>
                                      </msubsup>
                                      <msup>
                                        <mi mathvariant="normal">
                                          ∥
                                        </mi>
                                        <mn>
                                          2
                                        </mn>
                                      </msup>
                                    </mrow>
                                  </msqrt>
                                </mrow>
                                <annotation encoding="application/x-tex">
                                  \sqrt{\sum_{l \in L} \|W_\text{dec,i}^l\|^2}
                                </annotation>
                              </semantics>
                            </math>
                          </span>
                          <span class="katex-html" aria-hidden="true">
                            <span class="base">
                              <span class="strut" style="height:1.84em;vertical-align:-0.6583em;"></span>
                              <span class="mord sqrt">
                                <span class="vlist-t vlist-t2">
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:1.1817em;">
                                      <span class="svg-align" style="top:-3.8em;">
                                        <span class="pstrut" style="height:3.8em;"></span>
                                        <span class="mord" style="padding-left:1em;">
                                          <span class="mop">
                                            <span class="mop op-symbol small-op" style="position:relative;top:0em;">
                                              ∑
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.1864em;">
                                                    <span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                            l
                                                          </span>
                                                          <span class="mrel mtight">
                                                            ∈
                                                          </span>
                                                          <span class="mord mathnormal mtight">
                                                            L
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.3271em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mspace" style="margin-right:0.1667em;"></span>
                                          <span class="mord">
                                            ∥
                                          </span>
                                          <span class="mord">
                                            <span class="mord mathnormal" style="margin-right:0.13889em;">
                                              W
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t vlist-t2">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.8309em;">
                                                    <span style="top:-2.3987em;margin-left:-0.1389em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord text mtight">
                                                          <span class="mord mtight">
                                                            dec,i
                                                          </span>
                                                        </span>
                                                      </span>
                                                    </span>
                                                    <span style="top:-3.0448em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mathnormal mtight" style="margin-right:0.01968em;">
                                                          l
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                  <span class="vlist-s">
                                                    ​
                                                  </span>
                                                </span>
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.4374em;">
                                                    <span></span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                          <span class="mord">
                                            <span class="mord">
                                              ∥
                                            </span>
                                            <span class="msupsub">
                                              <span class="vlist-t">
                                                <span class="vlist-r">
                                                  <span class="vlist" style="height:0.7401em;">
                                                    <span style="top:-2.989em;margin-right:0.05em;">
                                                      <span class="pstrut" style="height:2.7em;"></span>
                                                      <span class="sizing reset-size6 size3 mtight">
                                                        <span class="mord mtight">
                                                          2
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                      <span style="top:-3.1417em;">
                                        <span class="pstrut" style="height:3.8em;"></span>
                                        <span class="hide-tail" style="min-width:1.02em;height:1.88em;">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice">
                                            <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path>
                                          </svg>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="vlist-s">
                                      ​
                                    </span>
                                  </span>
                                  <span class="vlist-r">
                                    <span class="vlist" style="height:0.6583em;">
                                      <span></span>
                                    </span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </span>
                        <a href="#user-content-fnref-l2weightnorm-reader" data-footnote-backref aria-label="Back to reference 3" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-sne-reader">
                      <p dir="auto">
                        Chris Colah’s
                        <a href="https://colah.github.io/posts/2015-01-Visualizing-Representations/" class="external alias">
                          <span class="indicator-hook"></span>
                          blog post
                        </a>
                        explains how t-SNE can be used to visualize collections of networks in a function space.
                        <a href="#user-content-fnref-sne-reader" data-footnote-backref aria-label="Back to reference 4" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                    <li id="user-content-fn-direction-reader">
                      <p dir="auto">
                        Even though features still correspond to directions, the set of interpretable direction is larger than the number of dimensions
                        <a href="#user-content-fnref-direction-reader" data-footnote-backref aria-label="Back to reference 4" class="internal" data-no-popover="true">
                          <span class="indicator-hook"></span>
                          ↩
                        </a>
                      </p>
                    </li>
                  </ol>
                </section>
              </div>
            </div>
          </div>
          <div class="image-popup-modal" id="image-popup-modal">
            <div class="image-popup-backdrop"></div>
            <div class="image-popup-content">
              <button class="image-popup-close" aria-label="Close popup">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
              <img class="image-popup-img" src alt/>
            </div>
          </div>
          <div id="mermaid-container">
            <div class="mermaid-backdrop"></div>
            <div id="mermaid-space">
              <div class="mermaid-header">
                <button class="close-button" aria-label="close button">
                  <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div class="mermaid-content"></div>
            </div>
          </div>
        </section>
      </section>
    </main>
  </body>
  <script type="application/javascript">
    function i(){let l=this.parentElement;l.classList.toggle("is-collapsed");let e=l.classList.contains("is-collapsed")?this.scrollHeight:l.scrollHeight;l.style.maxHeight=e+"px";let s=l,t=l.parentElement;for(;t;){if(!t.classList.contains("callout"))return;let a=t.classList.contains("is-collapsed")?t.scrollHeight:t.scrollHeight+s.scrollHeight;t.style.maxHeight=a+"px",s=t,t=t.parentElement}}function r(l){let o=l.getBoundingClientRect(),e=1056,s=o.height;return o.top%e+s>e}function c(){let l=document.getElementsByClassName("callout is-collapsible");for(let e of l){let s=e.firstElementChild;if(s){s.addEventListener("click",i),window.addCleanup(()=>s.removeEventListener("click",i));let n=e.classList.contains("is-collapsed")?s.scrollHeight:e.scrollHeight;e.style.maxHeight=n+"px"}}let o=document.getElementsByClassName("callout");for(let e of o)r(e)&&(e.style.pageBreakBefore="always",e.classList.add("force-page-break"))}document.addEventListener("nav",c);window.addEventListener("resize",c);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script>
  <script src="../postscript.js" type="module"></script>
</html>